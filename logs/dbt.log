[0m11:34:28.973133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D09EC4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D2C6B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D31C7F50>]}


============================== 11:34:28.977531 | 4b7b0886-c1fe-4503-9df6-069e60c1e410 ==============================
[0m11:34:28.977531 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:34:28.977950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:34:29.003152 [info ] [MainThread]: dbt version: 1.10.1
[0m11:34:29.004357 [info ] [MainThread]: python version: 3.12.6
[0m11:34:29.004357 [info ] [MainThread]: python path: C:\Users\Predator\AppData\Local\Programs\Python\Python312\python.exe
[0m11:34:29.005367 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:34:29.008404 [info ] [MainThread]: Using profiles dir at C:\Users\Predator\.dbt
[0m11:34:29.008404 [info ] [MainThread]: Using profiles.yml file at C:\Users\Predator\.dbt\profiles.yml
[0m11:34:29.009398 [info ] [MainThread]: Using dbt_project.yml file at D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\dbt_project.yml
[0m11:34:29.118652 [info ] [MainThread]: Configuration:
[0m11:34:29.119815 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:34:29.120388 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:34:29.120861 [info ] [MainThread]: Required dependencies:
[0m11:34:29.120861 [debug] [MainThread]: Executing "git --help"
[0m11:34:29.168508 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:34:29.168508 [debug] [MainThread]: STDERR: "b''"
[0m11:34:29.169508 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:34:29.169508 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:34:29.170483 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:34:29.170483 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'datavault_postgres_test'


[0m11:34:29.171566 [debug] [MainThread]: Command `dbt debug` failed at 11:34:29.171566 after 0.41 seconds
[0m11:34:29.171566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D461BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D330D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D2907770>]}
[0m11:34:29.172609 [debug] [MainThread]: Flushing usage events
[0m11:34:30.144357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:51.262671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C4955100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C6FEB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C70519A0>]}


============================== 11:34:51.266680 | 0b501c1a-409b-4727-b7cd-1f1c25e56838 ==============================
[0m11:34:51.266680 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:34:51.267680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:51.290586 [info ] [MainThread]: dbt version: 1.10.1
[0m11:34:51.291585 [info ] [MainThread]: python version: 3.12.6
[0m11:34:51.292585 [info ] [MainThread]: python path: C:\Users\Predator\AppData\Local\Programs\Python\Python312\python.exe
[0m11:34:51.292585 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:34:51.296870 [error] [MainThread]: Encountered an error:
argument of type 'NoneType' is not iterable
[0m11:34:51.298870 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 420, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\debug.py", line 205, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 314, in from_raw_profile_info
    target_name, profile_data = cls.render_profile(
                                ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 280, in render_profile
    raw_profile_data = cls._get_profile_data(raw_profile, profile_name, target_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 205, in _get_profile_data
    if target_name not in outputs:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable

[0m11:34:51.299870 [debug] [MainThread]: Command `dbt debug` failed at 11:34:51.299870 after 0.20 seconds
[0m11:34:51.300869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C7AF8A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C78AE8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C8463CB0>]}
[0m11:34:51.300869 [debug] [MainThread]: Flushing usage events
[0m11:34:52.260524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:15.510933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228DDDBCBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228E03CB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228E1187650>]}


============================== 11:35:15.515050 | 853a63c0-a4b9-4d0f-8e19-855ba8996a8e ==============================
[0m11:35:15.515050 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:35:15.516056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:15.540715 [info ] [MainThread]: dbt version: 1.10.1
[0m11:35:15.540715 [info ] [MainThread]: python version: 3.12.6
[0m11:35:15.541715 [info ] [MainThread]: python path: C:\Users\Predator\AppData\Local\Programs\Python\Python312\python.exe
[0m11:35:15.541715 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:35:15.627012 [info ] [MainThread]: Using profiles dir at C:\Users\Predator\.dbt
[0m11:35:15.642976 [info ] [MainThread]: Using profiles.yml file at C:\Users\Predator\.dbt\profiles.yml
[0m11:35:15.643807 [info ] [MainThread]: Using dbt_project.yml file at D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\dbt_project.yml
[0m11:35:15.778898 [info ] [MainThread]: Configuration:
[0m11:35:15.779859 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:35:15.779859 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:35:15.780858 [info ] [MainThread]: Required dependencies:
[0m11:35:15.780858 [debug] [MainThread]: Executing "git --help"
[0m11:35:15.815412 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:35:15.815412 [debug] [MainThread]: STDERR: "b''"
[0m11:35:15.816373 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:35:15.816373 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:35:15.817372 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:35:15.817372 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "datavault_postgres_test", target "dev" invalid: 1234 is not of type 'string'


[0m11:35:15.818373 [debug] [MainThread]: Command `dbt debug` failed at 11:35:15.818373 after 0.45 seconds
[0m11:35:15.819413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228E0C0B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228E0C08230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228E0692B70>]}
[0m11:35:15.819413 [debug] [MainThread]: Flushing usage events
[0m11:35:16.774049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:28.656509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178DDA56180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178DB9C4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178DD7F1430>]}


============================== 11:35:28.660972 | ee3f0a24-b9e5-462e-b927-eb14091da1fe ==============================
[0m11:35:28.660972 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:35:28.660972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:28.684928 [info ] [MainThread]: dbt version: 1.10.1
[0m11:35:28.685955 [info ] [MainThread]: python version: 3.12.6
[0m11:35:28.685955 [info ] [MainThread]: python path: C:\Users\Predator\AppData\Local\Programs\Python\Python312\python.exe
[0m11:35:28.686953 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:35:28.755010 [info ] [MainThread]: Using profiles dir at C:\Users\Predator\.dbt
[0m11:35:28.756006 [info ] [MainThread]: Using profiles.yml file at C:\Users\Predator\.dbt\profiles.yml
[0m11:35:28.756006 [info ] [MainThread]: Using dbt_project.yml file at D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\dbt_project.yml
[0m11:35:28.757006 [info ] [MainThread]: adapter type: postgres
[0m11:35:28.758006 [info ] [MainThread]: adapter version: 1.9.0
[0m11:35:28.864228 [info ] [MainThread]: Configuration:
[0m11:35:28.865356 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:35:28.865921 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:35:28.866334 [info ] [MainThread]: Required dependencies:
[0m11:35:28.866334 [debug] [MainThread]: Executing "git --help"
[0m11:35:28.894932 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:35:28.894932 [debug] [MainThread]: STDERR: "b''"
[0m11:35:28.894932 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:35:28.894932 [info ] [MainThread]: Connection:
[0m11:35:28.894932 [info ] [MainThread]:   host: localhost
[0m11:35:28.894932 [info ] [MainThread]:   port: 5432
[0m11:35:28.894932 [info ] [MainThread]:   user: postgres
[0m11:35:28.894932 [info ] [MainThread]:   database: sakila_db
[0m11:35:28.894932 [info ] [MainThread]:   schema: public
[0m11:35:28.894932 [info ] [MainThread]:   connect_timeout: 10
[0m11:35:28.894932 [info ] [MainThread]:   role: None
[0m11:35:28.894932 [info ] [MainThread]:   search_path: None
[0m11:35:28.894932 [info ] [MainThread]:   keepalives_idle: 0
[0m11:35:28.894932 [info ] [MainThread]:   sslmode: None
[0m11:35:28.894932 [info ] [MainThread]:   sslcert: None
[0m11:35:28.894932 [info ] [MainThread]:   sslkey: None
[0m11:35:28.894932 [info ] [MainThread]:   sslrootcert: None
[0m11:35:28.894932 [info ] [MainThread]:   application_name: dbt
[0m11:35:28.894932 [info ] [MainThread]:   retries: 1
[0m11:35:28.894932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:35:29.170200 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:35:31.340817 [debug] [MainThread]: Using postgres connection "debug"
[0m11:35:31.341822 [debug] [MainThread]: On debug: select 1 as id
[0m11:35:31.342822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:31.383634 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m11:35:31.384677 [debug] [MainThread]: On debug: Close
[0m11:35:31.384677 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:35:31.385640 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:35:31.386639 [debug] [MainThread]: Command `dbt debug` succeeded at 11:35:31.386639 after 2.87 seconds
[0m11:35:31.387640 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:35:31.387640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178DD3B9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178DD3B8E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178DD3B90D0>]}
[0m11:35:31.388640 [debug] [MainThread]: Flushing usage events
[0m11:35:32.318791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:44.622972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784B4A20C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784AB42ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784D31DBB0>]}


============================== 11:50:44.627918 | b0f5ce91-5810-4ba1-b33e-2a197f53115a ==============================
[0m11:50:44.627918 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:50:44.627918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_raw_actor', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:44.628970 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m11:50:44.628970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0f5ce91-5810-4ba1-b33e-2a197f53115a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784AB42ED0>]}
[0m11:50:44.917865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0f5ce91-5810-4ba1-b33e-2a197f53115a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784D8F9610>]}
[0m11:50:44.983625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0f5ce91-5810-4ba1-b33e-2a197f53115a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027847649E80>]}
[0m11:50:44.985001 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:50:45.261520 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:50:45.262892 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:50:45.263892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0f5ce91-5810-4ba1-b33e-2a197f53115a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784ED10CB0>]}
[0m11:50:47.318312 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "source_table_sakila_rental".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("source_table_sakila", "rental").
  
  To fix this, change the name of one of these resources:
  - source.datavault_postgres_test.source_table_sakila.rental (models\stg_raw\sakila_source.yml)
  - source.datavault_postgres_test.source_table_sakila.rental (models\stg_raw\sakila_source.yml)
[0m11:50:47.319276 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:50:47.319838 [debug] [MainThread]: Command `dbt build` failed at 11:50:47.319838 after 2.89 seconds
[0m11:50:47.319838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784AA47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784F1441A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784F0F7260>]}
[0m11:50:47.320884 [debug] [MainThread]: Flushing usage events
[0m11:50:48.270833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:43.227145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C804D97B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C804EBC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C804D95520>]}


============================== 11:51:43.231311 | 93fe7dd3-41cf-401d-b454-ac2a4d0340c3 ==============================
[0m11:51:43.231311 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:51:43.232248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m stg_raw_actor', 'send_anonymous_usage_stats': 'True'}
[0m11:51:43.232248 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m11:51:43.233290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8050F8E60>]}
[0m11:51:43.437895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C804CA10A0>]}
[0m11:51:43.502605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C805223140>]}
[0m11:51:43.503614 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:51:43.785771 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:51:43.786774 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:51:43.786774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8063F2AE0>]}
[0m11:51:44.930746 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `source_table_sakila` in file
`models\stg_raw\sakila_source.yml`. The `freshness` top-level property should be
moved into the `config` of `source_table_sakila`.
[0m11:51:44.931746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8069E81D0>]}
[0m11:51:45.097560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8069CA900>]}
[0m11:51:45.178053 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m11:51:45.274096 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m11:51:45.322303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C806703F80>]}
[0m11:51:45.322303 [info ] [MainThread]: Found 3 models, 4 data tests, 15 sources, 433 macros
[0m11:51:45.324400 [info ] [MainThread]: 
[0m11:51:45.325198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:45.325198 [info ] [MainThread]: 
[0m11:51:45.326222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:51:45.328454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m11:51:45.413278 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m11:51:45.413278 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m11:51:45.413278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:45.458802 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m11:51:45.461605 [debug] [ThreadPool]: On list_sakila_db: Close
[0m11:51:45.465749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m11:51:45.470788 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m11:51:45.471788 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m11:51:45.471788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:45.637017 [debug] [ThreadPool]: SQL status: BEGIN in 0.165 seconds
[0m11:51:45.637017 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m11:51:45.637017 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:51:45.642729 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.005 seconds
[0m11:51:45.644457 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m11:51:45.645704 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m11:51:45.653704 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:45.653704 [debug] [MainThread]: On master: BEGIN
[0m11:51:45.654706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:45.807134 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m11:51:45.807690 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:45.808251 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:51:45.819044 [debug] [MainThread]: SQL status: SELECT 43 in 0.010 seconds
[0m11:51:45.829117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802505EB0>]}
[0m11:51:45.830113 [debug] [MainThread]: On master: ROLLBACK
[0m11:51:45.830113 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:45.831150 [debug] [MainThread]: On master: BEGIN
[0m11:51:45.831150 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:51:45.833365 [debug] [MainThread]: On master: COMMIT
[0m11:51:45.834386 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:45.834386 [debug] [MainThread]: On master: COMMIT
[0m11:51:45.835374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:51:45.836375 [debug] [MainThread]: On master: Close
[0m11:51:45.862925 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_actor
[0m11:51:45.863926 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_raw_actor ............................... [RUN]
[0m11:51:45.863926 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_raw_actor'
[0m11:51:45.864924 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_actor
[0m11:51:45.871924 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_actor"
[0m11:51:45.882075 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_actor
[0m11:51:45.931062 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_actor"
[0m11:51:45.933936 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m11:51:45.933936 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: BEGIN
[0m11:51:45.934943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:45.974395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m11:51:45.975393 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m11:51:45.975393 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */

  create view "sakila_db"."public"."stg_raw_actor__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."source_table_sakila"."actor"
  );
[0m11:51:45.976899 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»source_table_sakila.actorÂ« existiert nicht
LINE 7:     select * from "sakila_db"."source_table_sakila"."actor"
                          ^

[0m11:51:45.977264 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: ROLLBACK
[0m11:51:45.977264 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: Close
[0m11:51:45.994224 [debug] [Thread-1 (]: Database Error in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)
  FEHLER:  Relation Â»source_table_sakila.actorÂ« existiert nicht
  LINE 7:     select * from "sakila_db"."source_table_sakila"."actor"
                            ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql
[0m11:51:45.996588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93fe7dd3-41cf-401d-b454-ac2a4d0340c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C806A843E0>]}
[0m11:51:45.996588 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_raw_actor ...................... [[31mERROR[0m in 0.13s]
[0m11:51:45.997779 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_actor
[0m11:51:45.998785 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)
  FEHLER:  Relation Â»source_table_sakila.actorÂ« existiert nicht
  LINE 7:     select * from "sakila_db"."source_table_sakila"."actor"
                            ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql.
[0m11:51:46.000785 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:46.000785 [debug] [MainThread]: On master: BEGIN
[0m11:51:46.000785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:46.041646 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m11:51:46.042683 [debug] [MainThread]: On master: COMMIT
[0m11:51:46.042683 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:46.042683 [debug] [MainThread]: On master: COMMIT
[0m11:51:46.043689 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:51:46.043689 [debug] [MainThread]: On master: Close
[0m11:51:46.044795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:46.045802 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m11:51:46.046801 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m11:51:46.047799 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_raw_actor' was properly closed.
[0m11:51:46.047799 [info ] [MainThread]: 
[0m11:51:46.048799 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m11:51:46.050802 [debug] [MainThread]: Command end result
[0m11:51:46.073365 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m11:51:46.075365 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m11:51:46.082927 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m11:51:46.083926 [info ] [MainThread]: 
[0m11:51:46.083926 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:51:46.084924 [info ] [MainThread]: 
[0m11:51:46.085926 [error] [MainThread]: [31mFailure in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)[0m
[0m11:51:46.085926 [error] [MainThread]:   Database Error in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)
  FEHLER:  Relation Â»source_table_sakila.actorÂ« existiert nicht
  LINE 7:     select * from "sakila_db"."source_table_sakila"."actor"
                            ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql
[0m11:51:46.086924 [info ] [MainThread]: 
[0m11:51:46.087924 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql
[0m11:51:46.088924 [info ] [MainThread]: 
[0m11:51:46.088924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:51:46.089924 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:51:46.091936 [debug] [MainThread]: Command `dbt build` failed at 11:51:46.091936 after 3.00 seconds
[0m11:51:46.091936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C804F12900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80475ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80475ACF0>]}
[0m11:51:46.091936 [debug] [MainThread]: Flushing usage events
[0m11:51:47.163247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:17.054155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6842CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6AF0CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6AF0F080>]}


============================== 12:15:17.058156 | f516d235-872e-4ae4-b768-9c1c87b12eae ==============================
[0m12:15:17.058156 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:15:17.059119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_raw_actor', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:15:17.059119 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m12:15:17.060526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC699B9190>]}
[0m12:15:17.299420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6CEADC70>]}
[0m12:15:17.367463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6BDD6E70>]}
[0m12:15:17.369426 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:15:17.720165 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:15:18.068059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:15:18.069057 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\sakila_source.yml
[0m12:15:18.069057 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_actor.sql
[0m12:15:18.366560 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `public` in file
`models\stg_raw\sakila_source.yml`. The `freshness` top-level property should be
moved into the `config` of `public`.
[0m12:15:18.367524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D2E50D0>]}
[0m12:15:18.465586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D4E23F0>]}
[0m12:15:18.542166 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:15:18.559538 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:15:18.609160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6D4E16D0>]}
[0m12:15:18.610165 [info ] [MainThread]: Found 3 models, 4 data tests, 15 sources, 433 macros
[0m12:15:18.611926 [info ] [MainThread]: 
[0m12:15:18.612959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:18.613959 [info ] [MainThread]: 
[0m12:15:18.614958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:18.615959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m12:15:19.622083 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m12:15:19.623172 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m12:15:19.623751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:19.691174 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m12:15:19.692176 [debug] [ThreadPool]: On list_sakila_db: Close
[0m12:15:19.703845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m12:15:19.714354 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:15:19.715355 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m12:15:19.715355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:19.778436 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m12:15:19.779444 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:15:19.779444 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:15:19.789443 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.009 seconds
[0m12:15:19.791443 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m12:15:19.792441 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m12:15:19.802525 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:19.802525 [debug] [MainThread]: On master: BEGIN
[0m12:15:19.802525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:19.958632 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m12:15:19.958632 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:19.958632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:19.967946 [debug] [MainThread]: SQL status: SELECT 43 in 0.008 seconds
[0m12:15:19.977687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC68F75D90>]}
[0m12:15:19.978735 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:19.979742 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:19.979742 [debug] [MainThread]: On master: BEGIN
[0m12:15:19.980741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:15:19.980741 [debug] [MainThread]: On master: COMMIT
[0m12:15:19.981743 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:19.981743 [debug] [MainThread]: On master: COMMIT
[0m12:15:19.981743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:19.982739 [debug] [MainThread]: On master: Close
[0m12:15:19.986742 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_actor
[0m12:15:19.986742 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_raw_actor ............................... [RUN]
[0m12:15:19.987739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_raw_actor'
[0m12:15:19.987739 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_actor
[0m12:15:19.995057 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:19.996099 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_actor
[0m12:15:20.032229 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:20.033228 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:20.033228 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: BEGIN
[0m12:15:20.034191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:20.076045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:15:20.076045 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:20.077462 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */

  create view "sakila_db"."public"."stg_raw_actor__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."actor"
  );
[0m12:15:20.082971 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:15:20.088968 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:20.089969 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
alter table "sakila_db"."public"."stg_raw_actor__dbt_tmp" rename to "stg_raw_actor"
[0m12:15:20.089969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:15:20.108038 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: COMMIT
[0m12:15:20.109038 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:20.109038 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: COMMIT
[0m12:15:20.114446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:15:20.120489 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_actor__dbt_backup"
[0m12:15:20.125451 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:15:20.125451 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
drop view if exists "sakila_db"."public"."stg_raw_actor__dbt_backup" cascade
[0m12:15:20.127820 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:15:20.129916 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: Close
[0m12:15:20.131878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f516d235-872e-4ae4-b768-9c1c87b12eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC68E870B0>]}
[0m12:15:20.132878 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_raw_actor .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:15:20.133915 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_actor
[0m12:15:20.134877 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:20.135880 [debug] [MainThread]: On master: BEGIN
[0m12:15:20.135880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:20.315779 [debug] [MainThread]: SQL status: BEGIN in 0.179 seconds
[0m12:15:20.315779 [debug] [MainThread]: On master: COMMIT
[0m12:15:20.315779 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:20.316798 [debug] [MainThread]: On master: COMMIT
[0m12:15:20.316798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:20.317756 [debug] [MainThread]: On master: Close
[0m12:15:20.317756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:20.317756 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m12:15:20.318760 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m12:15:20.318760 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_raw_actor' was properly closed.
[0m12:15:20.319757 [info ] [MainThread]: 
[0m12:15:20.319757 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m12:15:20.320757 [debug] [MainThread]: Command end result
[0m12:15:20.342123 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:15:20.346169 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:15:20.352187 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m12:15:20.352187 [info ] [MainThread]: 
[0m12:15:20.353200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:20.353200 [info ] [MainThread]: 
[0m12:15:20.354339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:20.355382 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:15:20.356346 [debug] [MainThread]: Command `dbt build` succeeded at 12:15:20.356346 after 3.52 seconds
[0m12:15:20.356346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6B521790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6BCDA9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6BCDAD50>]}
[0m12:15:20.357383 [debug] [MainThread]: Flushing usage events
[0m12:15:21.405686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:04.676786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB17B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB17AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB7B6720>]}


============================== 12:16:04.676786 | 50c41559-95c5-47d9-aea8-7c85a9085ea2 ==============================
[0m12:16:04.676786 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:16:04.676786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m stg_raw_address', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:04.676786 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m12:16:04.676786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB823D40>]}
[0m12:16:04.893480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BBBDB800>]}
[0m12:16:04.953429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB11A1B0>]}
[0m12:16:04.953429 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:16:05.193857 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:16:05.365829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:16:05.365829 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_address.sql
[0m12:16:05.643863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD2CD5E0>]}
[0m12:16:05.727019 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:16:05.740973 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:16:05.777210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD3C2630>]}
[0m12:16:05.777210 [info ] [MainThread]: Found 4 models, 4 data tests, 15 sources, 433 macros
[0m12:16:05.788993 [info ] [MainThread]: 
[0m12:16:05.788993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:05.788993 [info ] [MainThread]: 
[0m12:16:05.788993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:05.788993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m12:16:05.872511 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m12:16:05.873545 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m12:16:05.873545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:05.914540 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m12:16:05.914540 [debug] [ThreadPool]: On list_sakila_db: Close
[0m12:16:05.921208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m12:16:05.927003 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:16:05.927003 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m12:16:05.927003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:05.960508 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:16:05.960508 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:16:05.960508 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:16:05.977051 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.007 seconds
[0m12:16:05.977051 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m12:16:05.977051 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m12:16:05.990018 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:05.990018 [debug] [MainThread]: On master: BEGIN
[0m12:16:05.990018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:06.135512 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m12:16:06.135512 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.135512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:06.145498 [debug] [MainThread]: SQL status: SELECT 44 in 0.008 seconds
[0m12:16:06.151497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BDACD490>]}
[0m12:16:06.151497 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:06.151497 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.151497 [debug] [MainThread]: On master: BEGIN
[0m12:16:06.151497 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:16:06.151497 [debug] [MainThread]: On master: COMMIT
[0m12:16:06.151497 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.151497 [debug] [MainThread]: On master: COMMIT
[0m12:16:06.151497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:06.151497 [debug] [MainThread]: On master: Close
[0m12:16:06.164243 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_address
[0m12:16:06.164243 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_raw_address ............................. [RUN]
[0m12:16:06.164243 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_raw_address'
[0m12:16:06.164243 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_address
[0m12:16:06.168239 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.168239 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_address
[0m12:16:06.211483 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.293706 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.293706 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: BEGIN
[0m12:16:06.308364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:06.343851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:16:06.343851 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.343851 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */

  create view "sakila_db"."public"."stg_raw_address__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."address"
  );
[0m12:16:06.343851 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:16:06.360300 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.360300 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
alter table "sakila_db"."public"."stg_raw_address__dbt_tmp" rename to "stg_raw_address"
[0m12:16:06.360300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:16:06.371836 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: COMMIT
[0m12:16:06.371836 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.377099 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: COMMIT
[0m12:16:06.377099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:16:06.377099 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_address__dbt_backup"
[0m12:16:06.387557 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:16:06.387557 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
drop view if exists "sakila_db"."public"."stg_raw_address__dbt_backup" cascade
[0m12:16:06.387557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:16:06.387557 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: Close
[0m12:16:06.393625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c41559-95c5-47d9-aea8-7c85a9085ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B8D87260>]}
[0m12:16:06.393625 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_raw_address ........................ [[32mCREATE VIEW[0m in 0.23s]
[0m12:16:06.393625 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_address
[0m12:16:06.393625 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.393625 [debug] [MainThread]: On master: BEGIN
[0m12:16:06.393625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:06.543568 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m12:16:06.543568 [debug] [MainThread]: On master: COMMIT
[0m12:16:06.543568 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:06.543568 [debug] [MainThread]: On master: COMMIT
[0m12:16:06.543568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:06.543568 [debug] [MainThread]: On master: Close
[0m12:16:06.543568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:06.543568 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m12:16:06.543568 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m12:16:06.543568 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_raw_address' was properly closed.
[0m12:16:06.543568 [info ] [MainThread]: 
[0m12:16:06.543568 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:16:06.543568 [debug] [MainThread]: Command end result
[0m12:16:06.562916 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:16:06.562916 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:16:06.579344 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m12:16:06.580342 [info ] [MainThread]: 
[0m12:16:06.580742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:06.581794 [info ] [MainThread]: 
[0m12:16:06.581794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:16:06.582796 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:16:06.583803 [debug] [MainThread]: Command `dbt build` succeeded at 12:16:06.583803 after 2.04 seconds
[0m12:16:06.583803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB17AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B902D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BD25B6E0>]}
[0m12:16:06.583803 [debug] [MainThread]: Flushing usage events
[0m12:16:07.602356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:32.710440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020467992EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046A4B65D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046A4B6FF0>]}


============================== 12:20:32.724107 | e1e91054-a4be-40a5-9ae3-35a42cf4c996 ==============================
[0m12:20:32.724107 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:20:32.724107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -m stg_raw_*', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:20:32.724107 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m12:20:32.724107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1e91054-a4be-40a5-9ae3-35a42cf4c996', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046A581EE0>]}
[0m12:20:32.927199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1e91054-a4be-40a5-9ae3-35a42cf4c996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046A9FD670>]}
[0m12:20:32.976902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1e91054-a4be-40a5-9ae3-35a42cf4c996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020468427E60>]}
[0m12:20:32.990077 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:20:33.243788 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 13 files added, 0 files changed.
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_store.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_payment.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_customer.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_language.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_category.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_rental.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_film.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_staff.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_film_actor.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_inventory.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_country.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_film_category.sql
[0m12:20:33.460372 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_city.sql
[0m12:20:33.762081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1e91054-a4be-40a5-9ae3-35a42cf4c996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046BA8A030>]}
[0m12:20:33.850733 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:20:33.868301 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:20:33.910297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1e91054-a4be-40a5-9ae3-35a42cf4c996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046BF50E60>]}
[0m12:20:33.910297 [info ] [MainThread]: Found 17 models, 4 data tests, 15 sources, 433 macros
[0m12:20:33.910297 [warn ] [MainThread]: The selection criterion 'stg_raw_*' does not match any enabled nodes
[0m12:20:33.910297 [warn ] [MainThread]: The selection criterion 'stg_raw_*' does not match any enabled nodes
[0m12:20:33.910297 [warn ] [MainThread]: The selection criterion 'stg_raw_*' does not match any enabled nodes
[0m12:20:33.919033 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:20:33.919436 [debug] [MainThread]: Command end result
[0m12:20:33.961410 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:20:33.965637 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:20:33.973832 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m12:20:33.976122 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:20:33.977130 [debug] [MainThread]: Command `dbt build` succeeded at 12:20:33.977130 after 1.45 seconds
[0m12:20:33.977130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046BA63680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046C07E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204699038C0>]}
[0m12:20:33.978368 [debug] [MainThread]: Flushing usage events
[0m12:20:35.043770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:15.477564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1320FCBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1320FCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A132735220>]}


============================== 12:22:15.477564 | cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0 ==============================
[0m12:22:15.477564 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:22:15.477564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -m .\\models\\stg_raw\\*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:22:15.477564 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m12:22:15.477564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A12FB678F0>]}
[0m12:22:15.710505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A133D433E0>]}
[0m12:22:15.783590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1326F3080>]}
[0m12:22:15.783590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:22:16.059276 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:22:16.232369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:16.232369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:16.280102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1340EB920>]}
[0m12:22:16.391882 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:22:16.409475 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:22:16.511651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1340B13D0>]}
[0m12:22:16.512665 [info ] [MainThread]: Found 17 models, 4 data tests, 15 sources, 433 macros
[0m12:22:16.582048 [info ] [MainThread]: 
[0m12:22:16.582048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:16.582048 [info ] [MainThread]: 
[0m12:22:16.582048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:16.594912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m12:22:16.710237 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m12:22:16.710237 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m12:22:16.710237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:16.884047 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.174 seconds
[0m12:22:16.884047 [debug] [ThreadPool]: On list_sakila_db: Close
[0m12:22:16.884047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m12:22:16.893547 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:22:16.893547 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m12:22:16.893547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:16.931899 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:22:16.931899 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:22:16.931899 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:22:16.947623 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.006 seconds
[0m12:22:16.947623 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m12:22:16.947623 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m12:22:16.960286 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:16.960286 [debug] [MainThread]: On master: BEGIN
[0m12:22:16.960286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:17.094156 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m12:22:17.094156 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:17.094156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:17.113187 [debug] [MainThread]: SQL status: SELECT 45 in 0.009 seconds
[0m12:22:17.126893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A13459FA70>]}
[0m12:22:17.128194 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:17.128596 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:17.128596 [debug] [MainThread]: On master: BEGIN
[0m12:22:17.128596 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:22:17.128596 [debug] [MainThread]: On master: COMMIT
[0m12:22:17.128596 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:17.128596 [debug] [MainThread]: On master: COMMIT
[0m12:22:17.128596 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:22:17.128596 [debug] [MainThread]: On master: Close
[0m12:22:17.128596 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_customer
[0m12:22:17.128596 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_customer ............................... [RUN]
[0m12:22:17.128596 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_customer'
[0m12:22:17.128596 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_customer
[0m12:22:17.146125 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_customer"
[0m12:22:17.147093 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_customer
[0m12:22:17.180176 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_customer"
[0m12:22:17.180176 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_customer"
[0m12:22:17.180176 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: BEGIN
[0m12:22:17.180176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:22:17.224287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:22:17.224287 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_customer"
[0m12:22:17.224287 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_customer"} */

  create view "sakila_db"."public"."stg_customer__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."customer"
  );
[0m12:22:17.227316 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.227316 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_customer"
[0m12:22:17.227316 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_customer"} */
alter table "sakila_db"."public"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m12:22:17.227316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.243479 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: COMMIT
[0m12:22:17.243479 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_customer"
[0m12:22:17.243479 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: COMMIT
[0m12:22:17.243479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:22:17.260175 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_customer__dbt_backup"
[0m12:22:17.260175 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_customer"
[0m12:22:17.260175 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_customer"} */
drop view if exists "sakila_db"."public"."stg_customer__dbt_backup" cascade
[0m12:22:17.260175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:17.260175 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_customer: Close
[0m12:22:17.272793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A12FD66FF0>]}
[0m12:22:17.272793 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_customer .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:22:17.272793 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_customer
[0m12:22:17.274799 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_actor
[0m12:22:17.274799 [info ] [Thread-1 (]: 2 of 15 START sql view model public.stg_raw_actor .............................. [RUN]
[0m12:22:17.276806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_customer, now model.datavault_postgres_test.stg_raw_actor)
[0m12:22:17.276806 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_actor
[0m12:22:17.276806 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.276806 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_actor
[0m12:22:17.276806 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.276806 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.276806 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: BEGIN
[0m12:22:17.276806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.329609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:22:17.329609 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.329609 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */

  create view "sakila_db"."public"."stg_raw_actor__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."actor"
  );
[0m12:22:17.329609 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.329609 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.329609 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
alter table "sakila_db"."public"."stg_raw_actor" rename to "stg_raw_actor__dbt_backup"
[0m12:22:17.329609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.343800 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.344136 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
alter table "sakila_db"."public"."stg_raw_actor__dbt_tmp" rename to "stg_raw_actor"
[0m12:22:17.345143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:22:17.345143 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: COMMIT
[0m12:22:17.345143 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.345143 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: COMMIT
[0m12:22:17.427153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.077 seconds
[0m12:22:17.427153 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_actor__dbt_backup"
[0m12:22:17.427153 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:22:17.427153 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
drop view if exists "sakila_db"."public"."stg_raw_actor__dbt_backup" cascade
[0m12:22:17.460613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.030 seconds
[0m12:22:17.460613 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: Close
[0m12:22:17.460613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134921D60>]}
[0m12:22:17.460613 [info ] [Thread-1 (]: 2 of 15 OK created sql view model public.stg_raw_actor ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:22:17.460613 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_actor
[0m12:22:17.460613 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_address
[0m12:22:17.460613 [info ] [Thread-1 (]: 3 of 15 START sql view model public.stg_raw_address ............................ [RUN]
[0m12:22:17.460613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_actor, now model.datavault_postgres_test.stg_raw_address)
[0m12:22:17.460613 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_address
[0m12:22:17.460613 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.460613 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_address
[0m12:22:17.481471 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.482471 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.482471 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: BEGIN
[0m12:22:17.482471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.527755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:22:17.527755 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.527755 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */

  create view "sakila_db"."public"."stg_raw_address__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."address"
  );
[0m12:22:17.527755 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.527755 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.527755 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
alter table "sakila_db"."public"."stg_raw_address" rename to "stg_raw_address__dbt_backup"
[0m12:22:17.527755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.527755 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.527755 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
alter table "sakila_db"."public"."stg_raw_address__dbt_tmp" rename to "stg_raw_address"
[0m12:22:17.542550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.544527 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: COMMIT
[0m12:22:17.544527 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.544527 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: COMMIT
[0m12:22:17.544527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:22:17.544527 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_address__dbt_backup"
[0m12:22:17.544527 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:22:17.544527 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
drop view if exists "sakila_db"."public"."stg_raw_address__dbt_backup" cascade
[0m12:22:17.544527 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:22:17.544527 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: Close
[0m12:22:17.544527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A627E0>]}
[0m12:22:17.544527 [info ] [Thread-1 (]: 3 of 15 OK created sql view model public.stg_raw_address ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:22:17.560469 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_address
[0m12:22:17.560469 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_category
[0m12:22:17.561705 [info ] [Thread-1 (]: 4 of 15 START sql view model public.stg_raw_category ........................... [RUN]
[0m12:22:17.562715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_address, now model.datavault_postgres_test.stg_raw_category)
[0m12:22:17.562715 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_category
[0m12:22:17.564714 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.565714 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_category
[0m12:22:17.569714 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.569714 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.570714 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: BEGIN
[0m12:22:17.570714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.612086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:22:17.612086 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.612086 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */

  create view "sakila_db"."public"."stg_raw_category__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."category"
  );
[0m12:22:17.612086 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.612086 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.612086 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */
alter table "sakila_db"."public"."stg_raw_category__dbt_tmp" rename to "stg_raw_category"
[0m12:22:17.612086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.627635 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: COMMIT
[0m12:22:17.628054 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.629118 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: COMMIT
[0m12:22:17.631395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:22:17.633400 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_category__dbt_backup"
[0m12:22:17.634400 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:22:17.635439 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */
drop view if exists "sakila_db"."public"."stg_raw_category__dbt_backup" cascade
[0m12:22:17.635439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:17.637438 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: Close
[0m12:22:17.637438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A64050>]}
[0m12:22:17.638400 [info ] [Thread-1 (]: 4 of 15 OK created sql view model public.stg_raw_category ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:22:17.639401 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_category
[0m12:22:17.639401 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_city
[0m12:22:17.640400 [info ] [Thread-1 (]: 5 of 15 START sql view model public.stg_raw_city ............................... [RUN]
[0m12:22:17.641401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_category, now model.datavault_postgres_test.stg_raw_city)
[0m12:22:17.641401 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_city
[0m12:22:17.644665 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.644665 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_city
[0m12:22:17.648765 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.649729 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.649729 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: BEGIN
[0m12:22:17.649729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.685214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:22:17.685214 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.685214 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */

  create view "sakila_db"."public"."stg_raw_city__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."actor"
  );
[0m12:22:17.695949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.695949 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.695949 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */
alter table "sakila_db"."public"."stg_raw_city__dbt_tmp" rename to "stg_raw_city"
[0m12:22:17.695949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.695949 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: COMMIT
[0m12:22:17.695949 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.695949 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: COMMIT
[0m12:22:17.695949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:17.695949 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_city__dbt_backup"
[0m12:22:17.710255 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:22:17.710255 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */
drop view if exists "sakila_db"."public"."stg_raw_city__dbt_backup" cascade
[0m12:22:17.711552 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:17.711552 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: Close
[0m12:22:17.711552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A133EB4E60>]}
[0m12:22:17.711552 [info ] [Thread-1 (]: 5 of 15 OK created sql view model public.stg_raw_city .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:22:17.711552 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_city
[0m12:22:17.711552 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_country
[0m12:22:17.711552 [info ] [Thread-1 (]: 6 of 15 START sql view model public.stg_raw_country ............................ [RUN]
[0m12:22:17.711552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_city, now model.datavault_postgres_test.stg_raw_country)
[0m12:22:17.711552 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_country
[0m12:22:17.711552 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.711552 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_country
[0m12:22:17.711552 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.728230 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.729243 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: BEGIN
[0m12:22:17.729243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.762841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:22:17.762841 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.762841 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */

  create view "sakila_db"."public"."stg_raw_country__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."country"
  );
[0m12:22:17.777296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.778302 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.778302 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */
alter table "sakila_db"."public"."stg_raw_country__dbt_tmp" rename to "stg_raw_country"
[0m12:22:17.778302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.778302 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: COMMIT
[0m12:22:17.778302 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.778302 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: COMMIT
[0m12:22:17.778302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:17.778302 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_country__dbt_backup"
[0m12:22:17.778302 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:22:17.778302 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */
drop view if exists "sakila_db"."public"."stg_raw_country__dbt_backup" cascade
[0m12:22:17.778302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:17.778302 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: Close
[0m12:22:17.778302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134DD2DB0>]}
[0m12:22:17.778302 [info ] [Thread-1 (]: 6 of 15 OK created sql view model public.stg_raw_country ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:22:17.795039 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_country
[0m12:22:17.796051 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film
[0m12:22:17.797092 [info ] [Thread-1 (]: 7 of 15 START sql view model public.stg_raw_film ............................... [RUN]
[0m12:22:17.798049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_country, now model.datavault_postgres_test.stg_raw_film)
[0m12:22:17.798049 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film
[0m12:22:17.801084 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.801084 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film
[0m12:22:17.805084 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.806085 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.806085 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: BEGIN
[0m12:22:17.807084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.977184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.175 seconds
[0m12:22:17.977184 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.977184 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */

  create view "sakila_db"."public"."stg_raw_film__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."film"
  );
[0m12:22:17.977184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:17.977184 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.990690 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */
alter table "sakila_db"."public"."stg_raw_film__dbt_tmp" rename to "stg_raw_film"
[0m12:22:17.990690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:17.990690 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: COMMIT
[0m12:22:17.990690 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.993769 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: COMMIT
[0m12:22:17.993769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:17.993769 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_film__dbt_backup"
[0m12:22:17.993769 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:22:17.993769 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */
drop view if exists "sakila_db"."public"."stg_raw_film__dbt_backup" cascade
[0m12:22:17.993769 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:17.993769 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: Close
[0m12:22:17.993769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134DD3BC0>]}
[0m12:22:17.993769 [info ] [Thread-1 (]: 7 of 15 OK created sql view model public.stg_raw_film .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:22:17.993769 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film
[0m12:22:17.993769 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film_actor
[0m12:22:17.993769 [info ] [Thread-1 (]: 8 of 15 START sql view model public.stg_raw_film_actor ......................... [RUN]
[0m12:22:17.993769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film, now model.datavault_postgres_test.stg_raw_film_actor)
[0m12:22:17.993769 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film_actor
[0m12:22:18.006587 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.006587 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film_actor
[0m12:22:18.010283 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.010283 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.010283 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: BEGIN
[0m12:22:18.010283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.050762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m12:22:18.050762 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.050762 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */

  create view "sakila_db"."public"."stg_raw_film_actor__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."film_actor"
  );
[0m12:22:18.061815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:18.061815 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.061815 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */
alter table "sakila_db"."public"."stg_raw_film_actor__dbt_tmp" rename to "stg_raw_film_actor"
[0m12:22:18.061815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.061815 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: COMMIT
[0m12:22:18.061815 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.061815 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: COMMIT
[0m12:22:18.061815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:18.061815 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_film_actor__dbt_backup"
[0m12:22:18.061815 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:22:18.061815 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */
drop view if exists "sakila_db"."public"."stg_raw_film_actor__dbt_backup" cascade
[0m12:22:18.061815 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.077004 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: Close
[0m12:22:18.078282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A3B7D0>]}
[0m12:22:18.079287 [info ] [Thread-1 (]: 8 of 15 OK created sql view model public.stg_raw_film_actor .................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:22:18.080288 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film_actor
[0m12:22:18.081295 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film_category
[0m12:22:18.081295 [info ] [Thread-1 (]: 9 of 15 START sql view model public.stg_raw_film_category ...................... [RUN]
[0m12:22:18.082324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film_actor, now model.datavault_postgres_test.stg_raw_film_category)
[0m12:22:18.083324 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film_category
[0m12:22:18.085329 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.086329 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film_category
[0m12:22:18.090326 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.091326 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.092322 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: BEGIN
[0m12:22:18.092322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.243800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.153 seconds
[0m12:22:18.243800 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.243800 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */

  create view "sakila_db"."public"."stg_raw_film_category__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."film_category"
  );
[0m12:22:18.252320 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:18.255617 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.255617 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */
alter table "sakila_db"."public"."stg_raw_film_category__dbt_tmp" rename to "stg_raw_film_category"
[0m12:22:18.256714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.258393 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: COMMIT
[0m12:22:18.258393 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.258952 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: COMMIT
[0m12:22:18.260577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:18.263839 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_film_category__dbt_backup"
[0m12:22:18.265472 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:22:18.266589 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */
drop view if exists "sakila_db"."public"."stg_raw_film_category__dbt_backup" cascade
[0m12:22:18.267730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.268873 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: Close
[0m12:22:18.269437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A6D580>]}
[0m12:22:18.270000 [info ] [Thread-1 (]: 9 of 15 OK created sql view model public.stg_raw_film_category ................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:22:18.271110 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film_category
[0m12:22:18.271681 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_inventory
[0m12:22:18.272278 [info ] [Thread-1 (]: 10 of 15 START sql view model public.stg_raw_inventory ......................... [RUN]
[0m12:22:18.273505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film_category, now model.datavault_postgres_test.stg_raw_inventory)
[0m12:22:18.273505 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_inventory
[0m12:22:18.276961 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.278264 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_inventory
[0m12:22:18.282364 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.282921 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.284022 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: BEGIN
[0m12:22:18.284022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.443662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m12:22:18.443662 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.443662 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */

  create view "sakila_db"."public"."stg_raw_inventory__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."inventory"
  );
[0m12:22:18.443662 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:18.458143 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.458143 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */
alter table "sakila_db"."public"."stg_raw_inventory__dbt_tmp" rename to "stg_raw_inventory"
[0m12:22:18.460156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.460156 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: COMMIT
[0m12:22:18.460156 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.460156 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: COMMIT
[0m12:22:18.460156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:22:18.460156 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_inventory__dbt_backup"
[0m12:22:18.460156 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:22:18.460156 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */
drop view if exists "sakila_db"."public"."stg_raw_inventory__dbt_backup" cascade
[0m12:22:18.460156 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.460156 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: Close
[0m12:22:18.460156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A65D60>]}
[0m12:22:18.460156 [info ] [Thread-1 (]: 10 of 15 OK created sql view model public.stg_raw_inventory .................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:22:18.460156 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_inventory
[0m12:22:18.474266 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_language
[0m12:22:18.474266 [info ] [Thread-1 (]: 11 of 15 START sql view model public.stg_raw_language .......................... [RUN]
[0m12:22:18.474266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_inventory, now model.datavault_postgres_test.stg_raw_language)
[0m12:22:18.474266 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_language
[0m12:22:18.479006 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.479006 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_language
[0m12:22:18.483016 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.483016 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.483016 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: BEGIN
[0m12:22:18.485021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.528400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:22:18.528400 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.528400 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */

  create view "sakila_db"."public"."stg_raw_language__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."language"
  );
[0m12:22:18.528400 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:18.528400 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.528400 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */
alter table "sakila_db"."public"."stg_raw_language__dbt_tmp" rename to "stg_raw_language"
[0m12:22:18.528400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.528400 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: COMMIT
[0m12:22:18.528400 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.528400 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: COMMIT
[0m12:22:18.528400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:18.546284 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_language__dbt_backup"
[0m12:22:18.547283 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:22:18.547283 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */
drop view if exists "sakila_db"."public"."stg_raw_language__dbt_backup" cascade
[0m12:22:18.548277 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.549316 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: Close
[0m12:22:18.550316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1340346B0>]}
[0m12:22:18.550316 [info ] [Thread-1 (]: 11 of 15 OK created sql view model public.stg_raw_language ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:22:18.551333 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_language
[0m12:22:18.552283 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_payment
[0m12:22:18.552283 [info ] [Thread-1 (]: 12 of 15 START sql view model public.stg_raw_payment ........................... [RUN]
[0m12:22:18.553282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_language, now model.datavault_postgres_test.stg_raw_payment)
[0m12:22:18.553282 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_payment
[0m12:22:18.557282 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.558282 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_payment
[0m12:22:18.595840 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.595840 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.595840 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: BEGIN
[0m12:22:18.595840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.743814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m12:22:18.743814 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.757611 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */

  create view "sakila_db"."public"."stg_raw_payment__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."payment"
  );
[0m12:22:18.760218 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:18.760218 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.760218 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */
alter table "sakila_db"."public"."stg_raw_payment__dbt_tmp" rename to "stg_raw_payment"
[0m12:22:18.760218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.760218 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: COMMIT
[0m12:22:18.760218 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.760218 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: COMMIT
[0m12:22:18.760218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:18.773339 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_payment__dbt_backup"
[0m12:22:18.773339 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:22:18.773339 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */
drop view if exists "sakila_db"."public"."stg_raw_payment__dbt_backup" cascade
[0m12:22:18.773339 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.773339 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: Close
[0m12:22:18.777018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134DC4560>]}
[0m12:22:18.777018 [info ] [Thread-1 (]: 12 of 15 OK created sql view model public.stg_raw_payment ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:22:18.777018 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_payment
[0m12:22:18.777018 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_rental
[0m12:22:18.777018 [info ] [Thread-1 (]: 13 of 15 START sql view model public.stg_raw_rental ............................ [RUN]
[0m12:22:18.777018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_payment, now model.datavault_postgres_test.stg_raw_rental)
[0m12:22:18.777018 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_rental
[0m12:22:18.777018 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.777018 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_rental
[0m12:22:18.777018 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.789078 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.789078 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: BEGIN
[0m12:22:18.790165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.828391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:22:18.828391 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.828391 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */

  create view "sakila_db"."public"."stg_raw_rental__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."rental"
  );
[0m12:22:18.828391 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:22:18.828391 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.844051 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */
alter table "sakila_db"."public"."stg_raw_rental__dbt_tmp" rename to "stg_raw_rental"
[0m12:22:18.845066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:22:18.846109 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: COMMIT
[0m12:22:18.847109 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.847109 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: COMMIT
[0m12:22:18.849517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:18.851521 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_rental__dbt_backup"
[0m12:22:18.852522 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:22:18.852522 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */
drop view if exists "sakila_db"."public"."stg_raw_rental__dbt_backup" cascade
[0m12:22:18.853522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.854521 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: Close
[0m12:22:18.855522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A133D43140>]}
[0m12:22:18.856522 [info ] [Thread-1 (]: 13 of 15 OK created sql view model public.stg_raw_rental ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:22:18.856522 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_rental
[0m12:22:18.857523 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_staff
[0m12:22:18.857523 [info ] [Thread-1 (]: 14 of 15 START sql view model public.stg_raw_staff ............................. [RUN]
[0m12:22:18.858523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_rental, now model.datavault_postgres_test.stg_raw_staff)
[0m12:22:18.859523 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_staff
[0m12:22:18.862350 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.863348 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_staff
[0m12:22:18.867308 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.868308 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.868308 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: BEGIN
[0m12:22:18.869309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.910707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:22:18.911727 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.913242 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */

  create view "sakila_db"."public"."stg_raw_staff__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."staff"
  );
[0m12:22:18.913242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:22:18.913242 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.913242 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */
alter table "sakila_db"."public"."stg_raw_staff__dbt_tmp" rename to "stg_raw_staff"
[0m12:22:18.913242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.913242 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: COMMIT
[0m12:22:18.913242 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.913242 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: COMMIT
[0m12:22:18.927506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:22:18.929459 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_staff__dbt_backup"
[0m12:22:18.929459 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:22:18.929459 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */
drop view if exists "sakila_db"."public"."stg_raw_staff__dbt_backup" cascade
[0m12:22:18.929459 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:18.929459 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: Close
[0m12:22:18.929459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A2E600>]}
[0m12:22:18.929459 [info ] [Thread-1 (]: 14 of 15 OK created sql view model public.stg_raw_staff ........................ [[32mCREATE VIEW[0m in 0.07s]
[0m12:22:18.937226 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_staff
[0m12:22:18.937226 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_store
[0m12:22:18.937226 [info ] [Thread-1 (]: 15 of 15 START sql view model public.stg_raw_store ............................. [RUN]
[0m12:22:18.937226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_staff, now model.datavault_postgres_test.stg_raw_store)
[0m12:22:18.937226 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_store
[0m12:22:18.937226 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_store"
[0m12:22:18.943783 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_store
[0m12:22:18.948446 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_store"
[0m12:22:18.949409 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:22:18.950438 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: BEGIN
[0m12:22:18.950438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:18.994822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:22:18.994822 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:22:18.994822 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */

  create view "sakila_db"."public"."stg_raw_store__dbt_tmp"
    
    
  as (
    select * from "sakila_db"."public"."store"
  );
[0m12:22:18.994822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:22:18.994822 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:22:18.994822 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */
alter table "sakila_db"."public"."stg_raw_store__dbt_tmp" rename to "stg_raw_store"
[0m12:22:18.994822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:18.994822 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: COMMIT
[0m12:22:18.994822 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:22:18.994822 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: COMMIT
[0m12:22:18.994822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:22:19.012831 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_store__dbt_backup"
[0m12:22:19.013832 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:22:19.013832 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */
drop view if exists "sakila_db"."public"."stg_raw_store__dbt_backup" cascade
[0m12:22:19.014826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:22:19.015861 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: Close
[0m12:22:19.016862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc581fbb-86ad-4465-b4e9-b1b93d1b5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A134A4F6E0>]}
[0m12:22:19.016862 [info ] [Thread-1 (]: 15 of 15 OK created sql view model public.stg_raw_store ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m12:22:19.017863 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_store
[0m12:22:19.019828 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:19.019828 [debug] [MainThread]: On master: BEGIN
[0m12:22:19.019828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:19.061650 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:22:19.062432 [debug] [MainThread]: On master: COMMIT
[0m12:22:19.062432 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:19.062432 [debug] [MainThread]: On master: COMMIT
[0m12:22:19.062432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:22:19.062432 [debug] [MainThread]: On master: Close
[0m12:22:19.062432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:19.062432 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m12:22:19.062432 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m12:22:19.066198 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_raw_store' was properly closed.
[0m12:22:19.066198 [info ] [MainThread]: 
[0m12:22:19.066198 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m12:22:19.069779 [debug] [MainThread]: Command end result
[0m12:22:19.093980 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:22:19.098256 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:22:19.102293 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m12:22:19.102293 [info ] [MainThread]: 
[0m12:22:19.102293 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:19.102293 [info ] [MainThread]: 
[0m12:22:19.102293 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m12:22:19.102293 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:22:19.102293 [debug] [MainThread]: Command `dbt build` succeeded at 12:22:19.102293 after 3.91 seconds
[0m12:22:19.102293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1347EA000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1347E9C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1347E8590>]}
[0m12:22:19.102293 [debug] [MainThread]: Flushing usage events
[0m12:22:20.736428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:47.384206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A090B2E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A08FA7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0B538E30>]}


============================== 12:29:47.388558 | 39a9fac3-960b-4996-9c2f-44f0e76f6184 ==============================
[0m12:29:47.388558 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:29:47.389554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -m .\\models\\stg_raw\\*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:29:47.389554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m12:29:47.390559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0B53B320>]}
[0m12:29:47.599512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0BC0D7F0>]}
[0m12:29:47.662304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A09B27E60>]}
[0m12:29:47.664285 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:29:47.913347 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:29:48.162237 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 14 files changed.
[0m12:29:48.163231 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_raw\stg_raw_customer.sql
[0m12:29:48.163231 [debug] [MainThread]: Partial parsing: deleted file: datavault_postgres_test://models\stg_raw\stg_customer.sql
[0m12:29:48.164232 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_film.sql
[0m12:29:48.164232 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_address.sql
[0m12:29:48.165237 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_staff.sql
[0m12:29:48.165237 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_store.sql
[0m12:29:48.166231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_inventory.sql
[0m12:29:48.166231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_payment.sql
[0m12:29:48.167233 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_category.sql
[0m12:29:48.167233 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_actor.sql
[0m12:29:48.168231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_language.sql
[0m12:29:48.168231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_film_category.sql
[0m12:29:48.168231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_city.sql
[0m12:29:48.169232 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_film_actor.sql
[0m12:29:48.169232 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_country.sql
[0m12:29:48.170231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_rental.sql
[0m12:29:48.529845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0D2706E0>]}
[0m12:29:48.610670 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:29:48.624155 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:29:48.671284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0D96C7D0>]}
[0m12:29:48.671284 [info ] [MainThread]: Found 17 models, 4 data tests, 15 sources, 433 macros
[0m12:29:48.729160 [info ] [MainThread]: 
[0m12:29:48.730148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:48.730148 [info ] [MainThread]: 
[0m12:29:48.731122 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:48.737146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m12:29:48.818180 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m12:29:48.818180 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:48.819179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:48.867269 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m12:29:48.869313 [debug] [ThreadPool]: On list_sakila_db: Close
[0m12:29:48.873276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m12:29:48.879927 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:29:48.879927 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m12:29:48.879927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:48.923794 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m12:29:48.923794 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:29:48.924799 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:29:48.932115 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.007 seconds
[0m12:29:48.933111 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m12:29:48.934154 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m12:29:48.946097 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:48.946097 [debug] [MainThread]: On master: BEGIN
[0m12:29:48.947098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:48.988450 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m12:29:48.988450 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:48.989487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:48.998496 [debug] [MainThread]: SQL status: SELECT 57 in 0.009 seconds
[0m12:29:49.010458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0D6FBC80>]}
[0m12:29:49.010458 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:49.010458 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:49.010458 [debug] [MainThread]: On master: BEGIN
[0m12:29:49.010458 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:29:49.010458 [debug] [MainThread]: On master: COMMIT
[0m12:29:49.010458 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:49.010458 [debug] [MainThread]: On master: COMMIT
[0m12:29:49.010458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:49.010458 [debug] [MainThread]: On master: Close
[0m12:29:49.021246 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_actor
[0m12:29:49.021246 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_raw_actor .............................. [RUN]
[0m12:29:49.021246 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_raw_actor'
[0m12:29:49.021246 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_actor
[0m12:29:49.030846 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:29:49.031881 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_actor
[0m12:29:49.067336 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:29:49.068337 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:29:49.069342 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: BEGIN
[0m12:29:49.069342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:29:49.111624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:29:49.111624 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:29:49.112666 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */

  create view "sakila_db"."public"."stg_raw_actor__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."actor" as rsrc
from "sakila_db"."public"."actor"
  );
[0m12:29:49.113669 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."actor" as rsrc
            ^

[0m12:29:49.113669 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: ROLLBACK
[0m12:29:49.114666 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: Close
[0m12:29:49.213262 [debug] [Thread-1 (]: Database Error in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."actor" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql
[0m12:29:49.215261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0B508140>]}
[0m12:29:49.215261 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.stg_raw_actor ..................... [[31mERROR[0m in 0.19s]
[0m12:29:49.216298 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_actor
[0m12:29:49.217298 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_address
[0m12:29:49.218298 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."actor" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql.
[0m12:29:49.217298 [info ] [Thread-1 (]: 2 of 15 START sql view model public.stg_raw_address ............................ [RUN]
[0m12:29:49.219197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_actor, now model.datavault_postgres_test.stg_raw_address)
[0m12:29:49.219197 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_address
[0m12:29:49.222202 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_address"
[0m12:29:49.223202 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_address
[0m12:29:49.228506 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_address"
[0m12:29:49.229515 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:29:49.230530 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: BEGIN
[0m12:29:49.230530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.275984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:29:49.275984 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:29:49.277015 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */

  create view "sakila_db"."public"."stg_raw_address__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."address" as rsrc
from "sakila_db"."public"."address"
  );
[0m12:29:49.278071 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."address" as rsrc
            ^

[0m12:29:49.278071 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: ROLLBACK
[0m12:29:49.279114 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: Close
[0m12:29:49.282109 [debug] [Thread-1 (]: Database Error in model stg_raw_address (models\stg_raw\stg_raw_address.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."address" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_address.sql
[0m12:29:49.283113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E0424B0>]}
[0m12:29:49.283113 [error] [Thread-1 (]: 2 of 15 ERROR creating sql view model public.stg_raw_address ................... [[31mERROR[0m in 0.06s]
[0m12:29:49.285083 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_address
[0m12:29:49.285083 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_category
[0m12:29:49.286080 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_address' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_address (models\stg_raw\stg_raw_address.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."address" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_address.sql.
[0m12:29:49.286080 [info ] [Thread-1 (]: 3 of 15 START sql view model public.stg_raw_category ........................... [RUN]
[0m12:29:49.287078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_address, now model.datavault_postgres_test.stg_raw_category)
[0m12:29:49.288080 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_category
[0m12:29:49.291113 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_category"
[0m12:29:49.292114 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_category
[0m12:29:49.295712 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_category"
[0m12:29:49.296711 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:29:49.297675 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: BEGIN
[0m12:29:49.297675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.348520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m12:29:49.349521 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:29:49.350524 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */

  create view "sakila_db"."public"."stg_raw_category__dbt_tmp"
    
    
  as (
    select 
    *,
    current_timestamp as ldts,
    "sakila_db"."public"."category" as rsrc
from "sakila_db"."public"."category"
  );
[0m12:29:49.351524 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 10:     "sakila_db"."public"."category" as rsrc
             ^

[0m12:29:49.352558 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: ROLLBACK
[0m12:29:49.353518 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: Close
[0m12:29:49.356520 [debug] [Thread-1 (]: Database Error in model stg_raw_category (models\stg_raw\stg_raw_category.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 10:     "sakila_db"."public"."category" as rsrc
               ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_category.sql
[0m12:29:49.356520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0DF80500>]}
[0m12:29:49.357519 [error] [Thread-1 (]: 3 of 15 ERROR creating sql view model public.stg_raw_category .................. [[31mERROR[0m in 0.07s]
[0m12:29:49.358518 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_category
[0m12:29:49.358518 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_city
[0m12:29:49.359557 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_category' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_category (models\stg_raw\stg_raw_category.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 10:     "sakila_db"."public"."category" as rsrc
               ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_category.sql.
[0m12:29:49.359557 [info ] [Thread-1 (]: 4 of 15 START sql view model public.stg_raw_city ............................... [RUN]
[0m12:29:49.360523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_category, now model.datavault_postgres_test.stg_raw_city)
[0m12:29:49.361768 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_city
[0m12:29:49.364774 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_city"
[0m12:29:49.366777 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_city
[0m12:29:49.373810 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_city"
[0m12:29:49.374811 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:29:49.375775 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: BEGIN
[0m12:29:49.375775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.425558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:29:49.425558 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:29:49.425558 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */

  create view "sakila_db"."public"."stg_raw_city__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."city" as rsrc
from "sakila_db"."public"."city"
  );
[0m12:29:49.427062 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."city" as rsrc
            ^

[0m12:29:49.428095 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: ROLLBACK
[0m12:29:49.429107 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: Close
[0m12:29:49.431107 [debug] [Thread-1 (]: Database Error in model stg_raw_city (models\stg_raw\stg_raw_city.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."city" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_city.sql
[0m12:29:49.432110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E3E3620>]}
[0m12:29:49.433105 [error] [Thread-1 (]: 4 of 15 ERROR creating sql view model public.stg_raw_city ...................... [[31mERROR[0m in 0.07s]
[0m12:29:49.434104 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_city
[0m12:29:49.435103 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_country
[0m12:29:49.436102 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_city' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_city (models\stg_raw\stg_raw_city.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."city" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_city.sql.
[0m12:29:49.435103 [info ] [Thread-1 (]: 5 of 15 START sql view model public.stg_raw_country ............................ [RUN]
[0m12:29:49.437138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_city, now model.datavault_postgres_test.stg_raw_country)
[0m12:29:49.437138 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_country
[0m12:29:49.440139 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_country"
[0m12:29:49.441103 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_country
[0m12:29:49.445698 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_country"
[0m12:29:49.446701 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:29:49.446701 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: BEGIN
[0m12:29:49.446701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.492017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:29:49.492017 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:29:49.493561 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */

  create view "sakila_db"."public"."stg_raw_country__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."country" as rsrc
from "sakila_db"."public"."country"
  );
[0m12:29:49.495576 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."country" as rsrc
            ^

[0m12:29:49.495576 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: ROLLBACK
[0m12:29:49.496615 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: Close
[0m12:29:49.499599 [debug] [Thread-1 (]: Database Error in model stg_raw_country (models\stg_raw\stg_raw_country.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."country" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_country.sql
[0m12:29:49.500610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E40F0B0>]}
[0m12:29:49.501611 [error] [Thread-1 (]: 5 of 15 ERROR creating sql view model public.stg_raw_country ................... [[31mERROR[0m in 0.06s]
[0m12:29:49.502621 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_country
[0m12:29:49.502621 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_customer
[0m12:29:49.503573 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_country' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_country (models\stg_raw\stg_raw_country.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."country" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_country.sql.
[0m12:29:49.503573 [info ] [Thread-1 (]: 6 of 15 START sql view model public.stg_raw_customer ........................... [RUN]
[0m12:29:49.504583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_country, now model.datavault_postgres_test.stg_raw_customer)
[0m12:29:49.504583 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_customer
[0m12:29:49.507611 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_customer"
[0m12:29:49.509578 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_customer
[0m12:29:49.514767 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_customer"
[0m12:29:49.515769 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:29:49.516769 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: BEGIN
[0m12:29:49.516769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.562787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:29:49.563828 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:29:49.563828 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_customer"} */

  create view "sakila_db"."public"."stg_raw_customer__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."customer" as rsrc
from "sakila_db"."public"."customer"
  );
[0m12:29:49.564825 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."customer" as rsrc
            ^

[0m12:29:49.565788 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: ROLLBACK
[0m12:29:49.565788 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: Close
[0m12:29:49.568788 [debug] [Thread-1 (]: Database Error in model stg_raw_customer (models\stg_raw\stg_raw_customer.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."customer" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_customer.sql
[0m12:29:49.570790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E4231D0>]}
[0m12:29:49.570790 [error] [Thread-1 (]: 6 of 15 ERROR creating sql view model public.stg_raw_customer .................. [[31mERROR[0m in 0.07s]
[0m12:29:49.571788 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_customer
[0m12:29:49.572788 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film
[0m12:29:49.573788 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_customer (models\stg_raw\stg_raw_customer.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."customer" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_customer.sql.
[0m12:29:49.572788 [info ] [Thread-1 (]: 7 of 15 START sql view model public.stg_raw_film ............................... [RUN]
[0m12:29:49.573788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_customer, now model.datavault_postgres_test.stg_raw_film)
[0m12:29:49.574824 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film
[0m12:29:49.576824 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film"
[0m12:29:49.578021 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film
[0m12:29:49.585027 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film"
[0m12:29:49.586080 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:29:49.587027 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: BEGIN
[0m12:29:49.587027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.636556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:29:49.636556 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:29:49.637517 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */

  create view "sakila_db"."public"."stg_raw_film__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."film" as rsrc
from "sakila_db"."public"."film"
  );
[0m12:29:49.638517 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."film" as rsrc
            ^

[0m12:29:49.639517 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: ROLLBACK
[0m12:29:49.639962 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: Close
[0m12:29:49.642007 [debug] [Thread-1 (]: Database Error in model stg_raw_film (models\stg_raw\stg_raw_film.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film.sql
[0m12:29:49.642007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E41F5C0>]}
[0m12:29:49.643549 [error] [Thread-1 (]: 7 of 15 ERROR creating sql view model public.stg_raw_film ...................... [[31mERROR[0m in 0.07s]
[0m12:29:49.644558 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film
[0m12:29:49.645601 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film_actor
[0m12:29:49.646601 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_film' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_film (models\stg_raw\stg_raw_film.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film.sql.
[0m12:29:49.645601 [info ] [Thread-1 (]: 8 of 15 START sql view model public.stg_raw_film_actor ......................... [RUN]
[0m12:29:49.647564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film, now model.datavault_postgres_test.stg_raw_film_actor)
[0m12:29:49.647564 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film_actor
[0m12:29:49.651604 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:29:49.652565 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film_actor
[0m12:29:49.656600 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:29:49.657565 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:29:49.657565 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: BEGIN
[0m12:29:49.657565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.701801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:29:49.702844 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:29:49.702844 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */

  create view "sakila_db"."public"."stg_raw_film_actor__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."film_actor" as rsrc
from "sakila_db"."public"."film_actor"
  );
[0m12:29:49.703808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."film_actor" as rsrc
            ^

[0m12:29:49.703808 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: ROLLBACK
[0m12:29:49.704847 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: Close
[0m12:29:49.707822 [debug] [Thread-1 (]: Database Error in model stg_raw_film_actor (models\stg_raw\stg_raw_film_actor.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film_actor" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film_actor.sql
[0m12:29:49.707822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0DF447A0>]}
[0m12:29:49.708806 [error] [Thread-1 (]: 8 of 15 ERROR creating sql view model public.stg_raw_film_actor ................ [[31mERROR[0m in 0.06s]
[0m12:29:49.708806 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film_actor
[0m12:29:49.710349 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film_category
[0m12:29:49.711354 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_film_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_film_actor (models\stg_raw\stg_raw_film_actor.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film_actor" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film_actor.sql.
[0m12:29:49.712360 [info ] [Thread-1 (]: 9 of 15 START sql view model public.stg_raw_film_category ...................... [RUN]
[0m12:29:49.713360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film_actor, now model.datavault_postgres_test.stg_raw_film_category)
[0m12:29:49.714398 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film_category
[0m12:29:49.717399 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film_category"
[0m12:29:49.718397 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film_category
[0m12:29:49.722396 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film_category"
[0m12:29:49.723395 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:29:49.723395 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: BEGIN
[0m12:29:49.724395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.772742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:29:49.773969 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:29:49.773969 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */

  create view "sakila_db"."public"."stg_raw_film_category__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."film_category" as rsrc
from "sakila_db"."public"."film_category"
  );
[0m12:29:49.774976 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."film_category" as rsrc
            ^

[0m12:29:49.775977 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: ROLLBACK
[0m12:29:49.777028 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: Close
[0m12:29:49.784105 [debug] [Thread-1 (]: Database Error in model stg_raw_film_category (models\stg_raw\stg_raw_film_category.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film_category" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film_category.sql
[0m12:29:49.785106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0B538920>]}
[0m12:29:49.785106 [error] [Thread-1 (]: 9 of 15 ERROR creating sql view model public.stg_raw_film_category ............. [[31mERROR[0m in 0.07s]
[0m12:29:49.786104 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film_category
[0m12:29:49.787071 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_inventory
[0m12:29:49.788069 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_film_category' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_film_category (models\stg_raw\stg_raw_film_category.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film_category" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film_category.sql.
[0m12:29:49.788069 [info ] [Thread-1 (]: 10 of 15 START sql view model public.stg_raw_inventory ......................... [RUN]
[0m12:29:49.789067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film_category, now model.datavault_postgres_test.stg_raw_inventory)
[0m12:29:49.789067 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_inventory
[0m12:29:49.792071 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_inventory"
[0m12:29:49.792071 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_inventory
[0m12:29:49.796629 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_inventory"
[0m12:29:49.798626 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:29:49.798626 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: BEGIN
[0m12:29:49.798626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.846989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m12:29:49.846989 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:29:49.847989 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */

  create view "sakila_db"."public"."stg_raw_inventory__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."inventory" as rsrc
from "sakila_db"."public"."inventory"
  );
[0m12:29:49.849026 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."inventory" as rsrc
            ^

[0m12:29:49.849026 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: ROLLBACK
[0m12:29:49.850023 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: Close
[0m12:29:49.852986 [debug] [Thread-1 (]: Database Error in model stg_raw_inventory (models\stg_raw\stg_raw_inventory.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."inventory" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_inventory.sql
[0m12:29:49.853985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E01CB00>]}
[0m12:29:49.853985 [error] [Thread-1 (]: 10 of 15 ERROR creating sql view model public.stg_raw_inventory ................ [[31mERROR[0m in 0.06s]
[0m12:29:49.855022 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_inventory
[0m12:29:49.855989 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_language
[0m12:29:49.857022 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_inventory (models\stg_raw\stg_raw_inventory.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."inventory" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_inventory.sql.
[0m12:29:49.855989 [info ] [Thread-1 (]: 11 of 15 START sql view model public.stg_raw_language .......................... [RUN]
[0m12:29:49.858021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_inventory, now model.datavault_postgres_test.stg_raw_language)
[0m12:29:49.858021 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_language
[0m12:29:49.861569 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_language"
[0m12:29:49.861569 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_language
[0m12:29:49.865613 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_language"
[0m12:29:49.866612 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:29:49.866612 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: BEGIN
[0m12:29:49.867588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.918628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m12:29:49.919625 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:29:49.919625 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */

  create view "sakila_db"."public"."stg_raw_language__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."language" as rsrc
from "sakila_db"."public"."language"
  );
[0m12:29:49.920588 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."language" as rsrc
            ^

[0m12:29:49.921588 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: ROLLBACK
[0m12:29:49.922067 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: Close
[0m12:29:49.924072 [debug] [Thread-1 (]: Database Error in model stg_raw_language (models\stg_raw\stg_raw_language.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."language" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_language.sql
[0m12:29:49.925073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E429DC0>]}
[0m12:29:49.926072 [error] [Thread-1 (]: 11 of 15 ERROR creating sql view model public.stg_raw_language ................. [[31mERROR[0m in 0.07s]
[0m12:29:49.927074 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_language
[0m12:29:49.927404 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_payment
[0m12:29:49.928416 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_language' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_language (models\stg_raw\stg_raw_language.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."language" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_language.sql.
[0m12:29:49.928416 [info ] [Thread-1 (]: 12 of 15 START sql view model public.stg_raw_payment ........................... [RUN]
[0m12:29:49.930445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_language, now model.datavault_postgres_test.stg_raw_payment)
[0m12:29:49.930445 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_payment
[0m12:29:49.934458 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_payment"
[0m12:29:49.935459 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_payment
[0m12:29:49.941458 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_payment"
[0m12:29:49.942423 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:29:49.942423 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: BEGIN
[0m12:29:49.942423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.986609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m12:29:49.986609 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:29:49.987644 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */

  create view "sakila_db"."public"."stg_raw_payment__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."payment" as rsrc
from "sakila_db"."public"."payment"
  );
[0m12:29:49.988607 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."payment" as rsrc
            ^

[0m12:29:49.988607 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: ROLLBACK
[0m12:29:49.989644 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: Close
[0m12:29:49.992610 [debug] [Thread-1 (]: Database Error in model stg_raw_payment (models\stg_raw\stg_raw_payment.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."payment" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_payment.sql
[0m12:29:49.992610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E447A70>]}
[0m12:29:49.993606 [error] [Thread-1 (]: 12 of 15 ERROR creating sql view model public.stg_raw_payment .................. [[31mERROR[0m in 0.06s]
[0m12:29:49.994755 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_payment
[0m12:29:49.995761 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_rental
[0m12:29:49.996758 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_payment' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_payment (models\stg_raw\stg_raw_payment.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."payment" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_payment.sql.
[0m12:29:49.996758 [info ] [Thread-1 (]: 13 of 15 START sql view model public.stg_raw_rental ............................ [RUN]
[0m12:29:49.997809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_payment, now model.datavault_postgres_test.stg_raw_rental)
[0m12:29:49.997809 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_rental
[0m12:29:50.001801 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_rental"
[0m12:29:50.002801 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_rental
[0m12:29:50.066227 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_rental"
[0m12:29:50.068191 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:29:50.068191 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: BEGIN
[0m12:29:50.068191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:50.112236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:29:50.113274 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:29:50.113274 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */

  create view "sakila_db"."public"."stg_raw_rental__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."rental" as rsrc
from "sakila_db"."public"."rental"
  );
[0m12:29:50.114275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."rental" as rsrc
            ^

[0m12:29:50.115280 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: ROLLBACK
[0m12:29:50.116237 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: Close
[0m12:29:50.118236 [debug] [Thread-1 (]: Database Error in model stg_raw_rental (models\stg_raw\stg_raw_rental.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."rental" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_rental.sql
[0m12:29:50.119236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0E447F50>]}
[0m12:29:50.119236 [error] [Thread-1 (]: 13 of 15 ERROR creating sql view model public.stg_raw_rental ................... [[31mERROR[0m in 0.12s]
[0m12:29:50.120235 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_rental
[0m12:29:50.120235 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_staff
[0m12:29:50.122253 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_rental' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_rental (models\stg_raw\stg_raw_rental.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."rental" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_rental.sql.
[0m12:29:50.121274 [info ] [Thread-1 (]: 14 of 15 START sql view model public.stg_raw_staff ............................. [RUN]
[0m12:29:50.122253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_rental, now model.datavault_postgres_test.stg_raw_staff)
[0m12:29:50.123274 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_staff
[0m12:29:50.125277 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_staff"
[0m12:29:50.126784 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_staff
[0m12:29:50.133325 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_staff"
[0m12:29:50.134292 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:29:50.134292 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: BEGIN
[0m12:29:50.134292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:50.289493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m12:29:50.289493 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:29:50.290530 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */

  create view "sakila_db"."public"."stg_raw_staff__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."staff" as rsrc
from "sakila_db"."public"."staff"
  );
[0m12:29:50.291493 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."staff" as rsrc
            ^

[0m12:29:50.291493 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: ROLLBACK
[0m12:29:50.292531 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: Close
[0m12:29:50.295508 [debug] [Thread-1 (]: Database Error in model stg_raw_staff (models\stg_raw\stg_raw_staff.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."staff" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_staff.sql
[0m12:29:50.296518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0D6F6630>]}
[0m12:29:50.297518 [error] [Thread-1 (]: 14 of 15 ERROR creating sql view model public.stg_raw_staff .................... [[31mERROR[0m in 0.17s]
[0m12:29:50.298511 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_staff
[0m12:29:50.298511 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_store
[0m12:29:50.299552 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_staff' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_staff (models\stg_raw\stg_raw_staff.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."staff" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_staff.sql.
[0m12:29:50.298511 [info ] [Thread-1 (]: 15 of 15 START sql view model public.stg_raw_store ............................. [RUN]
[0m12:29:50.300515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_staff, now model.datavault_postgres_test.stg_raw_store)
[0m12:29:50.300515 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_store
[0m12:29:50.303553 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_store"
[0m12:29:50.304552 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_store
[0m12:29:50.307550 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_store"
[0m12:29:50.308551 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:29:50.308551 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: BEGIN
[0m12:29:50.309552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:50.353774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:29:50.354812 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:29:50.354812 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */

  create view "sakila_db"."public"."stg_raw_store__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    "sakila_db"."public"."store" as rsrc
from "sakila_db"."public"."store"
  );
[0m12:29:50.355773 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
LINE 9:     "sakila_db"."public"."store" as rsrc
            ^

[0m12:29:50.356812 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: ROLLBACK
[0m12:29:50.356812 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: Close
[0m12:29:50.358773 [debug] [Thread-1 (]: Database Error in model stg_raw_store (models\stg_raw\stg_raw_store.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."store" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_store.sql
[0m12:29:50.360278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a9fac3-960b-4996-9c2f-44f0e76f6184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0D2BEF60>]}
[0m12:29:50.361287 [error] [Thread-1 (]: 15 of 15 ERROR creating sql view model public.stg_raw_store .................... [[31mERROR[0m in 0.06s]
[0m12:29:50.362455 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_store
[0m12:29:50.363494 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_raw_store' to be skipped because of status 'error'.  Reason: Database Error in model stg_raw_store (models\stg_raw\stg_raw_store.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."store" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_store.sql.
[0m12:29:50.364456 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:50.365454 [debug] [MainThread]: On master: BEGIN
[0m12:29:50.365454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:50.411532 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m12:29:50.411532 [debug] [MainThread]: On master: COMMIT
[0m12:29:50.411532 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:50.412563 [debug] [MainThread]: On master: COMMIT
[0m12:29:50.412563 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:50.413538 [debug] [MainThread]: On master: Close
[0m12:29:50.413538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:50.414537 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m12:29:50.414537 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m12:29:50.414537 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_raw_store' was properly closed.
[0m12:29:50.415547 [info ] [MainThread]: 
[0m12:29:50.416541 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m12:29:50.420536 [debug] [MainThread]: Command end result
[0m12:29:50.446626 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:29:50.449623 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:29:50.457622 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m12:29:50.457622 [info ] [MainThread]: 
[0m12:29:50.458622 [info ] [MainThread]: [31mCompleted with 15 errors, 0 partial successes, and 0 warnings:[0m
[0m12:29:50.458622 [info ] [MainThread]: 
[0m12:29:50.458622 [error] [MainThread]: [31mFailure in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)[0m
[0m12:29:50.460128 [error] [MainThread]:   Database Error in model stg_raw_actor (models\stg_raw\stg_raw_actor.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."actor" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql
[0m12:29:50.461133 [info ] [MainThread]: 
[0m12:29:50.462228 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_actor.sql
[0m12:29:50.463227 [info ] [MainThread]: 
[0m12:29:50.463227 [error] [MainThread]: [31mFailure in model stg_raw_address (models\stg_raw\stg_raw_address.sql)[0m
[0m12:29:50.464226 [error] [MainThread]:   Database Error in model stg_raw_address (models\stg_raw\stg_raw_address.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."address" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_address.sql
[0m12:29:50.465229 [info ] [MainThread]: 
[0m12:29:50.465229 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_address.sql
[0m12:29:50.466263 [info ] [MainThread]: 
[0m12:29:50.467228 [error] [MainThread]: [31mFailure in model stg_raw_category (models\stg_raw\stg_raw_category.sql)[0m
[0m12:29:50.467228 [error] [MainThread]:   Database Error in model stg_raw_category (models\stg_raw\stg_raw_category.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 10:     "sakila_db"."public"."category" as rsrc
               ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_category.sql
[0m12:29:50.468226 [info ] [MainThread]: 
[0m12:29:50.469229 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_category.sql
[0m12:29:50.469229 [info ] [MainThread]: 
[0m12:29:50.470241 [error] [MainThread]: [31mFailure in model stg_raw_city (models\stg_raw\stg_raw_city.sql)[0m
[0m12:29:50.471227 [error] [MainThread]:   Database Error in model stg_raw_city (models\stg_raw\stg_raw_city.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."city" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_city.sql
[0m12:29:50.472228 [info ] [MainThread]: 
[0m12:29:50.473226 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_city.sql
[0m12:29:50.474226 [info ] [MainThread]: 
[0m12:29:50.474226 [error] [MainThread]: [31mFailure in model stg_raw_country (models\stg_raw\stg_raw_country.sql)[0m
[0m12:29:50.475226 [error] [MainThread]:   Database Error in model stg_raw_country (models\stg_raw\stg_raw_country.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."country" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_country.sql
[0m12:29:50.476237 [info ] [MainThread]: 
[0m12:29:50.477586 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_country.sql
[0m12:29:50.478452 [info ] [MainThread]: 
[0m12:29:50.479547 [error] [MainThread]: [31mFailure in model stg_raw_customer (models\stg_raw\stg_raw_customer.sql)[0m
[0m12:29:50.481542 [error] [MainThread]:   Database Error in model stg_raw_customer (models\stg_raw\stg_raw_customer.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."customer" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_customer.sql
[0m12:29:50.482553 [info ] [MainThread]: 
[0m12:29:50.484551 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_customer.sql
[0m12:29:50.485546 [info ] [MainThread]: 
[0m12:29:50.486558 [error] [MainThread]: [31mFailure in model stg_raw_film (models\stg_raw\stg_raw_film.sql)[0m
[0m12:29:50.487543 [error] [MainThread]:   Database Error in model stg_raw_film (models\stg_raw\stg_raw_film.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film.sql
[0m12:29:50.488546 [info ] [MainThread]: 
[0m12:29:50.490558 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_film.sql
[0m12:29:50.491556 [info ] [MainThread]: 
[0m12:29:50.491556 [error] [MainThread]: [31mFailure in model stg_raw_film_actor (models\stg_raw\stg_raw_film_actor.sql)[0m
[0m12:29:50.492556 [error] [MainThread]:   Database Error in model stg_raw_film_actor (models\stg_raw\stg_raw_film_actor.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film_actor" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film_actor.sql
[0m12:29:50.493553 [info ] [MainThread]: 
[0m12:29:50.494690 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_film_actor.sql
[0m12:29:50.495526 [info ] [MainThread]: 
[0m12:29:50.496541 [error] [MainThread]: [31mFailure in model stg_raw_film_category (models\stg_raw\stg_raw_film_category.sql)[0m
[0m12:29:50.497526 [error] [MainThread]:   Database Error in model stg_raw_film_category (models\stg_raw\stg_raw_film_category.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."film_category" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_film_category.sql
[0m12:29:50.499535 [info ] [MainThread]: 
[0m12:29:50.499535 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_film_category.sql
[0m12:29:50.500539 [info ] [MainThread]: 
[0m12:29:50.501528 [error] [MainThread]: [31mFailure in model stg_raw_inventory (models\stg_raw\stg_raw_inventory.sql)[0m
[0m12:29:50.502183 [error] [MainThread]:   Database Error in model stg_raw_inventory (models\stg_raw\stg_raw_inventory.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."inventory" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_inventory.sql
[0m12:29:50.502183 [info ] [MainThread]: 
[0m12:29:50.503219 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_inventory.sql
[0m12:29:50.504187 [info ] [MainThread]: 
[0m12:29:50.504187 [error] [MainThread]: [31mFailure in model stg_raw_language (models\stg_raw\stg_raw_language.sql)[0m
[0m12:29:50.505190 [error] [MainThread]:   Database Error in model stg_raw_language (models\stg_raw\stg_raw_language.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."language" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_language.sql
[0m12:29:50.506188 [info ] [MainThread]: 
[0m12:29:50.506188 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_language.sql
[0m12:29:50.507190 [info ] [MainThread]: 
[0m12:29:50.507190 [error] [MainThread]: [31mFailure in model stg_raw_payment (models\stg_raw\stg_raw_payment.sql)[0m
[0m12:29:50.508188 [error] [MainThread]:   Database Error in model stg_raw_payment (models\stg_raw\stg_raw_payment.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."payment" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_payment.sql
[0m12:29:50.508188 [info ] [MainThread]: 
[0m12:29:50.509187 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_payment.sql
[0m12:29:50.509187 [info ] [MainThread]: 
[0m12:29:50.510188 [error] [MainThread]: [31mFailure in model stg_raw_rental (models\stg_raw\stg_raw_rental.sql)[0m
[0m12:29:50.511240 [error] [MainThread]:   Database Error in model stg_raw_rental (models\stg_raw\stg_raw_rental.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."rental" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_rental.sql
[0m12:29:50.512426 [info ] [MainThread]: 
[0m12:29:50.514430 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_rental.sql
[0m12:29:50.514430 [info ] [MainThread]: 
[0m12:29:50.516432 [error] [MainThread]: [31mFailure in model stg_raw_staff (models\stg_raw\stg_raw_staff.sql)[0m
[0m12:29:50.517432 [error] [MainThread]:   Database Error in model stg_raw_staff (models\stg_raw\stg_raw_staff.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."staff" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_staff.sql
[0m12:29:50.517432 [info ] [MainThread]: 
[0m12:29:50.518436 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_staff.sql
[0m12:29:50.519427 [info ] [MainThread]: 
[0m12:29:50.520225 [error] [MainThread]: [31mFailure in model stg_raw_store (models\stg_raw\stg_raw_store.sql)[0m
[0m12:29:50.521233 [error] [MainThread]:   Database Error in model stg_raw_store (models\stg_raw\stg_raw_store.sql)
  FEHLER:  fehlender Eintrag in FROM-Klausel fÃ¼r Tabelle Â»publicÂ«
  LINE 9:     "sakila_db"."public"."store" as rsrc
              ^
  compiled code at target\run\datavault_postgres_test\models\stg_raw\stg_raw_store.sql
[0m12:29:50.521233 [info ] [MainThread]: 
[0m12:29:50.522230 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_raw\stg_raw_store.sql
[0m12:29:50.523232 [info ] [MainThread]: 
[0m12:29:50.523232 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=15 SKIP=0 NO-OP=0 TOTAL=15
[0m12:29:50.524292 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:29:50.525302 [debug] [MainThread]: Command `dbt build` failed at 12:29:50.525302 after 3.35 seconds
[0m12:29:50.525302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0B4DC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A08FA7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A0B509D00>]}
[0m12:29:50.525302 [debug] [MainThread]: Flushing usage events
[0m12:29:52.213417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:29.284916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023692137DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023692134230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023692136660>]}


============================== 12:34:29.289800 | bace94b8-9847-4724-99ae-4f7416e7303c ==============================
[0m12:34:29.289800 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:34:29.290797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m .\\models\\stg_raw\\*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:29.291798 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m12:34:29.291798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023692137320>]}
[0m12:34:29.526972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236936E3AD0>]}
[0m12:34:29.595024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023692683080>]}
[0m12:34:29.596031 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:34:29.850517 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:34:30.116239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 15 files changed.
[0m12:34:30.117240 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_address.sql
[0m12:34:30.117240 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_film.sql
[0m12:34:30.118242 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_country.sql
[0m12:34:30.118242 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_film_category.sql
[0m12:34:30.119239 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_rental.sql
[0m12:34:31.549777 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_store.sql
[0m12:34:31.549777 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_inventory.sql
[0m12:34:31.550825 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_customer.sql
[0m12:34:31.550825 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_staff.sql
[0m12:34:31.551822 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_category.sql
[0m12:34:31.551822 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_actor.sql
[0m12:34:31.551822 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_payment.sql
[0m12:34:31.552820 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_city.sql
[0m12:34:31.552820 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_language.sql
[0m12:34:31.553823 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_raw\stg_raw_film_actor.sql
[0m12:34:31.864209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023693C013D0>]}
[0m12:34:31.951445 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:34:31.967030 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:34:32.719550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236936E2FF0>]}
[0m12:34:32.719550 [info ] [MainThread]: Found 17 models, 4 data tests, 15 sources, 433 macros
[0m12:34:32.781205 [info ] [MainThread]: 
[0m12:34:32.782167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:32.783171 [info ] [MainThread]: 
[0m12:34:32.784207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:34:32.788205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m12:34:32.867188 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m12:34:32.867188 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m12:34:32.868189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:32.917095 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m12:34:32.919094 [debug] [ThreadPool]: On list_sakila_db: Close
[0m12:34:32.921122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m12:34:32.927926 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:34:32.928701 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m12:34:32.928701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:32.971179 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m12:34:32.971179 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m12:34:32.972176 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:34:32.981008 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.008 seconds
[0m12:34:32.983009 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m12:34:32.983009 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m12:34:32.996545 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:32.996545 [debug] [MainThread]: On master: BEGIN
[0m12:34:32.997135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:33.037797 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:34:33.038797 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:33.038797 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:34:33.047693 [debug] [MainThread]: SQL status: SELECT 57 in 0.008 seconds
[0m12:34:33.060541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023693DA3D10>]}
[0m12:34:33.060541 [debug] [MainThread]: On master: ROLLBACK
[0m12:34:33.061711 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:33.061711 [debug] [MainThread]: On master: BEGIN
[0m12:34:33.062717 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:34:33.062717 [debug] [MainThread]: On master: COMMIT
[0m12:34:33.062717 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:33.063717 [debug] [MainThread]: On master: COMMIT
[0m12:34:33.063717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:34:33.064753 [debug] [MainThread]: On master: Close
[0m12:34:33.068717 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_actor
[0m12:34:33.068717 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_raw_actor .............................. [RUN]
[0m12:34:33.069757 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_raw_actor'
[0m12:34:33.070754 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_actor
[0m12:34:33.079715 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.080769 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_actor
[0m12:34:33.124766 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.128285 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.129299 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: BEGIN
[0m12:34:33.129299 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:34:33.192825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m12:34:33.194180 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.194694 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */

  create view "sakila_db"."public"."stg_raw_actor__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.actor' as rsrc
from "sakila_db"."public"."actor"
  );
[0m12:34:33.201829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:34:33.212199 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.212199 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
alter table "sakila_db"."public"."stg_raw_actor" rename to "stg_raw_actor__dbt_backup"
[0m12:34:33.213240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.217242 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.217242 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
alter table "sakila_db"."public"."stg_raw_actor__dbt_tmp" rename to "stg_raw_actor"
[0m12:34:33.218222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.233879 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: COMMIT
[0m12:34:33.233879 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.234894 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: COMMIT
[0m12:34:33.236742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:33.251169 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_actor__dbt_backup"
[0m12:34:33.259197 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_actor"
[0m12:34:33.260202 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_actor"} */
drop view if exists "sakila_db"."public"."stg_raw_actor__dbt_backup" cascade
[0m12:34:33.263056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:34:33.266093 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_actor: Close
[0m12:34:33.268092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002368F706E40>]}
[0m12:34:33.269058 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_raw_actor ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:34:33.270056 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_actor
[0m12:34:33.271057 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_address
[0m12:34:33.271057 [info ] [Thread-1 (]: 2 of 15 START sql view model public.stg_raw_address ............................ [RUN]
[0m12:34:33.272058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_actor, now model.datavault_postgres_test.stg_raw_address)
[0m12:34:33.272058 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_address
[0m12:34:33.275094 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.275094 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_address
[0m12:34:33.280471 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.281465 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.282426 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: BEGIN
[0m12:34:33.282426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.331115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:34:33.332091 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.332091 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */

  create view "sakila_db"."public"."stg_raw_address__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.address' as rsrc
from "sakila_db"."public"."address"
  );
[0m12:34:33.339315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:34:33.342306 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.342306 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
alter table "sakila_db"."public"."stg_raw_address" rename to "stg_raw_address__dbt_backup"
[0m12:34:33.343851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:33.346874 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.346874 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
alter table "sakila_db"."public"."stg_raw_address__dbt_tmp" rename to "stg_raw_address"
[0m12:34:33.347874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.348876 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: COMMIT
[0m12:34:33.349875 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.349875 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: COMMIT
[0m12:34:33.351872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:33.354910 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_address__dbt_backup"
[0m12:34:33.354910 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_address"
[0m12:34:33.355909 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_address"} */
drop view if exists "sakila_db"."public"."stg_raw_address__dbt_backup" cascade
[0m12:34:33.358915 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:34:33.358915 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_address: Close
[0m12:34:33.360458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369446DD30>]}
[0m12:34:33.361470 [info ] [Thread-1 (]: 2 of 15 OK created sql view model public.stg_raw_address ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:33.362482 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_address
[0m12:34:33.363494 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_category
[0m12:34:33.363494 [info ] [Thread-1 (]: 3 of 15 START sql view model public.stg_raw_category ........................... [RUN]
[0m12:34:33.364496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_address, now model.datavault_postgres_test.stg_raw_category)
[0m12:34:33.364496 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_category
[0m12:34:33.367514 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.368476 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_category
[0m12:34:33.371515 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.372514 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.373478 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: BEGIN
[0m12:34:33.374478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.420228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:33.421225 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.421225 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */

  create view "sakila_db"."public"."stg_raw_category__dbt_tmp"
    
    
  as (
    select 
    *,
    current_timestamp as ldts,
    'sakila_db.public.category' as rsrc
from "sakila_db"."public"."category"
  );
[0m12:34:33.425552 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:33.430472 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.430472 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */
alter table "sakila_db"."public"."stg_raw_category" rename to "stg_raw_category__dbt_backup"
[0m12:34:33.431471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.434471 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.435433 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */
alter table "sakila_db"."public"."stg_raw_category__dbt_tmp" rename to "stg_raw_category"
[0m12:34:33.436441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:33.439471 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: COMMIT
[0m12:34:33.439471 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.440471 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: COMMIT
[0m12:34:33.442126 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:33.444677 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_category__dbt_backup"
[0m12:34:33.445681 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_category"
[0m12:34:33.445681 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_category"} */
drop view if exists "sakila_db"."public"."stg_raw_category__dbt_backup" cascade
[0m12:34:33.447682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:33.448717 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_category: Close
[0m12:34:33.449680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236948EA180>]}
[0m12:34:33.449680 [info ] [Thread-1 (]: 3 of 15 OK created sql view model public.stg_raw_category ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:33.450718 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_category
[0m12:34:33.451694 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_city
[0m12:34:33.451694 [info ] [Thread-1 (]: 4 of 15 START sql view model public.stg_raw_city ............................... [RUN]
[0m12:34:33.452717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_category, now model.datavault_postgres_test.stg_raw_city)
[0m12:34:33.452717 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_city
[0m12:34:33.455722 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.456683 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_city
[0m12:34:33.460267 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.461274 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.461274 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: BEGIN
[0m12:34:33.462316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.507235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:33.508277 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.508277 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */

  create view "sakila_db"."public"."stg_raw_city__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.city' as rsrc
from "sakila_db"."public"."city"
  );
[0m12:34:33.515422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:34:33.519384 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.520384 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */
alter table "sakila_db"."public"."stg_raw_city" rename to "stg_raw_city__dbt_backup"
[0m12:34:33.521008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.524054 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.524054 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */
alter table "sakila_db"."public"."stg_raw_city__dbt_tmp" rename to "stg_raw_city"
[0m12:34:33.525014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.526052 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: COMMIT
[0m12:34:33.527422 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.527422 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: COMMIT
[0m12:34:33.529426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:33.532424 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_city__dbt_backup"
[0m12:34:33.532424 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_city"
[0m12:34:33.533461 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_city"} */
drop view if exists "sakila_db"."public"."stg_raw_city__dbt_backup" cascade
[0m12:34:33.535262 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:34:33.536273 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_city: Close
[0m12:34:33.537310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236943EFEC0>]}
[0m12:34:33.538271 [info ] [Thread-1 (]: 4 of 15 OK created sql view model public.stg_raw_city .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:34:33.539280 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_city
[0m12:34:33.539280 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_country
[0m12:34:33.540319 [info ] [Thread-1 (]: 5 of 15 START sql view model public.stg_raw_country ............................ [RUN]
[0m12:34:33.540319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_city, now model.datavault_postgres_test.stg_raw_country)
[0m12:34:33.541273 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_country
[0m12:34:33.543852 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.544860 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_country
[0m12:34:33.548871 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.549866 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.549866 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: BEGIN
[0m12:34:33.550872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.596449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:33.596449 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.597449 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */

  create view "sakila_db"."public"."stg_raw_country__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.country' as rsrc
from "sakila_db"."public"."country"
  );
[0m12:34:33.603451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:34:33.607486 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.607486 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */
alter table "sakila_db"."public"."stg_raw_country" rename to "stg_raw_country__dbt_backup"
[0m12:34:33.608491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.611652 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.612663 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */
alter table "sakila_db"."public"."stg_raw_country__dbt_tmp" rename to "stg_raw_country"
[0m12:34:33.613663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.614661 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: COMMIT
[0m12:34:33.615663 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.615663 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: COMMIT
[0m12:34:33.617662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:33.620658 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_country__dbt_backup"
[0m12:34:33.621658 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_country"
[0m12:34:33.622662 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_country"} */
drop view if exists "sakila_db"."public"."stg_raw_country__dbt_backup" cascade
[0m12:34:33.623660 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:33.625663 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_country: Close
[0m12:34:33.625663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236949084A0>]}
[0m12:34:33.627169 [info ] [Thread-1 (]: 5 of 15 OK created sql view model public.stg_raw_country ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:33.628177 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_country
[0m12:34:33.629183 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_customer
[0m12:34:33.629183 [info ] [Thread-1 (]: 6 of 15 START sql view model public.stg_raw_customer ........................... [RUN]
[0m12:34:33.630184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_country, now model.datavault_postgres_test.stg_raw_customer)
[0m12:34:33.630184 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_customer
[0m12:34:33.634220 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.635221 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_customer
[0m12:34:33.691453 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.692412 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.692412 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: BEGIN
[0m12:34:33.692412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.738190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:33.739189 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.739189 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_customer"} */

  create view "sakila_db"."public"."stg_raw_customer__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.customer' as rsrc
from "sakila_db"."public"."customer"
  );
[0m12:34:33.744863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:33.747868 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.747868 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_customer"} */
alter table "sakila_db"."public"."stg_raw_customer__dbt_tmp" rename to "stg_raw_customer"
[0m12:34:33.748869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.749906 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: COMMIT
[0m12:34:33.750907 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.750907 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: COMMIT
[0m12:34:33.752912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:33.754908 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_customer__dbt_backup"
[0m12:34:33.755906 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_customer"
[0m12:34:33.755906 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_customer"} */
drop view if exists "sakila_db"."public"."stg_raw_customer__dbt_backup" cascade
[0m12:34:33.756868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:34:33.757908 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_customer: Close
[0m12:34:33.758906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369492E6F0>]}
[0m12:34:33.758906 [info ] [Thread-1 (]: 6 of 15 OK created sql view model public.stg_raw_customer ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:34:33.760416 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_customer
[0m12:34:33.761203 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film
[0m12:34:33.761203 [info ] [Thread-1 (]: 7 of 15 START sql view model public.stg_raw_film ............................... [RUN]
[0m12:34:33.762369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_customer, now model.datavault_postgres_test.stg_raw_film)
[0m12:34:33.762369 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film
[0m12:34:33.765408 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.765408 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film
[0m12:34:33.769406 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.770407 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.770407 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: BEGIN
[0m12:34:33.771407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.817355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:33.817355 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.818355 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */

  create view "sakila_db"."public"."stg_raw_film__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.film' as rsrc
from "sakila_db"."public"."film"
  );
[0m12:34:33.823130 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:33.827474 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.828235 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */
alter table "sakila_db"."public"."stg_raw_film" rename to "stg_raw_film__dbt_backup"
[0m12:34:33.830324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:33.833360 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.833360 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */
alter table "sakila_db"."public"."stg_raw_film__dbt_tmp" rename to "stg_raw_film"
[0m12:34:33.834326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.836365 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: COMMIT
[0m12:34:33.836365 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.837361 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: COMMIT
[0m12:34:33.838326 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:33.841359 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_film__dbt_backup"
[0m12:34:33.842360 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film"
[0m12:34:33.842360 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film"} */
drop view if exists "sakila_db"."public"."stg_raw_film__dbt_backup" cascade
[0m12:34:33.844885 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:34:33.846072 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film: Close
[0m12:34:33.847069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023693A87380>]}
[0m12:34:33.848071 [info ] [Thread-1 (]: 7 of 15 OK created sql view model public.stg_raw_film .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:33.849071 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film
[0m12:34:33.849071 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film_actor
[0m12:34:33.850071 [info ] [Thread-1 (]: 8 of 15 START sql view model public.stg_raw_film_actor ......................... [RUN]
[0m12:34:33.851073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film, now model.datavault_postgres_test.stg_raw_film_actor)
[0m12:34:33.851073 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film_actor
[0m12:34:33.854070 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.855106 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film_actor
[0m12:34:33.859109 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.861449 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.861449 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: BEGIN
[0m12:34:33.861449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.908522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:33.908522 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.909560 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */

  create view "sakila_db"."public"."stg_raw_film_actor__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.film_actor' as rsrc
from "sakila_db"."public"."film_actor"
  );
[0m12:34:33.914850 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:33.918888 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.918888 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */
alter table "sakila_db"."public"."stg_raw_film_actor" rename to "stg_raw_film_actor__dbt_backup"
[0m12:34:33.921850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.923887 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.924888 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */
alter table "sakila_db"."public"."stg_raw_film_actor__dbt_tmp" rename to "stg_raw_film_actor"
[0m12:34:33.925849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:33.928161 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: COMMIT
[0m12:34:33.928161 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.928161 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: COMMIT
[0m12:34:33.930493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:33.932557 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_film_actor__dbt_backup"
[0m12:34:33.933556 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_actor"
[0m12:34:33.933556 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_actor"} */
drop view if exists "sakila_db"."public"."stg_raw_film_actor__dbt_backup" cascade
[0m12:34:33.935519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:33.936556 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_actor: Close
[0m12:34:33.937556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369452F770>]}
[0m12:34:33.938557 [info ] [Thread-1 (]: 8 of 15 OK created sql view model public.stg_raw_film_actor .................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:33.938557 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film_actor
[0m12:34:33.939521 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_film_category
[0m12:34:33.939521 [info ] [Thread-1 (]: 9 of 15 START sql view model public.stg_raw_film_category ...................... [RUN]
[0m12:34:33.940561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film_actor, now model.datavault_postgres_test.stg_raw_film_category)
[0m12:34:33.940561 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_film_category
[0m12:34:33.943557 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:33.944790 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_film_category
[0m12:34:33.947835 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:33.948833 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:33.948833 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: BEGIN
[0m12:34:33.949834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:33.998826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:34:33.998826 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:33.999831 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */

  create view "sakila_db"."public"."stg_raw_film_category__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.film_category' as rsrc
from "sakila_db"."public"."film_category"
  );
[0m12:34:34.006284 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:34:34.010323 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:34.010323 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */
alter table "sakila_db"."public"."stg_raw_film_category" rename to "stg_raw_film_category__dbt_backup"
[0m12:34:34.011419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.014461 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:34.014461 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */
alter table "sakila_db"."public"."stg_raw_film_category__dbt_tmp" rename to "stg_raw_film_category"
[0m12:34:34.016425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.017430 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: COMMIT
[0m12:34:34.018431 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:34.018431 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: COMMIT
[0m12:34:34.020437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:34.022473 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_film_category__dbt_backup"
[0m12:34:34.023474 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_film_category"
[0m12:34:34.024476 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_film_category"} */
drop view if exists "sakila_db"."public"."stg_raw_film_category__dbt_backup" cascade
[0m12:34:34.025473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:34.027014 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_film_category: Close
[0m12:34:34.028035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023694406BD0>]}
[0m12:34:34.030041 [info ] [Thread-1 (]: 9 of 15 OK created sql view model public.stg_raw_film_category ................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:34.031058 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_film_category
[0m12:34:34.031058 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_inventory
[0m12:34:34.032041 [info ] [Thread-1 (]: 10 of 15 START sql view model public.stg_raw_inventory ......................... [RUN]
[0m12:34:34.033044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_film_category, now model.datavault_postgres_test.stg_raw_inventory)
[0m12:34:34.033044 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_inventory
[0m12:34:34.036077 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.036077 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_inventory
[0m12:34:34.040077 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.041078 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.041078 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: BEGIN
[0m12:34:34.041078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:34.196415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m12:34:34.197453 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.197453 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */

  create view "sakila_db"."public"."stg_raw_inventory__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.inventory' as rsrc
from "sakila_db"."public"."inventory"
  );
[0m12:34:34.203080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:34.206108 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.206108 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */
alter table "sakila_db"."public"."stg_raw_inventory" rename to "stg_raw_inventory__dbt_backup"
[0m12:34:34.207109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.210109 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.210461 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */
alter table "sakila_db"."public"."stg_raw_inventory__dbt_tmp" rename to "stg_raw_inventory"
[0m12:34:34.210772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.212037 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: COMMIT
[0m12:34:34.213080 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.213080 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: COMMIT
[0m12:34:34.215083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:34.218081 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_inventory__dbt_backup"
[0m12:34:34.219080 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_inventory"
[0m12:34:34.220080 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_inventory"} */
drop view if exists "sakila_db"."public"."stg_raw_inventory__dbt_backup" cascade
[0m12:34:34.221739 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:34:34.222789 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_inventory: Close
[0m12:34:34.223786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023694915C40>]}
[0m12:34:34.224745 [info ] [Thread-1 (]: 10 of 15 OK created sql view model public.stg_raw_inventory .................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:34:34.225769 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_inventory
[0m12:34:34.225769 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_language
[0m12:34:34.227261 [info ] [Thread-1 (]: 11 of 15 START sql view model public.stg_raw_language .......................... [RUN]
[0m12:34:34.227821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_inventory, now model.datavault_postgres_test.stg_raw_language)
[0m12:34:34.227821 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_language
[0m12:34:34.231001 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.231001 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_language
[0m12:34:34.235001 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.235965 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.235965 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: BEGIN
[0m12:34:34.236965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:34.284851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:34:34.285889 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.285889 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */

  create view "sakila_db"."public"."stg_raw_language__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.language' as rsrc
from "sakila_db"."public"."language"
  );
[0m12:34:34.291825 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:34.296318 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.296318 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */
alter table "sakila_db"."public"."stg_raw_language" rename to "stg_raw_language__dbt_backup"
[0m12:34:34.297280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:34.301322 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.301322 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */
alter table "sakila_db"."public"."stg_raw_language__dbt_tmp" rename to "stg_raw_language"
[0m12:34:34.302280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.304318 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: COMMIT
[0m12:34:34.304318 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.304318 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: COMMIT
[0m12:34:34.307279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:34.309317 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_language__dbt_backup"
[0m12:34:34.310323 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_language"
[0m12:34:34.310323 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_language"} */
drop view if exists "sakila_db"."public"."stg_raw_language__dbt_backup" cascade
[0m12:34:34.312838 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:34:34.313890 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_language: Close
[0m12:34:34.314883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023693BF27E0>]}
[0m12:34:34.315845 [info ] [Thread-1 (]: 11 of 15 OK created sql view model public.stg_raw_language ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:34.316846 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_language
[0m12:34:34.316846 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_payment
[0m12:34:34.317846 [info ] [Thread-1 (]: 12 of 15 START sql view model public.stg_raw_payment ........................... [RUN]
[0m12:34:34.317846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_language, now model.datavault_postgres_test.stg_raw_payment)
[0m12:34:34.318846 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_payment
[0m12:34:34.320884 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.321882 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_payment
[0m12:34:34.325886 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.326846 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.326846 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: BEGIN
[0m12:34:34.326846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:34.375479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m12:34:34.375479 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.375479 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */

  create view "sakila_db"."public"."stg_raw_payment__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.payment' as rsrc
from "sakila_db"."public"."payment"
  );
[0m12:34:34.382523 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:34:34.386521 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.387483 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */
alter table "sakila_db"."public"."stg_raw_payment" rename to "stg_raw_payment__dbt_backup"
[0m12:34:34.388521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:34.390518 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.391518 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */
alter table "sakila_db"."public"."stg_raw_payment__dbt_tmp" rename to "stg_raw_payment"
[0m12:34:34.391518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.393518 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: COMMIT
[0m12:34:34.394670 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.394670 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: COMMIT
[0m12:34:34.396679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:34.398682 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_payment__dbt_backup"
[0m12:34:34.399681 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_payment"
[0m12:34:34.399681 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_payment"} */
drop view if exists "sakila_db"."public"."stg_raw_payment__dbt_backup" cascade
[0m12:34:34.401960 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:34.402967 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_payment: Close
[0m12:34:34.403969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002369377DDF0>]}
[0m12:34:34.404967 [info ] [Thread-1 (]: 12 of 15 OK created sql view model public.stg_raw_payment ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:34.406004 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_payment
[0m12:34:34.406004 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_rental
[0m12:34:34.407022 [info ] [Thread-1 (]: 13 of 15 START sql view model public.stg_raw_rental ............................ [RUN]
[0m12:34:34.407022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_payment, now model.datavault_postgres_test.stg_raw_rental)
[0m12:34:34.408002 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_rental
[0m12:34:34.412518 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.413556 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_rental
[0m12:34:34.417555 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.418522 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.418522 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: BEGIN
[0m12:34:34.418522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:34.465247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:34:34.466235 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.466235 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */

  create view "sakila_db"."public"."stg_raw_rental__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.rental' as rsrc
from "sakila_db"."public"."rental"
  );
[0m12:34:34.472343 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:34.475389 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.475389 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */
alter table "sakila_db"."public"."stg_raw_rental" rename to "stg_raw_rental__dbt_backup"
[0m12:34:34.477258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:34.480398 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.480398 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */
alter table "sakila_db"."public"."stg_raw_rental__dbt_tmp" rename to "stg_raw_rental"
[0m12:34:34.481397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.483363 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: COMMIT
[0m12:34:34.483363 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.484402 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: COMMIT
[0m12:34:34.486361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:34.488363 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_rental__dbt_backup"
[0m12:34:34.489398 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_rental"
[0m12:34:34.489398 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_rental"} */
drop view if exists "sakila_db"."public"."stg_raw_rental__dbt_backup" cascade
[0m12:34:34.491362 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:34.492399 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_rental: Close
[0m12:34:34.492399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023693BD0080>]}
[0m12:34:34.494207 [info ] [Thread-1 (]: 13 of 15 OK created sql view model public.stg_raw_rental ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:34.495243 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_rental
[0m12:34:34.496249 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_staff
[0m12:34:34.497267 [info ] [Thread-1 (]: 14 of 15 START sql view model public.stg_raw_staff ............................. [RUN]
[0m12:34:34.497267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_rental, now model.datavault_postgres_test.stg_raw_staff)
[0m12:34:34.498251 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_staff
[0m12:34:34.501249 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.502285 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_staff
[0m12:34:34.506284 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.507284 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.508264 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: BEGIN
[0m12:34:34.508264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:34.553215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:34:34.554254 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.555215 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */

  create view "sakila_db"."public"."stg_raw_staff__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.staff' as rsrc
from "sakila_db"."public"."staff"
  );
[0m12:34:34.560982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:34.564234 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.564234 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */
alter table "sakila_db"."public"."stg_raw_staff" rename to "stg_raw_staff__dbt_backup"
[0m12:34:34.565201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:34.568236 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.568236 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */
alter table "sakila_db"."public"."stg_raw_staff__dbt_tmp" rename to "stg_raw_staff"
[0m12:34:34.569234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.571234 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: COMMIT
[0m12:34:34.571234 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.572240 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: COMMIT
[0m12:34:34.573840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:34.575884 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_staff__dbt_backup"
[0m12:34:34.576884 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_staff"
[0m12:34:34.577745 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_staff"} */
drop view if exists "sakila_db"."public"."stg_raw_staff__dbt_backup" cascade
[0m12:34:34.579802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:34.580847 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_staff: Close
[0m12:34:34.581846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236926576B0>]}
[0m12:34:34.581846 [info ] [Thread-1 (]: 14 of 15 OK created sql view model public.stg_raw_staff ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m12:34:34.582846 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_staff
[0m12:34:34.583813 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_raw_store
[0m12:34:34.583813 [info ] [Thread-1 (]: 15 of 15 START sql view model public.stg_raw_store ............................. [RUN]
[0m12:34:34.584809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_raw_staff, now model.datavault_postgres_test.stg_raw_store)
[0m12:34:34.584809 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_raw_store
[0m12:34:34.587846 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.588809 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_raw_store
[0m12:34:34.593864 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.595054 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.596063 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: BEGIN
[0m12:34:34.596063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:34.640806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:34:34.640806 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.640806 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */

  create view "sakila_db"."public"."stg_raw_store__dbt_tmp"
    
    
  as (
    select *,
    current_timestamp as ldts,
    'sakila_db.public.store' as rsrc
from "sakila_db"."public"."store"
  );
[0m12:34:34.647116 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:34:34.650115 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.651079 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */
alter table "sakila_db"."public"."stg_raw_store" rename to "stg_raw_store__dbt_backup"
[0m12:34:34.652114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:34.656079 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.657078 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */
alter table "sakila_db"."public"."stg_raw_store__dbt_tmp" rename to "stg_raw_store"
[0m12:34:34.658077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:34.659077 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: COMMIT
[0m12:34:34.659077 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.661035 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: COMMIT
[0m12:34:34.662910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:34:34.664918 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_raw_store__dbt_backup"
[0m12:34:34.665953 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_raw_store"
[0m12:34:34.665953 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_raw_store"} */
drop view if exists "sakila_db"."public"."stg_raw_store__dbt_backup" cascade
[0m12:34:34.667919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:34:34.668954 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_raw_store: Close
[0m12:34:34.669952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bace94b8-9847-4724-99ae-4f7416e7303c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236948D77A0>]}
[0m12:34:34.670917 [info ] [Thread-1 (]: 15 of 15 OK created sql view model public.stg_raw_store ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m12:34:34.670917 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_raw_store
[0m12:34:34.672932 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:34.672932 [debug] [MainThread]: On master: BEGIN
[0m12:34:34.673916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:34.718059 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m12:34:34.719060 [debug] [MainThread]: On master: COMMIT
[0m12:34:34.719060 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:34.720072 [debug] [MainThread]: On master: COMMIT
[0m12:34:34.720072 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:34:34.721068 [debug] [MainThread]: On master: Close
[0m12:34:34.721068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:34.721068 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m12:34:34.722085 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m12:34:34.722085 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_raw_store' was properly closed.
[0m12:34:34.723067 [info ] [MainThread]: 
[0m12:34:34.723067 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m12:34:34.726065 [debug] [MainThread]: Command end result
[0m12:34:34.756282 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m12:34:34.758277 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m12:34:34.766415 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m12:34:34.766415 [info ] [MainThread]: 
[0m12:34:34.767437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:34.768419 [info ] [MainThread]: 
[0m12:34:34.769248 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m12:34:34.770270 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:34:34.771255 [debug] [MainThread]: Command `dbt build` succeeded at 12:34:34.771255 after 5.78 seconds
[0m12:34:34.771255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023691ED2AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023691AFB200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023691AFB1D0>]}
[0m12:34:34.772256 [debug] [MainThread]: Flushing usage events
[0m12:34:36.415926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:55.672436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201599930B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020159D1D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015BDB06E0>]}


============================== 15:52:55.676950 | 4486b741-7512-478d-a1de-075fac802e5c ==============================
[0m15:52:55.676950 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:52:55.677322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\*', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:55.677322 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:52:55.677322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015C2FFFE0>]}
[0m15:52:55.893738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020159AA8290>]}
[0m15:52:55.960164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015C932720>]}
[0m15:52:55.960164 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:56.211078 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:52:56.377142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:52:56.377142 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_dv\stg_dv_actor.sql
[0m15:52:56.687066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015C8CABD0>]}
[0m15:52:56.801181 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m15:52:56.818842 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m15:52:56.880395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DD55E80>]}
[0m15:52:56.880969 [info ] [MainThread]: Found 18 models, 4 data tests, 15 sources, 433 macros
[0m15:52:56.887085 [info ] [MainThread]: 
[0m15:52:56.887085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:56.887085 [info ] [MainThread]: 
[0m15:52:56.891585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:52:56.893232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m15:52:56.983497 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m15:52:56.983497 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m15:52:56.984459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:57.143585 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.166 seconds
[0m15:52:57.143585 [debug] [ThreadPool]: On list_sakila_db: Close
[0m15:52:57.156631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m15:52:57.160402 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m15:52:57.160402 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m15:52:57.160402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:57.201587 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m15:52:57.201587 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m15:52:57.201587 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:52:57.210103 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.006 seconds
[0m15:52:57.210103 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m15:52:57.210103 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m15:52:57.226871 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.226871 [debug] [MainThread]: On master: BEGIN
[0m15:52:57.226871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:57.268590 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m15:52:57.268590 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.269591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:57.277495 [debug] [MainThread]: SQL status: SELECT 58 in 0.008 seconds
[0m15:52:57.290163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015E4B8110>]}
[0m15:52:57.290163 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:57.290163 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.290163 [debug] [MainThread]: On master: BEGIN
[0m15:52:57.290163 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:52:57.290163 [debug] [MainThread]: On master: COMMIT
[0m15:52:57.293139 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.293644 [debug] [MainThread]: On master: COMMIT
[0m15:52:57.293644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:57.293644 [debug] [MainThread]: On master: Close
[0m15:52:57.299269 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m15:52:57.299269 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m15:52:57.299269 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m15:52:57.299269 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m15:52:57.299269 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m15:52:57.309222 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m15:52:57.328857 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m15:52:57.343826 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:52:57.345103 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m15:52:57.345493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:57.388986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m15:52:57.388986 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:52:57.388986 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(actor_id as TEXT))))) as hk_actor_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(first_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_actor_s
    from "sakila_db"."public"."stg_raw_actor"
),

ghost_records as (
    select 
        0 as actor_id,
        '(unknown)' as first_name,
        '(unknown)' as last_name,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc
    union all
    select
        -1 as actor_id,
        '(error)' as first_name,
        '(error)' as last_name,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m15:52:57.390949 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
LINE 46:     select * from ghost_records
                    ^

[0m15:52:57.390949 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: ROLLBACK
[0m15:52:57.391950 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m15:52:57.394475 [debug] [Thread-1 (]: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
  LINE 46:     select * from ghost_records
                      ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m15:52:57.394475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4486b741-7512-478d-a1de-075fac802e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DFB9520>]}
[0m15:52:57.394475 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_actor ....................... [[31mERROR[0m in 0.10s]
[0m15:52:57.394475 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m15:52:57.394475 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
  LINE 46:     select * from ghost_records
                      ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql.
[0m15:52:57.394475 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.394475 [debug] [MainThread]: On master: BEGIN
[0m15:52:57.394475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:57.447208 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m15:52:57.447208 [debug] [MainThread]: On master: COMMIT
[0m15:52:57.447208 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.448244 [debug] [MainThread]: On master: COMMIT
[0m15:52:57.448244 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:57.449209 [debug] [MainThread]: On master: Close
[0m15:52:57.449209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:57.450207 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m15:52:57.450207 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m15:52:57.450207 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m15:52:57.451207 [info ] [MainThread]: 
[0m15:52:57.452209 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m15:52:57.453207 [debug] [MainThread]: Command end result
[0m15:52:57.479161 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m15:52:57.481211 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m15:52:57.484204 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m15:52:57.484204 [info ] [MainThread]: 
[0m15:52:57.484204 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:52:57.484204 [info ] [MainThread]: 
[0m15:52:57.484204 [error] [MainThread]: [31mFailure in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)[0m
[0m15:52:57.484204 [error] [MainThread]:   Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
  LINE 46:     select * from ghost_records
                      ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m15:52:57.484204 [info ] [MainThread]: 
[0m15:52:57.484204 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m15:52:57.484204 [info ] [MainThread]: 
[0m15:52:57.493601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:52:57.494887 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:52:57.497147 [debug] [MainThread]: Command `dbt build` failed at 15:52:57.496201 after 2.02 seconds
[0m15:52:57.497147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201599930B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015C06E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020159093C50>]}
[0m15:52:57.498156 [debug] [MainThread]: Flushing usage events
[0m15:52:58.512896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:17.480304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B576E01EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B576F2F4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5744A78C0>]}


============================== 15:56:17.480304 | d4f85446-1e33-48cf-876f-296d7545798d ==============================
[0m15:56:17.480304 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:56:17.480304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:56:17.480304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:56:17.480304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B576F2F4A0>]}
[0m15:56:17.728564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5746DC080>]}
[0m15:56:17.793838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5770D6ED0>]}
[0m15:56:17.793838 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:56:18.043839 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:56:18.212956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:18.212956 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_actor.sql
[0m15:56:18.481790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B578BC2030>]}
[0m15:56:18.560210 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m15:56:18.576845 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m15:56:18.612145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B578DBAA50>]}
[0m15:56:18.612145 [info ] [MainThread]: Found 18 models, 4 data tests, 15 sources, 433 macros
[0m15:56:18.627186 [info ] [MainThread]: 
[0m15:56:18.627186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:18.627186 [info ] [MainThread]: 
[0m15:56:18.628780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:18.629823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m15:56:18.706972 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m15:56:18.706972 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m15:56:18.706972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:18.744743 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m15:56:18.744743 [debug] [ThreadPool]: On list_sakila_db: Close
[0m15:56:18.758955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m15:56:18.766698 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m15:56:18.766698 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m15:56:18.767700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:18.793515 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m15:56:18.808407 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m15:56:18.808407 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:56:18.810415 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.008 seconds
[0m15:56:18.810415 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m15:56:18.810415 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m15:56:18.833372 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:18.833372 [debug] [MainThread]: On master: BEGIN
[0m15:56:18.833372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:18.871601 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m15:56:18.871601 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:18.871601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:18.885000 [debug] [MainThread]: SQL status: SELECT 58 in 0.009 seconds
[0m15:56:18.893685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B578B97AD0>]}
[0m15:56:18.893685 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:18.893685 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:18.893685 [debug] [MainThread]: On master: BEGIN
[0m15:56:18.893685 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:56:18.893685 [debug] [MainThread]: On master: COMMIT
[0m15:56:18.893685 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:18.893685 [debug] [MainThread]: On master: COMMIT
[0m15:56:18.893685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:18.893685 [debug] [MainThread]: On master: Close
[0m15:56:18.905398 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m15:56:18.905398 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m15:56:18.905398 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m15:56:18.905398 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m15:56:18.910399 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:18.910399 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m15:56:18.950146 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:18.951150 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:18.952115 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m15:56:18.952115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:18.993802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m15:56:18.993802 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:18.993802 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(actor_id as TEXT))))) as hk_actor_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(first_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_actor_s
    from "sakila_db"."public"."stg_raw_actor"
),

ghost_records as (
    select 
        0 as actor_id,
        '(unknown)' as first_name,
        '(unknown)' as last_name,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_actor_h,
        '00000000000000000000000000000000' as hd_acrot_s
    union all
    select
        -1 as actor_id,
        '(error)' as first_name,
        '(error)' as last_name,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        'ffffffffffffffffffffffffffffffff' as hd_actor_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m15:56:18.993802 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:56:18.993802 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:19.008521 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor__dbt_tmp" rename to "stg_dv_actor"
[0m15:56:19.008521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:19.010541 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m15:56:19.024379 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:19.024379 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m15:56:19.027027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:56:19.027027 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_actor__dbt_backup"
[0m15:56:19.027027 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:56:19.027027 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
drop view if exists "sakila_db"."public"."stg_dv_actor__dbt_backup" cascade
[0m15:56:19.027027 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:56:19.040487 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m15:56:19.043644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f85446-1e33-48cf-876f-296d7545798d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5746A7140>]}
[0m15:56:19.043644 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_actor ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:56:19.043644 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m15:56:19.043644 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:19.048106 [debug] [MainThread]: On master: BEGIN
[0m15:56:19.048106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:19.089449 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m15:56:19.090450 [debug] [MainThread]: On master: COMMIT
[0m15:56:19.090450 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:19.090450 [debug] [MainThread]: On master: COMMIT
[0m15:56:19.091449 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:19.091449 [debug] [MainThread]: On master: Close
[0m15:56:19.092449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:19.092449 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m15:56:19.093412 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m15:56:19.093412 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m15:56:19.093412 [info ] [MainThread]: 
[0m15:56:19.094737 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m15:56:19.096009 [debug] [MainThread]: Command end result
[0m15:56:19.114119 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m15:56:19.114119 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m15:56:19.127207 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m15:56:19.127207 [info ] [MainThread]: 
[0m15:56:19.129066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:19.129691 [info ] [MainThread]: 
[0m15:56:19.130750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:56:19.131701 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:56:19.132698 [debug] [MainThread]: Command `dbt build` succeeded at 15:56:19.132698 after 1.86 seconds
[0m15:56:19.133734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5751D1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5775629C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5770A7650>]}
[0m15:56:19.134712 [debug] [MainThread]: Flushing usage events
[0m15:56:20.213058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:30.843703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028527BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020282EE75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020282443230>]}


============================== 15:57:30.843703 | 522fcd12-eb6a-4936-82b1-5ab034732efa ==============================
[0m15:57:30.843703 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:57:30.843703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\*', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:30.843703 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:57:30.843703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202828F4800>]}
[0m15:57:31.043845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202865338F0>]}
[0m15:57:31.110329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020284D9F6E0>]}
[0m15:57:31.110329 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:57:31.377284 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:57:31.543434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:31.543434 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_actor.sql
[0m15:57:31.810100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020286B2D4F0>]}
[0m15:57:31.893947 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m15:57:31.904597 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m15:57:31.952306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028680D730>]}
[0m15:57:31.952306 [info ] [MainThread]: Found 18 models, 4 data tests, 15 sources, 433 macros
[0m15:57:31.952306 [info ] [MainThread]: 
[0m15:57:31.952306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:31.952306 [info ] [MainThread]: 
[0m15:57:31.959893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:31.961432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m15:57:32.028554 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m15:57:32.028554 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m15:57:32.028554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:32.193902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.161 seconds
[0m15:57:32.193902 [debug] [ThreadPool]: On list_sakila_db: Close
[0m15:57:32.205618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m15:57:32.210168 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m15:57:32.210168 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m15:57:32.210168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:32.253074 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m15:57:32.253074 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m15:57:32.253074 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:57:32.260241 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.006 seconds
[0m15:57:32.260241 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m15:57:32.260241 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m15:57:32.268913 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:32.268913 [debug] [MainThread]: On master: BEGIN
[0m15:57:32.268913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:32.316150 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m15:57:32.316150 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:32.316150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:32.326954 [debug] [MainThread]: SQL status: SELECT 59 in 0.008 seconds
[0m15:57:32.331928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028722C0E0>]}
[0m15:57:32.331928 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:32.331928 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:32.331928 [debug] [MainThread]: On master: BEGIN
[0m15:57:32.331928 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:57:32.331928 [debug] [MainThread]: On master: COMMIT
[0m15:57:32.343638 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:32.343638 [debug] [MainThread]: On master: COMMIT
[0m15:57:32.343638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:32.343638 [debug] [MainThread]: On master: Close
[0m15:57:32.347570 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m15:57:32.347570 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m15:57:32.347570 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m15:57:32.347570 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m15:57:32.347570 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.347570 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m15:57:32.378047 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.394044 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.394044 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m15:57:32.395080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:32.427895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m15:57:32.427895 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.427895 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(actor_id as TEXT)),'^^'))) as hk_actor_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(first_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_actor_s
    from "sakila_db"."public"."stg_raw_actor"
),

ghost_records as (
    select 
        0 as actor_id,
        '(unknown)' as first_name,
        '(unknown)' as last_name,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_actor_h,
        '00000000000000000000000000000000' as hd_acrot_s
    union all
    select
        -1 as actor_id,
        '(error)' as first_name,
        '(error)' as last_name,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        'ffffffffffffffffffffffffffffffff' as hd_actor_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m15:57:32.449787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:57:32.455778 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.455778 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor" rename to "stg_dv_actor__dbt_backup"
[0m15:57:32.455778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:57:32.460295 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.460295 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor__dbt_tmp" rename to "stg_dv_actor"
[0m15:57:32.460295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:57:32.477193 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m15:57:32.477193 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.477193 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m15:57:32.510607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m15:57:32.526205 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_actor__dbt_backup"
[0m15:57:32.527218 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m15:57:32.527218 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
drop view if exists "sakila_db"."public"."stg_dv_actor__dbt_backup" cascade
[0m15:57:32.527218 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:57:32.527218 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m15:57:32.527218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '522fcd12-eb6a-4936-82b1-5ab034732efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020282547260>]}
[0m15:57:32.527218 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_actor ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m15:57:32.542048 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m15:57:32.543559 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:32.543559 [debug] [MainThread]: On master: BEGIN
[0m15:57:32.543559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:32.577531 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m15:57:32.577531 [debug] [MainThread]: On master: COMMIT
[0m15:57:32.577531 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:32.577531 [debug] [MainThread]: On master: COMMIT
[0m15:57:32.577531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:32.577531 [debug] [MainThread]: On master: Close
[0m15:57:32.577531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:32.577531 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m15:57:32.577531 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m15:57:32.577531 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m15:57:32.577531 [info ] [MainThread]: 
[0m15:57:32.593435 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m15:57:32.593773 [debug] [MainThread]: Command end result
[0m15:57:32.615293 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m15:57:32.615293 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m15:57:32.615293 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m15:57:32.615293 [info ] [MainThread]: 
[0m15:57:32.627496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:32.628555 [info ] [MainThread]: 
[0m15:57:32.629670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:57:32.630673 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:57:32.632664 [debug] [MainThread]: Command `dbt build` succeeded at 15:57:32.632664 after 1.93 seconds
[0m15:57:32.633661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020285077AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028509E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202851662D0>]}
[0m15:57:32.633661 [debug] [MainThread]: Flushing usage events
[0m15:57:33.673879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:40.388287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E5AA9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E92FAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E8FF7380>]}


============================== 16:06:40.392324 | 91203794-45a8-4af8-a133-a783e74b9512 ==============================
[0m16:06:40.392324 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:06:40.392324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\*', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:40.393865 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:06:40.394602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E9295430>]}
[0m16:06:40.597524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E9486180>]}
[0m16:06:40.662433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E89BAF00>]}
[0m16:06:40.664397 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:40.917268 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:06:41.100708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:06:41.100708 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_dv\stg_dv_address.sql
[0m16:06:41.101704 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_actor.sql
[0m16:06:41.381868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EAB311C0>]}
[0m16:06:41.469204 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:06:41.483765 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:06:41.530458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E92FB320>]}
[0m16:06:41.531422 [info ] [MainThread]: Found 19 models, 4 data tests, 15 sources, 433 macros
[0m16:06:41.540456 [info ] [MainThread]: 
[0m16:06:41.540882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:41.540882 [info ] [MainThread]: 
[0m16:06:41.541911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:41.546689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:06:41.624631 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:06:41.624631 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:06:41.625629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:41.671238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m16:06:41.672238 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:06:41.675225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:06:41.683379 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:06:41.683379 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:06:41.684343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:41.723337 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m16:06:41.724338 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:06:41.724338 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:06:41.732332 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.007 seconds
[0m16:06:41.733332 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:06:41.734332 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:06:41.746458 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:41.746458 [debug] [MainThread]: On master: BEGIN
[0m16:06:41.747459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:41.787132 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m16:06:41.788136 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:41.788136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:41.797844 [debug] [MainThread]: SQL status: SELECT 59 in 0.009 seconds
[0m16:06:41.810974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EAFFC9B0>]}
[0m16:06:41.810974 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:41.810974 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:41.812157 [debug] [MainThread]: On master: BEGIN
[0m16:06:41.812859 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:06:41.812859 [debug] [MainThread]: On master: COMMIT
[0m16:06:41.813909 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:41.813909 [debug] [MainThread]: On master: COMMIT
[0m16:06:41.813909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:41.814903 [debug] [MainThread]: On master: Close
[0m16:06:41.818865 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m16:06:41.819866 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_dv_actor ................................ [RUN]
[0m16:06:41.820866 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m16:06:41.820866 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m16:06:41.827384 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.828908 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m16:06:41.864611 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.865611 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.866575 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m16:06:41.866575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:06:41.908732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m16:06:41.908732 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.910238 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(actor_id as TEXT)),'^^'))) as hk_actor_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(first_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_actor_s
    from "sakila_db"."public"."stg_raw_actor"
),

ghost_records as (
    select 
        0 as actor_id,
        '(unknown)' as first_name,
        '(unknown)' as last_name,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_actor_h,
        '00000000000000000000000000000000' as hd_actor_s
    union all
    select
        -1 as actor_id,
        '(error)' as first_name,
        '(error)' as last_name,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        'ffffffffffffffffffffffffffffffff' as hd_actor_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:06:41.911272 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:06:41.911272 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.911272 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor" rename to "stg_dv_actor__dbt_backup"
[0m16:06:41.911272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:41.928174 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.928174 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor__dbt_tmp" rename to "stg_dv_actor"
[0m16:06:41.930269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:41.944610 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m16:06:41.945696 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:41.945696 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m16:06:43.779566 [debug] [Thread-1 (]: SQL status: COMMIT in 1.833 seconds
[0m16:06:43.800384 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_actor__dbt_backup"
[0m16:06:43.809380 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:06:43.809380 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
drop view if exists "sakila_db"."public"."stg_dv_actor__dbt_backup" cascade
[0m16:06:44.363489 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.553 seconds
[0m16:06:44.368493 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m16:06:44.371523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EB3A37D0>]}
[0m16:06:44.372526 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_dv_actor ........................... [[32mCREATE VIEW[0m in 2.55s]
[0m16:06:44.372916 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m16:06:44.373960 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_address
[0m16:06:44.373960 [info ] [Thread-1 (]: 2 of 2 START sql view model public.stg_dv_address .............................. [RUN]
[0m16:06:44.374811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_actor, now model.datavault_postgres_test.stg_dv_address)
[0m16:06:44.374811 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_address
[0m16:06:44.377566 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.377566 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_address
[0m16:06:44.382845 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.383813 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.383813 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: BEGIN
[0m16:06:44.383813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:44.425907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m16:06:44.425907 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.426943 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */

  create view "sakila_db"."public"."stg_dv_address__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_address"
),

column_hash as (
    select
        *,
        MD5(COALESCE(TRIM(CAST(address_id as TEXT)),'^^')) as hk_address_h,
        MD5(COALESCE(TRIM(CAST(city_id as TEXT)),'^^')) as hk_city_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(address_id as TEXT)),'^^'),'||', 
            COALESCE(TRIM(CAST(city_id as TEXT)),'^^')
        )) as hk_address_city_l,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(address as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(address2 as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(district as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(postal_code as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(phone as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_address_s
    from "sakila_db"."public"."stg_raw_address"
),

ghost_records as (
    select 
        0 as address_id,
        '(unknown)' as address,
        '(unknown)' as address2,
        '(unknown)' as district,
        0 as city_id,
        '(unknown)' as postal_code,
        '(unknown)' as phone,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_address_h,
        '00000000000000000000000000000000' as hk_city_h,
        '00000000000000000000000000000000' as hk_address_city_l,
        '00000000000000000000000000000000' as hd_address_s
    union all
    select
        -1 as address_id,
        '(error)' as address,
        '(error)' as address2,
        '(error)' as district,
        0 as city_id,
        '(error)' as postal_code,
        '(error)' as phone,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_address_h,
        'ffffffffffffffffffffffffffffffff' as hk_city_h,
        'ffffffffffffffffffffffffffffffff' as hk_address_city_l,
        'ffffffffffffffffffffffffffffffff' as hd_address_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:06:44.435309 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:06:44.438344 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.439344 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */
alter table "sakila_db"."public"."stg_dv_address__dbt_tmp" rename to "stg_dv_address"
[0m16:06:44.440308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:44.441345 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: COMMIT
[0m16:06:44.442345 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.442345 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: COMMIT
[0m16:06:44.444232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:06:44.446290 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_address__dbt_backup"
[0m16:06:44.447282 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m16:06:44.447282 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */
drop view if exists "sakila_db"."public"."stg_dv_address__dbt_backup" cascade
[0m16:06:44.448282 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:06:44.449247 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: Close
[0m16:06:44.450283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91203794-45a8-4af8-a133-a783e74b9512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EA711400>]}
[0m16:06:44.451245 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.stg_dv_address ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:06:44.452249 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_address
[0m16:06:44.454247 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:44.455282 [debug] [MainThread]: On master: BEGIN
[0m16:06:44.455282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:44.498824 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m16:06:44.498824 [debug] [MainThread]: On master: COMMIT
[0m16:06:44.499862 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:44.499862 [debug] [MainThread]: On master: COMMIT
[0m16:06:44.500824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:44.500824 [debug] [MainThread]: On master: Close
[0m16:06:44.501867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:44.502834 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:06:44.503826 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:06:44.503826 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_address' was properly closed.
[0m16:06:44.504830 [info ] [MainThread]: 
[0m16:06:44.505824 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m16:06:44.506824 [debug] [MainThread]: Command end result
[0m16:06:44.538395 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:06:44.540399 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:06:44.548246 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:06:44.549246 [info ] [MainThread]: 
[0m16:06:44.550244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:44.551251 [info ] [MainThread]: 
[0m16:06:44.552246 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:06:44.552246 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:06:44.554249 [debug] [MainThread]: Command `dbt build` succeeded at 16:06:44.554249 after 4.38 seconds
[0m16:06:44.555250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E908EED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E9437D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E9358A10>]}
[0m16:06:44.555250 [debug] [MainThread]: Flushing usage events
[0m16:06:45.588822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:49.872586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FF8B5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FF8B5AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FF8B7FE0>]}


============================== 16:10:49.876957 | 7bad109d-e8dc-432f-aa49-463e7fa10494 ==============================
[0m16:10:49.876957 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:10:49.878182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_category.sql', 'send_anonymous_usage_stats': 'True'}
[0m16:10:49.879181 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:10:49.880182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264800F7EF0>]}
[0m16:10:50.085858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FF97A840>]}
[0m16:10:50.150308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026480522990>]}
[0m16:10:50.151600 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:10:50.397630 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:10:50.567047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:10:50.568010 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_dv\stg_dv_category.sql
[0m16:10:50.839763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026481C89B20>]}
[0m16:10:50.925999 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:10:50.940961 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:10:50.987376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026481B1B740>]}
[0m16:10:50.988375 [info ] [MainThread]: Found 20 models, 4 data tests, 15 sources, 433 macros
[0m16:10:50.993843 [info ] [MainThread]: 
[0m16:10:50.994865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:50.994865 [info ] [MainThread]: 
[0m16:10:50.995865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:50.996864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:10:51.079284 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:10:51.079284 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:10:51.080320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:51.126131 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m16:10:51.127942 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:10:51.133433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:10:51.140438 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:10:51.140438 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:10:51.140438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:51.290165 [debug] [ThreadPool]: SQL status: BEGIN in 0.149 seconds
[0m16:10:51.290165 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:10:51.291131 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:51.296444 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.006 seconds
[0m16:10:51.298447 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:10:51.299445 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:10:51.312103 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.313108 [debug] [MainThread]: On master: BEGIN
[0m16:10:51.313108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:51.352267 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m16:10:51.352267 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.353263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:51.361964 [debug] [MainThread]: SQL status: SELECT 60 in 0.008 seconds
[0m16:10:51.374006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648238C050>]}
[0m16:10:51.374969 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:51.374969 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.376006 [debug] [MainThread]: On master: BEGIN
[0m16:10:51.376006 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:10:51.377008 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.377372 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.377727 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.377727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:51.377727 [debug] [MainThread]: On master: Close
[0m16:10:51.383040 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_category
[0m16:10:51.384038 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_category ............................. [RUN]
[0m16:10:51.384038 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_category'
[0m16:10:51.385037 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_category
[0m16:10:51.391038 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.392036 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_category
[0m16:10:51.427885 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.429891 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.429891 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: BEGIN
[0m16:10:51.430929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:51.575387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m16:10:51.575387 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.576898 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */

  create view "sakila_db"."public"."stg_dv_category__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_category"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(category_id as TEXT)),'^^'))) as hk_category_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(name as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_category_s
    from "sakila_db"."public"."stg_raw_category"
),

ghost_records as (
    select 
        0 as category_id,
        '(unknown)' as name,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_category_h,
        '00000000000000000000000000000000' as hd_category_s
    union all
    select
        -1 as category_id,
        '(error)' as name,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_category_h,
        'ffffffffffffffffffffffffffffffff' as hd_category_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:10:51.584803 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:10:51.590769 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.590769 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */
alter table "sakila_db"."public"."stg_dv_category__dbt_tmp" rename to "stg_dv_category"
[0m16:10:51.591803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:51.605581 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: COMMIT
[0m16:10:51.605581 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.606623 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: COMMIT
[0m16:10:51.609120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:10:51.615118 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_category__dbt_backup"
[0m16:10:51.621117 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m16:10:51.621117 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */
drop view if exists "sakila_db"."public"."stg_dv_category__dbt_backup" cascade
[0m16:10:51.622080 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:10:51.624118 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: Close
[0m16:10:51.626081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bad109d-e8dc-432f-aa49-463e7fa10494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FD5A71A0>]}
[0m16:10:51.627523 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_category ........................ [[32mCREATE VIEW[0m in 0.24s]
[0m16:10:51.627939 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_category
[0m16:10:51.629995 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.629995 [debug] [MainThread]: On master: BEGIN
[0m16:10:51.629995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:51.674141 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:10:51.675184 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.675184 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.676185 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.676185 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:51.676185 [debug] [MainThread]: On master: Close
[0m16:10:51.677915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:51.677915 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:10:51.677915 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:10:51.679002 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_category' was properly closed.
[0m16:10:51.679002 [info ] [MainThread]: 
[0m16:10:51.679964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:10:51.681962 [debug] [MainThread]: Command end result
[0m16:10:51.706590 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:10:51.710100 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:10:51.721122 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:10:51.722122 [info ] [MainThread]: 
[0m16:10:51.722122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:51.723122 [info ] [MainThread]: 
[0m16:10:51.724122 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:10:51.724122 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:10:51.725313 [debug] [MainThread]: Command `dbt build` succeeded at 16:10:51.725313 after 2.05 seconds
[0m16:10:51.726359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264804D40B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264800C9BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264800C97C0>]}
[0m16:10:51.726902 [debug] [MainThread]: Flushing usage events
[0m16:10:52.767695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:40.423459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D22F5CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D0F53E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D4386660>]}


============================== 16:14:40.429014 | 05bbb8da-4b2e-4ea7-8518-222771379ee2 ==============================
[0m16:14:40.429014 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:14:40.430108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_city.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:14:40.430108 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:14:40.430726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D45B5D00>]}
[0m16:14:40.646495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D47EC350>]}
[0m16:14:40.713078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D422ACF0>]}
[0m16:14:40.714044 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:14:40.952537 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:14:41.131393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:14:41.131393 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_dv\stg_dv_city.sql
[0m16:14:41.414218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D5E80EF0>]}
[0m16:14:41.507760 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:14:41.523405 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:14:41.570672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D6062060>]}
[0m16:14:41.570672 [info ] [MainThread]: Found 21 models, 4 data tests, 15 sources, 433 macros
[0m16:14:41.575710 [info ] [MainThread]: 
[0m16:14:41.577600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:41.578614 [info ] [MainThread]: 
[0m16:14:41.579625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:41.581625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:14:41.664332 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:14:41.665367 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:14:41.665367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:41.709341 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m16:14:41.710819 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:14:41.717587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:14:41.722623 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:14:41.722623 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:14:41.723713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:41.767046 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:14:41.767046 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:14:41.768012 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:14:41.774044 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.006 seconds
[0m16:14:41.777020 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:14:41.778028 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:14:41.778028 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:41.778028 [debug] [MainThread]: On master: BEGIN
[0m16:14:41.778028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:41.942201 [debug] [MainThread]: SQL status: BEGIN in 0.151 seconds
[0m16:14:41.942201 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:41.944105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:41.952785 [debug] [MainThread]: SQL status: SELECT 61 in 0.009 seconds
[0m16:14:41.966477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D5E83050>]}
[0m16:14:41.966477 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:41.967478 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:41.967478 [debug] [MainThread]: On master: BEGIN
[0m16:14:41.968804 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:14:41.968804 [debug] [MainThread]: On master: COMMIT
[0m16:14:41.968804 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:41.969847 [debug] [MainThread]: On master: COMMIT
[0m16:14:41.970468 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:41.970468 [debug] [MainThread]: On master: Close
[0m16:14:41.974475 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_city
[0m16:14:41.975511 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_city ................................. [RUN]
[0m16:14:41.975511 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_city'
[0m16:14:41.977016 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_city
[0m16:14:41.982796 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_city"
[0m16:14:41.983775 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_city
[0m16:14:42.018876 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_city"
[0m16:14:42.019883 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:14:42.020839 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: BEGIN
[0m16:14:42.020839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:42.063970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:14:42.063970 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:14:42.064927 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

  create view "sakila_db"."public"."stg_dv_city__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_city"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(city_id as TEXT)),'^^'))) as hk_city_h,
        MD5(CONCAT(COALESCE(TRIM(CAST(country_id as TEXT)),'^^'))) as hk_country_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city_id as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(country_id as TEXT)),'^^')
        )) as hk_city_country_l
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_city_s
    from "sakila_db"."public"."stg_raw_city"
),

ghost_records as (
    select 
        0 as city_id,
        '(unknown)' as city,
        0 as country_id,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_city_h,
        '00000000000000000000000000000000' as hk_city_country_l,
        '00000000000000000000000000000000' as hd_city_s
    union all
    select
        -1 as city_id,
        '(error)' as city,
        0 as country_id,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_city_h,
        'ffffffffffffffffffffffffffffffff' as hk_city_country_l,
        'ffffffffffffffffffffffffffffffff' as hd_city_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:14:42.065929 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Syntaxfehler bei Â»MD5Â«
LINE 22:         MD5(CONCAT(
                 ^

[0m16:14:42.065929 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: ROLLBACK
[0m16:14:42.066928 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: Close
[0m16:14:42.071928 [debug] [Thread-1 (]: Database Error in model stg_dv_city (models\stg_dv\stg_dv_city.sql)
  FEHLER:  Syntaxfehler bei Â»MD5Â«
  LINE 22:         MD5(CONCAT(
                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_city.sql
[0m16:14:42.073929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05bbb8da-4b2e-4ea7-8518-222771379ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D6371640>]}
[0m16:14:42.073929 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_city ........................ [[31mERROR[0m in 0.10s]
[0m16:14:42.074928 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_city
[0m16:14:42.075928 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_city' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_city (models\stg_dv\stg_dv_city.sql)
  FEHLER:  Syntaxfehler bei Â»MD5Â«
  LINE 22:         MD5(CONCAT(
                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_city.sql.
[0m16:14:42.077293 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:42.078375 [debug] [MainThread]: On master: BEGIN
[0m16:14:42.078375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:42.124203 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m16:14:42.124203 [debug] [MainThread]: On master: COMMIT
[0m16:14:42.124203 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:42.125237 [debug] [MainThread]: On master: COMMIT
[0m16:14:42.125237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:42.126200 [debug] [MainThread]: On master: Close
[0m16:14:42.126200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:42.127199 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:14:42.128120 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:14:42.128120 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_city' was properly closed.
[0m16:14:42.129233 [info ] [MainThread]: 
[0m16:14:42.130223 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m16:14:42.132219 [debug] [MainThread]: Command end result
[0m16:14:42.156675 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:14:42.158676 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:14:42.166817 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:14:42.167817 [info ] [MainThread]: 
[0m16:14:42.168812 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:14:42.168812 [info ] [MainThread]: 
[0m16:14:42.169834 [error] [MainThread]: [31mFailure in model stg_dv_city (models\stg_dv\stg_dv_city.sql)[0m
[0m16:14:42.170810 [error] [MainThread]:   Database Error in model stg_dv_city (models\stg_dv\stg_dv_city.sql)
  FEHLER:  Syntaxfehler bei Â»MD5Â«
  LINE 22:         MD5(CONCAT(
                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_city.sql
[0m16:14:42.170810 [info ] [MainThread]: 
[0m16:14:42.171866 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_city.sql
[0m16:14:42.171866 [info ] [MainThread]: 
[0m16:14:42.172810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:14:42.173810 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:14:42.174810 [debug] [MainThread]: Command `dbt build` failed at 16:14:42.174810 after 1.95 seconds
[0m16:14:42.174810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D3D4B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D3D4B0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3D3D4B170>]}
[0m16:14:42.175837 [debug] [MainThread]: Flushing usage events
[0m16:14:43.228509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:54.020428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D157530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D154170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D1574A0>]}


============================== 16:14:54.024432 | 31483778-24d9-4b9f-bb4e-3cd6ea5f980b ==============================
[0m16:14:54.024432 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:14:54.025434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_city.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:54.025434 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:14:54.025434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D1542F0>]}
[0m16:14:54.234748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D595670>]}
[0m16:14:54.299715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D3803B0>]}
[0m16:14:54.301609 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:14:54.549575 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:14:54.721234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:14:54.722231 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_city.sql
[0m16:14:54.993837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743ED1A1E0>]}
[0m16:14:55.077818 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:14:55.092711 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:14:55.139617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743ED20F80>]}
[0m16:14:55.140612 [info ] [MainThread]: Found 21 models, 4 data tests, 15 sources, 433 macros
[0m16:14:55.146480 [info ] [MainThread]: 
[0m16:14:55.147452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:55.148444 [info ] [MainThread]: 
[0m16:14:55.148444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:55.150192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:14:55.231895 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:14:55.232936 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:14:55.232936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:55.277229 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m16:14:55.278618 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:14:55.283812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:14:55.288848 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:14:55.288848 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:14:55.289812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:55.329802 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m16:14:55.329802 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:14:55.329802 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:14:55.337348 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.006 seconds
[0m16:14:55.339345 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:14:55.339345 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:14:55.351649 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:55.351649 [debug] [MainThread]: On master: BEGIN
[0m16:14:55.352649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:55.392217 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m16:14:55.393759 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:55.394586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:55.404154 [debug] [MainThread]: SQL status: SELECT 61 in 0.009 seconds
[0m16:14:55.417097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743EBEAC30>]}
[0m16:14:55.417097 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:55.418098 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:55.418098 [debug] [MainThread]: On master: BEGIN
[0m16:14:55.419486 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:14:55.419486 [debug] [MainThread]: On master: COMMIT
[0m16:14:55.419486 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:55.420529 [debug] [MainThread]: On master: COMMIT
[0m16:14:55.421213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:55.421213 [debug] [MainThread]: On master: Close
[0m16:14:55.425275 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_city
[0m16:14:55.425275 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_city ................................. [RUN]
[0m16:14:55.427889 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_city'
[0m16:14:55.428222 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_city
[0m16:14:55.434261 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_city"
[0m16:14:55.435258 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_city
[0m16:14:55.469022 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_city"
[0m16:14:55.470019 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:14:55.470019 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: BEGIN
[0m16:14:55.471018 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:55.511969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m16:14:55.513013 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:14:55.513013 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

  create view "sakila_db"."public"."stg_dv_city__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_city"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(city_id as TEXT)),'^^'))) as hk_city_h,
        MD5(CONCAT(COALESCE(TRIM(CAST(country_id as TEXT)),'^^'))) as hk_country_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city_id as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(country_id as TEXT)),'^^')
        )) as hk_city_country_l,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_city_s
    from "sakila_db"."public"."stg_raw_city"
),

ghost_records as (
    select 
        0 as city_id,
        '(unknown)' as city,
        0 as country_id,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_city_h,
        '00000000000000000000000000000000' as hk_city_country_l,
        '00000000000000000000000000000000' as hd_city_s
    union all
    select
        -1 as city_id,
        '(error)' as city,
        0 as country_id,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_city_h,
        'ffffffffffffffffffffffffffffffff' as hk_city_country_l,
        'ffffffffffffffffffffffffffffffff' as hd_city_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:14:55.514974 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
LINE 56:     select * from ghost_records
                    ^

[0m16:14:55.514974 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: ROLLBACK
[0m16:14:55.516012 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: Close
[0m16:14:55.521009 [debug] [Thread-1 (]: Database Error in model stg_dv_city (models\stg_dv\stg_dv_city.sql)
  FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
  LINE 56:     select * from ghost_records
                      ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_city.sql
[0m16:14:55.522973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31483778-24d9-4b9f-bb4e-3cd6ea5f980b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743CA88350>]}
[0m16:14:55.523975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_city ........................ [[31mERROR[0m in 0.09s]
[0m16:14:55.524975 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_city
[0m16:14:55.526012 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_city' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_city (models\stg_dv\stg_dv_city.sql)
  FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
  LINE 56:     select * from ghost_records
                      ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_city.sql.
[0m16:14:55.527606 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:55.527606 [debug] [MainThread]: On master: BEGIN
[0m16:14:55.527606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:55.572321 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:14:55.572321 [debug] [MainThread]: On master: COMMIT
[0m16:14:55.572321 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:55.573345 [debug] [MainThread]: On master: COMMIT
[0m16:14:55.573345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:55.574308 [debug] [MainThread]: On master: Close
[0m16:14:55.574308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:55.575308 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:14:55.575308 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:14:55.575308 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_city' was properly closed.
[0m16:14:55.575308 [info ] [MainThread]: 
[0m16:14:55.576818 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:14:55.577827 [debug] [MainThread]: Command end result
[0m16:14:55.608208 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:14:55.610206 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:14:55.617909 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:14:55.617909 [info ] [MainThread]: 
[0m16:14:55.618912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:14:55.619908 [info ] [MainThread]: 
[0m16:14:55.619908 [error] [MainThread]: [31mFailure in model stg_dv_city (models\stg_dv\stg_dv_city.sql)[0m
[0m16:14:55.620909 [error] [MainThread]:   Database Error in model stg_dv_city (models\stg_dv\stg_dv_city.sql)
  FEHLER:  jede UNION-Anfrage muss die gleiche Anzahl Spalten haben
  LINE 56:     select * from ghost_records
                      ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_city.sql
[0m16:14:55.621908 [info ] [MainThread]: 
[0m16:14:55.622908 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_city.sql
[0m16:14:55.623911 [info ] [MainThread]: 
[0m16:14:55.624917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:14:55.625951 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:14:55.627960 [debug] [MainThread]: Command `dbt build` failed at 16:14:55.626910 after 1.75 seconds
[0m16:14:55.627960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A527B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743E799370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743F2F3EC0>]}
[0m16:14:55.629149 [debug] [MainThread]: Flushing usage events
[0m16:14:56.638746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:01.158374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017957ED7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017957ED6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017957ED42C0>]}


============================== 16:16:01.162318 | fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f ==============================
[0m16:16:01.162318 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:16:01.163535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_city.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:01.163535 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:16:01.164540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179552A3C80>]}
[0m16:16:01.373215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179584160C0>]}
[0m16:16:01.441723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179577DE630>]}
[0m16:16:01.442723 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:16:01.700072 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:16:01.871204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:01.872205 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_city.sql
[0m16:16:02.144756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001795998E510>]}
[0m16:16:02.228902 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:16:02.243857 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:16:02.289899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017959E35220>]}
[0m16:16:02.290844 [info ] [MainThread]: Found 21 models, 4 data tests, 15 sources, 433 macros
[0m16:16:02.296816 [info ] [MainThread]: 
[0m16:16:02.297788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:16:02.298781 [info ] [MainThread]: 
[0m16:16:02.298781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:02.299779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:16:02.381191 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:16:02.381191 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:16:02.382192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:02.425601 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m16:16:02.428264 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:16:02.434466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:16:02.439471 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:16:02.439471 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:16:02.440472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:02.480648 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m16:16:02.480648 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:16:02.480648 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:16:02.487346 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.006 seconds
[0m16:16:02.489345 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:16:02.490351 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:16:02.502709 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:02.502709 [debug] [MainThread]: On master: BEGIN
[0m16:16:02.503707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:02.544270 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m16:16:02.544270 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:02.544270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:16:02.553830 [debug] [MainThread]: SQL status: SELECT 61 in 0.008 seconds
[0m16:16:02.567195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017959929790>]}
[0m16:16:02.567195 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:02.568194 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:02.568194 [debug] [MainThread]: On master: BEGIN
[0m16:16:02.569196 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:16:02.569196 [debug] [MainThread]: On master: COMMIT
[0m16:16:02.570193 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:02.570193 [debug] [MainThread]: On master: COMMIT
[0m16:16:02.571290 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:16:02.571290 [debug] [MainThread]: On master: Close
[0m16:16:02.575296 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_city
[0m16:16:02.576839 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_city ................................. [RUN]
[0m16:16:02.577547 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_city'
[0m16:16:02.577547 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_city
[0m16:16:02.583888 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.584886 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_city
[0m16:16:02.619602 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.620555 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.620555 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: BEGIN
[0m16:16:02.620555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:02.792179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.171 seconds
[0m16:16:02.792179 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.792179 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

  create view "sakila_db"."public"."stg_dv_city__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_city"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(city_id as TEXT)),'^^'))) as hk_city_h,
        MD5(CONCAT(COALESCE(TRIM(CAST(country_id as TEXT)),'^^'))) as hk_country_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city_id as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(country_id as TEXT)),'^^')
        )) as hk_city_country_l,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_city_s
    from "sakila_db"."public"."stg_raw_city"
),

ghost_records as (
    select 
        0 as city_id,
        '(unknown)' as city,
        0 as country_id,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_city_h,
        '00000000000000000000000000000000' as hk_country_h,
        '00000000000000000000000000000000' as hk_city_country_l,
        '00000000000000000000000000000000' as hd_city_s
    union all
    select
        -1 as city_id,
        '(error)' as city,
        0 as country_id,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_city_h,
        'ffffffffffffffffffffffffffffffff' as hk_country_h,
        'ffffffffffffffffffffffffffffffff' as hk_city_country_l,
        'ffffffffffffffffffffffffffffffff' as hd_city_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:16:02.800580 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:16:02.806616 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.807617 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
alter table "sakila_db"."public"."stg_dv_city__dbt_tmp" rename to "stg_dv_city"
[0m16:16:02.808580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:16:02.821001 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: COMMIT
[0m16:16:02.822001 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.822001 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: COMMIT
[0m16:16:02.824265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:16:02.830616 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_city__dbt_backup"
[0m16:16:02.835616 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:16:02.835616 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
drop view if exists "sakila_db"."public"."stg_dv_city__dbt_backup" cascade
[0m16:16:02.836578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:16:02.838615 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: Close
[0m16:16:02.841585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdeaf18f-ab1d-4a64-9e9b-901cf5a4053f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179554A3500>]}
[0m16:16:02.842581 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_city ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m16:16:02.844277 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_city
[0m16:16:02.845552 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:02.846558 [debug] [MainThread]: On master: BEGIN
[0m16:16:02.847598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:02.891887 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:16:02.891887 [debug] [MainThread]: On master: COMMIT
[0m16:16:02.891887 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:02.892886 [debug] [MainThread]: On master: COMMIT
[0m16:16:02.892886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:16:02.893888 [debug] [MainThread]: On master: Close
[0m16:16:02.895132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:02.895132 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:16:02.895132 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:16:02.896137 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_city' was properly closed.
[0m16:16:02.896137 [info ] [MainThread]: 
[0m16:16:02.897141 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m16:16:02.899141 [debug] [MainThread]: Command end result
[0m16:16:02.927793 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:16:02.931097 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:16:02.937985 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:16:02.938704 [info ] [MainThread]: 
[0m16:16:02.939263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:02.940440 [info ] [MainThread]: 
[0m16:16:02.940991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:16:02.942153 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:16:02.943233 [debug] [MainThread]: Command `dbt build` succeeded at 16:16:02.943233 after 1.94 seconds
[0m16:16:02.944479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001795823AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017958052B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179580513D0>]}
[0m16:16:02.944479 [debug] [MainThread]: Flushing usage events
[0m16:16:03.991155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:02.772786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2690C5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F268C12450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2630D9C40>]}


============================== 16:23:02.778106 | c34a6eb4-4b9c-4323-8cb0-081b37ebf303 ==============================
[0m16:23:02.778106 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:23:02.779112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_city.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:02.779112 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:23:02.780111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F268C12450>]}
[0m16:23:03.032209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2666C4200>]}
[0m16:23:03.095635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26A6CC7A0>]}
[0m16:23:03.097571 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:23:03.350780 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:23:03.525057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:23:03.526094 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://models\stg_dv\stg_dv_country.sql
[0m16:23:03.526094 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_city.sql
[0m16:23:03.835036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26AB9D730>]}
[0m16:23:03.947621 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:23:03.970338 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:23:04.058948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26AB1FE60>]}
[0m16:23:04.058948 [info ] [MainThread]: Found 22 models, 4 data tests, 15 sources, 433 macros
[0m16:23:04.073588 [info ] [MainThread]: 
[0m16:23:04.074591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:04.075589 [info ] [MainThread]: 
[0m16:23:04.075589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:04.078104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:23:04.177677 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:23:04.177677 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:23:04.178678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:04.326003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.148 seconds
[0m16:23:04.328209 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:23:04.335364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:23:04.342332 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:23:04.344416 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:23:04.345176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:04.396746 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m16:23:04.396746 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:23:04.396746 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:23:04.403746 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.006 seconds
[0m16:23:04.405746 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:23:04.405746 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:23:04.419192 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.419192 [debug] [MainThread]: On master: BEGIN
[0m16:23:04.419192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:04.466232 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m16:23:04.669714 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.670722 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:04.684937 [debug] [MainThread]: SQL status: SELECT 62 in 0.013 seconds
[0m16:23:04.703599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26B3C1490>]}
[0m16:23:04.703599 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:04.704600 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.705613 [debug] [MainThread]: On master: BEGIN
[0m16:23:04.706382 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:23:04.706382 [debug] [MainThread]: On master: COMMIT
[0m16:23:04.706382 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.707428 [debug] [MainThread]: On master: COMMIT
[0m16:23:04.708114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:04.708114 [debug] [MainThread]: On master: Close
[0m16:23:04.713442 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_city
[0m16:23:04.714451 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_city ................................. [RUN]
[0m16:23:04.715446 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_city'
[0m16:23:04.715446 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_city
[0m16:23:04.722441 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.723442 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_city
[0m16:23:04.762770 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.763771 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.764737 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: BEGIN
[0m16:23:04.764737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:04.809017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:23:04.809017 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.810878 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

  create view "sakila_db"."public"."stg_dv_city__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_city"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(city_id as TEXT)),'^^'))) as hk_city_h,
        MD5(CONCAT(COALESCE(TRIM(CAST(country_id as TEXT)),'^^'))) as hk_country_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city_id as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(country_id as TEXT)),'^^')
        )) as hk_city_country_l,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(city as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_city_s
    from "sakila_db"."public"."stg_raw_city"
),

ghost_records as (
    select 
        0 as city_id,
        '(unknown)' as city,
        0 as country_id,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_city_h,
        '00000000000000000000000000000000' as hk_country_h,
        '00000000000000000000000000000000' as hk_city_country_l,
        '00000000000000000000000000000000' as hd_city_s
    union all
    select
        -1 as city_id,
        '(error)' as city,
        -1 as country_id,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_city_h,
        'ffffffffffffffffffffffffffffffff' as hk_country_h,
        'ffffffffffffffffffffffffffffffff' as hk_city_country_l,
        'ffffffffffffffffffffffffffffffff' as hd_city_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:23:04.821210 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:23:04.828720 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.829764 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
alter table "sakila_db"."public"."stg_dv_city" rename to "stg_dv_city__dbt_backup"
[0m16:23:04.831763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:04.834762 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.834762 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
alter table "sakila_db"."public"."stg_dv_city__dbt_tmp" rename to "stg_dv_city"
[0m16:23:04.836760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:04.854746 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: COMMIT
[0m16:23:04.854746 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.854746 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: COMMIT
[0m16:23:04.857111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:04.864486 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_city__dbt_backup"
[0m16:23:04.870449 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m16:23:04.870449 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
drop view if exists "sakila_db"."public"."stg_dv_city__dbt_backup" cascade
[0m16:23:04.873331 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:04.875347 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: Close
[0m16:23:04.881275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34a6eb4-4b9c-4323-8cb0-081b37ebf303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F266697320>]}
[0m16:23:04.882279 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_city ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m16:23:04.883272 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_city
[0m16:23:04.885273 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.885273 [debug] [MainThread]: On master: BEGIN
[0m16:23:04.886279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:04.940305 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m16:23:04.940305 [debug] [MainThread]: On master: COMMIT
[0m16:23:04.941346 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.941346 [debug] [MainThread]: On master: COMMIT
[0m16:23:04.942318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:04.942318 [debug] [MainThread]: On master: Close
[0m16:23:04.942318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:04.943825 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:23:04.943825 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:23:04.945068 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_city' was properly closed.
[0m16:23:04.946083 [info ] [MainThread]: 
[0m16:23:04.947100 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:23:04.948073 [debug] [MainThread]: Command end result
[0m16:23:04.975836 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:23:04.979880 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:23:04.987870 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:23:04.987870 [info ] [MainThread]: 
[0m16:23:04.988873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:04.989878 [info ] [MainThread]: 
[0m16:23:04.990892 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:23:04.990892 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:23:04.991903 [debug] [MainThread]: Command `dbt build` succeeded at 16:23:04.991903 after 2.45 seconds
[0m16:23:04.992911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26921A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F269219D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2692198B0>]}
[0m16:23:04.992911 [debug] [MainThread]: Flushing usage events
[0m16:23:06.052367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:43.179812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163018ACE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001637FC57D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016301540E90>]}


============================== 16:23:43.183602 | 4e512602-fff3-47a9-822d-3c106bc89d82 ==============================
[0m16:23:43.183602 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:23:43.184605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_country.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:43.185603 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:23:43.185603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001630201ABD0>]}
[0m16:23:43.394441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016301CB7FE0>]}
[0m16:23:43.457479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016301EABDA0>]}
[0m16:23:43.459442 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:23:43.704648 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:23:43.864075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:43.865117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:43.913049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001630340EC30>]}
[0m16:23:44.005069 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:23:44.022505 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:23:44.069142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001630377BA40>]}
[0m16:23:44.069142 [info ] [MainThread]: Found 22 models, 4 data tests, 15 sources, 433 macros
[0m16:23:44.075102 [info ] [MainThread]: 
[0m16:23:44.076140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:44.077101 [info ] [MainThread]: 
[0m16:23:44.077637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:44.078682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:23:44.159030 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:23:44.160572 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:23:44.160572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:44.205860 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m16:23:44.207859 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:23:44.214348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:23:44.219353 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:23:44.220353 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:23:44.220353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:44.258887 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m16:23:44.258887 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:23:44.258887 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:23:44.265840 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.006 seconds
[0m16:23:44.267804 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:23:44.268803 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:23:44.281478 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:44.281478 [debug] [MainThread]: On master: BEGIN
[0m16:23:44.282515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:44.322202 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m16:23:44.322202 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:44.322202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:44.330931 [debug] [MainThread]: SQL status: SELECT 62 in 0.008 seconds
[0m16:23:44.344596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016303E752B0>]}
[0m16:23:44.344596 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:44.345661 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:44.345661 [debug] [MainThread]: On master: BEGIN
[0m16:23:44.346661 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:23:44.346661 [debug] [MainThread]: On master: COMMIT
[0m16:23:44.347661 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:44.347661 [debug] [MainThread]: On master: COMMIT
[0m16:23:44.347661 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:44.348660 [debug] [MainThread]: On master: Close
[0m16:23:44.352693 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_country
[0m16:23:44.353657 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_country .............................. [RUN]
[0m16:23:44.354657 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_country'
[0m16:23:44.354657 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_country
[0m16:23:44.360548 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.182776 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_country
[0m16:23:46.217076 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.218076 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.219077 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: BEGIN
[0m16:23:46.219077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:46.258892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m16:23:46.260434 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.261333 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */

  create view "sakila_db"."public"."stg_dv_country__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_country"
),

column_hash as (
    select
        *,
        MD5(CONCAT(COALESCE(TRIM(CAST(country_id as TEXT)),'^^'))) as hk_country_h,
        MD5(CONCAT(
            COALESCE(TRIM(CAST(country as TEXT)),'^^'),'||',
            COALESCE(TRIM(CAST(last_update as TEXT)),'^^')
        )) as hd_country_s
    from "sakila_db"."public"."stg_raw_country"
),

ghost_records as (
    select 
        0 as country_id,
        '(unknown)' as country,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(unknown)' as rsrc,
        '00000000000000000000000000000000' as hk_country_h,
        '00000000000000000000000000000000' as hd_country_s
    union all
    select
        -1 as country_id,
        '(error)' as country,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as last_update,
        to_timestamp('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') as ldts,
        '(error)' as rsrc,
        'ffffffffffffffffffffffffffffffff' as hk_country_h,
        'ffffffffffffffffffffffffffffffff' as hd_country_s
),

selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:23:46.268973 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:23:46.274969 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.274969 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */
alter table "sakila_db"."public"."stg_dv_country__dbt_tmp" rename to "stg_dv_country"
[0m16:23:46.275970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:46.289960 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: COMMIT
[0m16:23:46.289960 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.290960 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: COMMIT
[0m16:23:46.291922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:46.299694 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_country__dbt_backup"
[0m16:23:46.305694 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m16:23:46.305694 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */
drop view if exists "sakila_db"."public"."stg_dv_country__dbt_backup" cascade
[0m16:23:46.306694 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:23:46.308694 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: Close
[0m16:23:46.312122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e512602-fff3-47a9-822d-3c106bc89d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001637F2BB080>]}
[0m16:23:46.313207 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_country ......................... [[32mCREATE VIEW[0m in 1.96s]
[0m16:23:46.313207 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_country
[0m16:23:46.315207 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:46.315207 [debug] [MainThread]: On master: BEGIN
[0m16:23:46.315207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:46.358681 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m16:23:46.358681 [debug] [MainThread]: On master: COMMIT
[0m16:23:46.358681 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:46.358681 [debug] [MainThread]: On master: COMMIT
[0m16:23:46.360223 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:46.361230 [debug] [MainThread]: On master: Close
[0m16:23:46.361230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:46.362235 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:23:46.362235 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:23:46.362235 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_country' was properly closed.
[0m16:23:46.363235 [info ] [MainThread]: 
[0m16:23:46.364236 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m16:23:46.365236 [debug] [MainThread]: Command end result
[0m16:23:46.389835 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:23:46.391838 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:23:46.398101 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:23:46.399101 [info ] [MainThread]: 
[0m16:23:46.399101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:46.400098 [info ] [MainThread]: 
[0m16:23:46.400761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:23:46.400761 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:23:46.401805 [debug] [MainThread]: Command `dbt build` succeeded at 16:23:46.401805 after 3.36 seconds
[0m16:23:46.402804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163016AA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016303849700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001637F0B7950>]}
[0m16:23:46.402804 [debug] [MainThread]: Flushing usage events
[0m16:23:47.476898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:30.378716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDD727290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDD727B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDD7246E0>]}


============================== 16:49:30.378716 | 7cbc3e7c-5de4-4d85-830c-3756696a6b40 ==============================
[0m16:49:30.378716 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:49:30.378716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_actor.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:30.378716 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:49:30.378716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDD6F9370>]}
[0m16:49:30.605452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDE2B6B10>]}
[0m16:49:30.671552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDE36B7D0>]}
[0m16:49:30.678220 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:49:31.061142 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:49:31.311377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m16:49:31.311377 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://macros\hash_columns.sql
[0m16:49:31.311377 [debug] [MainThread]: Partial parsing: added file: datavault_postgres_test://macros\generate_ghost_records.sql
[0m16:49:31.311377 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_category.sql
[0m16:49:31.311377 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_actor.sql
[0m16:49:31.311377 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_city.sql
[0m16:49:31.636496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDFA07B30>]}
[0m16:49:31.710379 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:49:31.735407 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:49:31.781016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDF9624E0>]}
[0m16:49:31.783022 [info ] [MainThread]: Found 22 models, 4 data tests, 15 sources, 435 macros
[0m16:49:31.787212 [info ] [MainThread]: 
[0m16:49:31.787212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:31.787212 [info ] [MainThread]: 
[0m16:49:31.790063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:31.791842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:49:31.861688 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:49:31.861688 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:49:31.861688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:31.927236 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m16:49:31.928281 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:49:31.935286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:49:31.941323 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:49:31.941323 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:49:31.942287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:31.976772 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m16:49:31.976772 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:49:31.976772 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:49:31.993547 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.007 seconds
[0m16:49:31.993547 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:49:31.993547 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:49:32.010096 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.010096 [debug] [MainThread]: On master: BEGIN
[0m16:49:32.010096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:32.043417 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m16:49:32.055544 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.055544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:32.065030 [debug] [MainThread]: SQL status: SELECT 63 in 0.009 seconds
[0m16:49:32.077021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDF94F230>]}
[0m16:49:32.077021 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:32.077021 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.077021 [debug] [MainThread]: On master: BEGIN
[0m16:49:32.077021 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:49:32.077021 [debug] [MainThread]: On master: COMMIT
[0m16:49:32.077021 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.077021 [debug] [MainThread]: On master: COMMIT
[0m16:49:32.077021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:49:32.077021 [debug] [MainThread]: On master: Close
[0m16:49:32.087436 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m16:49:32.087436 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m16:49:32.087436 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m16:49:32.087436 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m16:49:32.093666 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:49:32.093666 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m16:49:32.137316 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:49:32.138317 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:49:32.138317 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m16:49:32.139316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:32.177406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m16:49:32.177406 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:49:32.177406 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(actor_id AS TEXT)), '^^')
        
        )
    ) AS hk_actor_h
,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(first_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST(last_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST( AS TEXT)), '^^')
        
        )
    ) AS hd_actor_h

    from "sakila_db"."public"."stg_raw_actor"
),


ghost_records as (
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'integer' in ('numeric', 'decimal') 
                    then 0.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '0001-01-01'::date
                when 'integer' = 'time' 
                    then '00:00:01'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as rsrc,
        
        
            '00000000000000000000000000000000' as hk_actor_h,
        
            '00000000000000000000000000000000' as hd_actor_s
        
    union all
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'integer' in ('numeric', 'decimal') 
                    then -1.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '8888-12-31'::date
                when 'integer' = 'time' 
                    then '23:59:59'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as rsrc,
        
        
            'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        
            'ffffffffffffffffffffffffffffffff' as hd_actor_s
        
)


selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:49:32.177406 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Syntaxfehler bei Â»ASÂ«
LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                         ^

[0m16:49:32.177406 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: ROLLBACK
[0m16:49:32.177406 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m16:49:32.186929 [debug] [Thread-1 (]: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»ASÂ«
  LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                           ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:49:32.186929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cbc3e7c-5de4-4d85-830c-3756696a6b40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE023BC80>]}
[0m16:49:32.186929 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_actor ....................... [[31mERROR[0m in 0.10s]
[0m16:49:32.192951 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m16:49:32.193457 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»ASÂ«
  LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                           ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql.
[0m16:49:32.193457 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.193457 [debug] [MainThread]: On master: BEGIN
[0m16:49:32.193457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:32.231676 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:49:32.231676 [debug] [MainThread]: On master: COMMIT
[0m16:49:32.231676 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.231676 [debug] [MainThread]: On master: COMMIT
[0m16:49:32.231676 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:49:32.231676 [debug] [MainThread]: On master: Close
[0m16:49:32.231676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:32.231676 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:49:32.231676 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:49:32.231676 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m16:49:32.243832 [info ] [MainThread]: 
[0m16:49:32.244973 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:49:32.244973 [debug] [MainThread]: Command end result
[0m16:49:32.267417 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:49:32.267417 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:49:32.282184 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:49:32.282184 [info ] [MainThread]: 
[0m16:49:32.283188 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:49:32.284188 [info ] [MainThread]: 
[0m16:49:32.284188 [error] [MainThread]: [31mFailure in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)[0m
[0m16:49:32.285184 [error] [MainThread]:   Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»ASÂ«
  LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                           ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:49:32.285184 [info ] [MainThread]: 
[0m16:49:32.285184 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:49:32.285184 [info ] [MainThread]: 
[0m16:49:32.285184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:32.285184 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:49:32.289457 [debug] [MainThread]: Command `dbt build` failed at 16:49:32.289457 after 2.12 seconds
[0m16:49:32.289457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDB8C4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDF560B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DDDE27560>]}
[0m16:49:32.290501 [debug] [MainThread]: Flushing usage events
[0m16:49:33.511503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:57.690215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7FCA7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7FCA5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7FD04080>]}


============================== 16:50:57.693926 | 0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9 ==============================
[0m16:50:57.693926 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:50:57.695821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_actor.sql', 'send_anonymous_usage_stats': 'True'}
[0m16:50:57.695821 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:50:57.695821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C000363C0>]}
[0m16:50:57.893482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C00099040>]}
[0m16:50:57.960266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C002D7BF0>]}
[0m16:50:57.960266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:50:58.207853 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:50:58.370194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:58.370194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:58.415825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C0009B230>]}
[0m16:51:00.136141 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:51:00.151474 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:51:00.199401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C001D6600>]}
[0m16:51:00.199401 [info ] [MainThread]: Found 22 models, 4 data tests, 15 sources, 435 macros
[0m16:51:00.205194 [info ] [MainThread]: 
[0m16:51:00.205194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:00.205194 [info ] [MainThread]: 
[0m16:51:00.205194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:00.210131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:51:00.295423 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:51:00.295423 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:51:00.295423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:00.347049 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m16:51:00.347750 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:51:00.354139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:51:00.361821 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:51:00.361821 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:51:00.361821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:00.394366 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m16:51:00.394366 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:51:00.394366 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:51:00.410123 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.006 seconds
[0m16:51:00.410123 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:51:00.410123 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:51:00.427067 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:00.427067 [debug] [MainThread]: On master: BEGIN
[0m16:51:00.427067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:00.560497 [debug] [MainThread]: SQL status: BEGIN in 0.138 seconds
[0m16:51:00.560497 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:00.560497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:00.568664 [debug] [MainThread]: SQL status: SELECT 63 in 0.008 seconds
[0m16:51:00.584588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C01FB4590>]}
[0m16:51:00.584588 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:00.584588 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:00.584588 [debug] [MainThread]: On master: BEGIN
[0m16:51:00.584588 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:51:00.584588 [debug] [MainThread]: On master: COMMIT
[0m16:51:00.584588 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:00.584588 [debug] [MainThread]: On master: COMMIT
[0m16:51:00.584588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:51:00.584588 [debug] [MainThread]: On master: Close
[0m16:51:00.593685 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m16:51:00.593685 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m16:51:00.593685 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m16:51:00.593685 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m16:51:00.610301 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:51:00.988433 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m16:51:01.027084 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:51:01.027084 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:51:01.027084 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m16:51:01.027084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:01.067767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:51:01.067767 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:51:01.067767 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(actor_id AS TEXT)), '^^')
        
        )
    ) AS hk_actor_h
,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(first_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST(last_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST( AS TEXT)), '^^')
        
        )
    ) AS hd_actor_h

    from "sakila_db"."public"."stg_raw_actor"
),


ghost_records as (
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'integer' in ('numeric', 'decimal') 
                    then 0.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '0001-01-01'::date
                when 'integer' = 'time' 
                    then '00:00:01'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as rsrc,
        
        
            '00000000000000000000000000000000' as hk_actor_h,
        
            '00000000000000000000000000000000' as hd_actor_s
        
    union all
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'integer' in ('numeric', 'decimal') 
                    then -1.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '8888-12-31'::date
                when 'integer' = 'time' 
                    then '23:59:59'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as rsrc,
        
        
            'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        
            'ffffffffffffffffffffffffffffffff' as hd_actor_s
        
)


selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:51:01.067767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Syntaxfehler bei Â»ASÂ«
LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                         ^

[0m16:51:01.067767 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: ROLLBACK
[0m16:51:01.067767 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m16:51:01.077181 [debug] [Thread-1 (]: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»ASÂ«
  LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                           ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:51:01.077181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0cfe0a-712e-49f8-9ed8-d6dc3c84d7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C014E31D0>]}
[0m16:51:01.077181 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_actor ....................... [[31mERROR[0m in 0.48s]
[0m16:51:01.077181 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m16:51:01.077181 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»ASÂ«
  LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                           ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql.
[0m16:51:01.083780 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:01.083780 [debug] [MainThread]: On master: BEGIN
[0m16:51:01.083780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:01.227179 [debug] [MainThread]: SQL status: BEGIN in 0.142 seconds
[0m16:51:01.227179 [debug] [MainThread]: On master: COMMIT
[0m16:51:01.227179 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:01.227179 [debug] [MainThread]: On master: COMMIT
[0m16:51:01.227179 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:51:01.227179 [debug] [MainThread]: On master: Close
[0m16:51:01.227179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:01.227179 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:51:01.227179 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:51:01.227179 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m16:51:01.227179 [info ] [MainThread]: 
[0m16:51:01.227179 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m16:51:01.227179 [debug] [MainThread]: Command end result
[0m16:51:01.249088 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:51:01.260167 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:51:01.266691 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:51:01.267654 [info ] [MainThread]: 
[0m16:51:01.267654 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:51:01.268657 [info ] [MainThread]: 
[0m16:51:01.268657 [error] [MainThread]: [31mFailure in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)[0m
[0m16:51:01.268657 [error] [MainThread]:   Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»ASÂ«
  LINE 39:             COALESCE(TRIM(CAST( AS TEXT)), '^^')
                                           ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:51:01.268657 [info ] [MainThread]: 
[0m16:51:01.268657 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:51:01.268657 [info ] [MainThread]: 
[0m16:51:01.268657 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:51:01.268657 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:51:01.268657 [debug] [MainThread]: Command `dbt build` failed at 16:51:01.268657 after 3.74 seconds
[0m16:51:01.268657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C001FC440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7F5E5EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7F5E6FF0>]}
[0m16:51:01.275135 [debug] [MainThread]: Flushing usage events
[0m16:51:02.360569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:15.280269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB8E15370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB61E3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB8E158B0>]}


============================== 16:52:15.284787 | ac685d3f-5b32-4aed-a637-7f64f202b67b ==============================
[0m16:52:15.284787 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:52:15.285789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_actor.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:52:15.285789 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:52:15.286787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB8E17470>]}
[0m16:52:15.513407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB641C080>]}
[0m16:52:15.580181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB92A2960>]}
[0m16:52:15.580181 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:52:15.844197 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:52:16.012981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:16.012981 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://models\stg_dv\stg_dv_actor.sql
[0m16:52:16.576798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBAA4E450>]}
[0m16:52:16.671424 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:52:16.689653 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:52:16.746848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBAE0D2E0>]}
[0m16:52:16.746848 [info ] [MainThread]: Found 22 models, 4 data tests, 15 sources, 435 macros
[0m16:52:16.755597 [info ] [MainThread]: 
[0m16:52:16.756599 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:16.757259 [info ] [MainThread]: 
[0m16:52:16.757259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:16.759292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:52:16.857535 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:52:16.858534 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:52:16.858534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:17.012456 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.154 seconds
[0m16:52:17.014723 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:52:17.021146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:52:17.026119 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:52:17.026119 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:52:17.027555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:17.178103 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m16:52:17.178103 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:52:17.179113 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:52:17.180110 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.007 seconds
[0m16:52:17.180110 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:52:17.180110 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:52:17.201371 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:17.201371 [debug] [MainThread]: On master: BEGIN
[0m16:52:17.201371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:17.350790 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m16:52:17.350790 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:17.351791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:17.364362 [debug] [MainThread]: SQL status: SELECT 63 in 0.013 seconds
[0m16:52:17.377842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBAE656A0>]}
[0m16:52:17.377842 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:17.377842 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:17.377842 [debug] [MainThread]: On master: BEGIN
[0m16:52:17.377842 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:52:17.377842 [debug] [MainThread]: On master: COMMIT
[0m16:52:17.377842 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:17.377842 [debug] [MainThread]: On master: COMMIT
[0m16:52:17.377842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:17.377842 [debug] [MainThread]: On master: Close
[0m16:52:17.389676 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m16:52:17.389676 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m16:52:17.389676 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m16:52:17.389676 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m16:52:17.394367 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:17.394367 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m16:52:17.445940 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:17.446938 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:17.447938 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m16:52:17.447938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:52:17.493576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m16:52:17.493576 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:17.493576 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(actor_id AS TEXT)), '^^')
        
        )
    ) AS hk_actor_h
,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(first_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST(last_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST(last_update AS TEXT)), '^^')
        
        )
    ) AS hd_actor_h

    from "sakila_db"."public"."stg_raw_actor"
),


ghost_records as (
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'integer' in ('numeric', 'decimal') 
                    then 0.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '0001-01-01'::date
                when 'integer' = 'time' 
                    then '00:00:01'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as rsrc,
        
        
            '00000000000000000000000000000000' as hk_actor_h,
        
            '00000000000000000000000000000000' as hd_actor_s
        
    union all
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'integer' in ('numeric', 'decimal') 
                    then -1.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '8888-12-31'::date
                when 'integer' = 'time' 
                    then '23:59:59'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as rsrc,
        
        
            'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        
            'ffffffffffffffffffffffffffffffff' as hd_actor_s
        
)


selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:52:17.493576 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Syntaxfehler bei Â»selected_columnsÂ«
LINE 319: selected_columns as (
          ^

[0m16:52:17.493576 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: ROLLBACK
[0m16:52:17.493576 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m16:52:17.506336 [debug] [Thread-1 (]: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»selected_columnsÂ«
  LINE 319: selected_columns as (
            ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:52:17.509309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac685d3f-5b32-4aed-a637-7f64f202b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBAE64920>]}
[0m16:52:17.510315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_actor ....................... [[31mERROR[0m in 0.12s]
[0m16:52:17.510315 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m16:52:17.511572 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»selected_columnsÂ«
  LINE 319: selected_columns as (
            ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql.
[0m16:52:17.513580 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:17.514580 [debug] [MainThread]: On master: BEGIN
[0m16:52:17.514580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:17.562803 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m16:52:17.563838 [debug] [MainThread]: On master: COMMIT
[0m16:52:17.563838 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:17.564840 [debug] [MainThread]: On master: COMMIT
[0m16:52:17.564840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:17.565844 [debug] [MainThread]: On master: Close
[0m16:52:17.565844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:17.565844 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:52:17.566802 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:52:17.566802 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m16:52:17.567801 [info ] [MainThread]: 
[0m16:52:17.567801 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m16:52:17.568801 [debug] [MainThread]: Command end result
[0m16:52:17.598778 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:52:17.601397 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:52:17.610494 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:52:17.611345 [info ] [MainThread]: 
[0m16:52:17.612357 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:52:17.612935 [info ] [MainThread]: 
[0m16:52:17.612935 [error] [MainThread]: [31mFailure in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)[0m
[0m16:52:17.612935 [error] [MainThread]:   Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  Syntaxfehler bei Â»selected_columnsÂ«
  LINE 319: selected_columns as (
            ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:52:17.612935 [info ] [MainThread]: 
[0m16:52:17.612935 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:52:17.612935 [info ] [MainThread]: 
[0m16:52:17.612935 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:52:17.612935 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:52:17.612935 [debug] [MainThread]: Command `dbt build` failed at 16:52:17.612935 after 2.51 seconds
[0m16:52:17.612935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB8C6DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBAD31FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBA921F40>]}
[0m16:52:17.612935 [debug] [MainThread]: Flushing usage events
[0m16:52:18.663026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:42.276825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E03C3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E2C03740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E2C00440>]}


============================== 16:52:42.284451 | 97ec9688-d27a-41dc-8a70-ee03d614660e ==============================
[0m16:52:42.284451 [info ] [MainThread]: Running with dbt=1.10.1
[0m16:52:42.284451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_actor.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:42.284451 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m16:52:42.284451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E03C3050>]}
[0m16:52:42.493774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E32DB6B0>]}
[0m16:52:42.570371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E3007530>]}
[0m16:52:42.571366 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:52:42.833889 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m16:52:43.007688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:43.007688 [debug] [MainThread]: Partial parsing: updated file: datavault_postgres_test://macros\generate_ghost_records.sql
[0m16:52:43.327074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E4ADE7B0>]}
[0m16:52:43.411098 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:52:43.427618 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:52:43.477901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E45EAC60>]}
[0m16:52:43.477901 [info ] [MainThread]: Found 22 models, 4 data tests, 15 sources, 435 macros
[0m16:52:43.477901 [info ] [MainThread]: 
[0m16:52:43.492619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:43.493475 [info ] [MainThread]: 
[0m16:52:43.494481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:43.495487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m16:52:43.564395 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m16:52:43.564395 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m16:52:43.564395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:43.726894 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.151 seconds
[0m16:52:43.726894 [debug] [ThreadPool]: On list_sakila_db: Close
[0m16:52:43.729457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m16:52:43.729457 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:52:43.729457 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m16:52:43.741377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:43.876952 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m16:52:43.885050 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m16:52:43.885050 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:52:43.885050 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.007 seconds
[0m16:52:43.893681 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m16:52:43.893681 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m16:52:43.900956 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:43.900956 [debug] [MainThread]: On master: BEGIN
[0m16:52:43.900956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:43.943512 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m16:52:43.948225 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:43.948225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:43.948225 [debug] [MainThread]: SQL status: SELECT 63 in 0.008 seconds
[0m16:52:43.964281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E51EBC20>]}
[0m16:52:43.964281 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:43.964281 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:43.964281 [debug] [MainThread]: On master: BEGIN
[0m16:52:43.964281 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:52:43.964281 [debug] [MainThread]: On master: COMMIT
[0m16:52:43.964281 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:43.964281 [debug] [MainThread]: On master: COMMIT
[0m16:52:43.964281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:43.964281 [debug] [MainThread]: On master: Close
[0m16:52:43.976993 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m16:52:43.976993 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m16:52:43.980045 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m16:52:43.980045 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m16:52:43.980045 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:43.980045 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m16:52:44.027394 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:44.061987 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:44.061987 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m16:52:44.061987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:52:44.110146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:52:44.110146 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m16:52:44.110146 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    with source_data as (
    select
        *
    from "sakila_db"."public"."stg_raw_actor"
),

column_hash as (
    select
        *,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(actor_id AS TEXT)), '^^')
        
        )
    ) AS hk_actor_h
,
        
    
    
    
    MD5(
        CONCAT(
        
            COALESCE(TRIM(CAST(first_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST(last_name AS TEXT)), '^^'), '||', 
        
            COALESCE(TRIM(CAST(last_update AS TEXT)), '^^')
        
        )
    ) AS hd_actor_h

    from "sakila_db"."public"."stg_raw_actor"
),


ghost_records as (
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'integer' in ('numeric', 'decimal') 
                    then 0.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '0001-01-01'::date
                when 'integer' = 'time' 
                    then '00:00:01'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then 0.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '0001-01-01'::date
                when 'timestamp' = 'time' 
                    then '00:00:01'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then 0
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then 0.0
                when 'text' in ('numeric', 'decimal') 
                    then 0.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(unknown)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '0001-01-01'::date
                when 'text' = 'time' 
                    then '00:00:01'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '0001-01-01 00:00:01'::timestamp
                else 
                    '(unknown)'
            end as rsrc,
        
        
            '00000000000000000000000000000000' as hk_actor_h,
        
            '00000000000000000000000000000000' as hd_actor_s
        
    union all
    select 
        
            case 
                when 'integer' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'integer' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'integer' in ('numeric', 'decimal') 
                    then -1.0
                when 'integer' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'integer' in ('boolean', 'bool') 
                    then FALSE
                when 'integer' = 'date' 
                    then '8888-12-31'::date
                when 'integer' = 'time' 
                    then '23:59:59'::time
                when 'integer' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as actor_id,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as first_name,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_name,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as last_update,
        
            case 
                when 'timestamp' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'timestamp' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'timestamp' in ('numeric', 'decimal') 
                    then -1.0
                when 'timestamp' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'timestamp' in ('boolean', 'bool') 
                    then FALSE
                when 'timestamp' = 'date' 
                    then '8888-12-31'::date
                when 'timestamp' = 'time' 
                    then '23:59:59'::time
                when 'timestamp' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as ldts,
        
            case 
                when 'text' in ('int', 'integer', 'int4', 'smallint', 'int2', 'bigint', 'int8', 'serial', 'bigserial', 'smallserial') 
                    then -1
                when 'text' in ('float4', 'float8', 'real', 'double precision') 
                    then -1.0
                when 'text' in ('numeric', 'decimal') 
                    then -1.0
                when 'text' in ('text', 'varchar', 'char', 'character', 'character varying', 'string', 'citext') 
                    then '(error)'
                when 'text' in ('boolean', 'bool') 
                    then FALSE
                when 'text' = 'date' 
                    then '8888-12-31'::date
                when 'text' = 'time' 
                    then '23:59:59'::time
                when 'text' in ('timestamp', 'timestamptz') 
                    then '8888-12-31 23:59:59'::timestamp
                else 
                    '(error)'
            end as rsrc,
        
        
            'ffffffffffffffffffffffffffffffff' as hk_actor_h,
        
            'ffffffffffffffffffffffffffffffff' as hd_actor_s
        
),


selected_columns as (
    select * from column_hash
    union all
    select * from ghost_records
)

select * from selected_columns
  );
[0m16:52:44.110146 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  CASE-Typen numeric und boolean passen nicht zusammen
LINE 61:                     then FALSE
                                  ^

[0m16:52:44.110146 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: ROLLBACK
[0m16:52:44.110146 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m16:52:44.127106 [debug] [Thread-1 (]: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  CASE-Typen numeric und boolean passen nicht zusammen
  LINE 61:                     then FALSE
                                    ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:52:44.127106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec9688-d27a-41dc-8a70-ee03d614660e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E44F9040>]}
[0m16:52:44.127106 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_actor ....................... [[31mERROR[0m in 0.15s]
[0m16:52:44.127106 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m16:52:44.127106 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_actor' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  CASE-Typen numeric und boolean passen nicht zusammen
  LINE 61:                     then FALSE
                                    ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql.
[0m16:52:44.127106 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:44.127106 [debug] [MainThread]: On master: BEGIN
[0m16:52:44.127106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:44.162038 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m16:52:44.162038 [debug] [MainThread]: On master: COMMIT
[0m16:52:44.177280 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:44.177280 [debug] [MainThread]: On master: COMMIT
[0m16:52:44.178281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:44.178281 [debug] [MainThread]: On master: Close
[0m16:52:44.179315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:44.179315 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m16:52:44.179315 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m16:52:44.180313 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m16:52:44.180313 [info ] [MainThread]: 
[0m16:52:44.181287 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:52:44.182306 [debug] [MainThread]: Command end result
[0m16:52:44.198632 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\manifest.json
[0m16:52:44.213685 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\semantic_manifest.json
[0m16:52:44.217683 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\target\run_results.json
[0m16:52:44.217683 [info ] [MainThread]: 
[0m16:52:44.217683 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:52:44.217683 [info ] [MainThread]: 
[0m16:52:44.227304 [error] [MainThread]: [31mFailure in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)[0m
[0m16:52:44.229324 [error] [MainThread]:   Database Error in model stg_dv_actor (models\stg_dv\stg_dv_actor.sql)
  FEHLER:  CASE-Typen numeric und boolean passen nicht zusammen
  LINE 61:                     then FALSE
                                    ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:52:44.230325 [info ] [MainThread]: 
[0m16:52:44.230325 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_actor.sql
[0m16:52:44.230325 [info ] [MainThread]: 
[0m16:52:44.234015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:52:44.235272 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:52:44.236272 [debug] [MainThread]: Command `dbt build` failed at 16:52:44.236272 after 2.09 seconds
[0m16:52:44.237274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E2E4D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E2E4D670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E2FB5EB0>]}
[0m16:52:44.238301 [debug] [MainThread]: Flushing usage events
[0m16:52:45.278048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:55.642381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D611D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D2A3CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D00E9BE0>]}


============================== 17:30:55.739191 | 58cf9b88-40b1-4648-bd93-a694f1834b69 ==============================
[0m17:30:55.739191 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:30:55.739872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\datavault_postgres_test\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:30:55.765973 [info ] [MainThread]: dbt version: 1.10.1
[0m17:30:55.766932 [info ] [MainThread]: python version: 3.12.6
[0m17:30:55.766932 [info ] [MainThread]: python path: C:\Users\Predator\AppData\Local\Programs\Python\Python312\python.exe
[0m17:30:55.767931 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m17:30:55.836748 [info ] [MainThread]: Using profiles dir at C:\Users\Predator\.dbt
[0m17:30:55.837574 [info ] [MainThread]: Using profiles.yml file at C:\Users\Predator\.dbt\profiles.yml
[0m17:30:55.838270 [info ] [MainThread]: Using dbt_project.yml file at D:\Study Materials\datavault_dbt_postgres\datavault_postgres_test\dbt_project.yml
[0m17:30:55.839313 [info ] [MainThread]: adapter type: postgres
[0m17:30:55.840277 [info ] [MainThread]: adapter version: 1.9.0
[0m17:30:55.961069 [info ] [MainThread]: Configuration:
[0m17:30:55.961069 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:30:55.962036 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:30:55.963034 [info ] [MainThread]: Required dependencies:
[0m17:30:55.963034 [debug] [MainThread]: Executing "git --help"
[0m17:30:56.004523 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:30:56.004523 [debug] [MainThread]: STDERR: "b''"
[0m17:30:56.005529 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:30:56.005529 [info ] [MainThread]: Connection:
[0m17:30:56.006495 [info ] [MainThread]:   host: localhost
[0m17:30:56.006495 [info ] [MainThread]:   port: 5432
[0m17:30:56.006495 [info ] [MainThread]:   user: postgres
[0m17:30:56.008000 [info ] [MainThread]:   database: sakila_db
[0m17:30:56.009011 [info ] [MainThread]:   schema: public
[0m17:30:56.010017 [info ] [MainThread]:   connect_timeout: 10
[0m17:30:56.010017 [info ] [MainThread]:   role: None
[0m17:30:56.011026 [info ] [MainThread]:   search_path: None
[0m17:30:56.012025 [info ] [MainThread]:   keepalives_idle: 0
[0m17:30:56.013026 [info ] [MainThread]:   sslmode: None
[0m17:30:56.014026 [info ] [MainThread]:   sslcert: None
[0m17:30:56.015025 [info ] [MainThread]:   sslkey: None
[0m17:30:56.015025 [info ] [MainThread]:   sslrootcert: None
[0m17:30:56.016024 [info ] [MainThread]:   application_name: dbt
[0m17:30:56.017033 [info ] [MainThread]:   retries: 1
[0m17:30:56.019031 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:30:56.287677 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:30:56.353600 [debug] [MainThread]: Using postgres connection "debug"
[0m17:30:56.353600 [debug] [MainThread]: On debug: select 1 as id
[0m17:30:56.354599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:56.506276 [debug] [MainThread]: SQL status: SELECT 1 in 0.152 seconds
[0m17:30:56.507817 [debug] [MainThread]: On debug: Close
[0m17:30:56.508831 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:30:56.509838 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:30:56.511837 [debug] [MainThread]: Command `dbt debug` succeeded at 17:30:56.510840 after 1.03 seconds
[0m17:30:56.511837 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:30:56.511837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D2A3CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D5AAB170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D526B3E0>]}
[0m17:30:56.512836 [debug] [MainThread]: Flushing usage events
[0m17:30:57.472427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:34.132432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A66CE9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6A13D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6A1D7DA0>]}


============================== 17:33:34.138429 | c582b6d0-f8c5-4a92-bb58-485f06e67384 ==============================
[0m17:33:34.138429 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:33:34.139433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:34.411650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c582b6d0-f8c5-4a92-bb58-485f06e67384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6A69C6E0>]}
[0m17:33:34.455315 [debug] [MainThread]: Set downloads directory='C:\Users\Predator\AppData\Local\Temp\dbt-downloads-7fpf5y1_'
[0m17:33:34.456315 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:33:34.551271 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:33:34.551271 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/ScalefreeCOM/datavault4dbt.json
[0m17:33:34.618366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/ScalefreeCOM/datavault4dbt.json 200
[0m17:33:34.628878 [info ] [MainThread]: Updating lock file in file path: D:\Study Materials\datavault_dbt_postgres/package-lock.yml
[0m17:33:34.684508 [debug] [MainThread]: Set downloads directory='C:\Users\Predator\AppData\Local\Temp\dbt-downloads-2xugfxb_'
[0m17:33:34.688504 [info ] [MainThread]: Installing ScalefreeCOM/datavault4dbt
[0m17:33:35.371735 [info ] [MainThread]: Installed from version 1.9.10
[0m17:33:35.372775 [info ] [MainThread]: Up to date!
[0m17:33:35.372775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c582b6d0-f8c5-4a92-bb58-485f06e67384', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6A6C2DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6B8485C0>]}
[0m17:33:35.374317 [debug] [MainThread]: Command `dbt deps` succeeded at 17:33:35.374317 after 1.50 seconds
[0m17:33:35.375359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6A69C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6B81C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6797A4B0>]}
[0m17:33:35.375359 [debug] [MainThread]: Flushing usage events
[0m17:33:36.389526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:23.150806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229661674A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022963537920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022966498050>]}


============================== 19:24:23.154806 | d40c715b-0263-419e-b75e-4c157b14f9a9 ==============================
[0m19:24:23.154806 [info ] [MainThread]: Running with dbt=1.10.1
[0m19:24:23.155807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\*', 'send_anonymous_usage_stats': 'True'}
[0m19:24:23.155807 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m19:24:23.155807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022965C85D00>]}
[0m19:24:23.409207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229660C30B0>]}
[0m19:24:23.471780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229665CDF40>]}
[0m19:24:23.472917 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:24:23.868004 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m19:24:24.084703 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:24:24.084703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967B13440>]}
[0m19:24:29.503319 [debug] [MainThread]: source_model: stg_raw_actor
[0m19:24:29.504319 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_actor
[0m19:24:29.506319 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_actor"
[0m19:24:29.634020 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.645020 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.659537 [debug] [MainThread]: source_model: stg_raw_address
[0m19:24:29.660537 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_address
[0m19:24:29.660537 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_address"
[0m19:24:29.664048 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.666053 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.679567 [debug] [MainThread]: source_model: stg_raw_category
[0m19:24:29.680578 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_category
[0m19:24:29.680578 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_category"
[0m19:24:29.684587 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.694588 [debug] [MainThread]: source_model: stg_raw_city
[0m19:24:29.696097 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_city
[0m19:24:29.696097 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_city"
[0m19:24:29.699118 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.711117 [debug] [MainThread]: source_model: stg_raw_country
[0m19:24:29.711117 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_country
[0m19:24:29.712118 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_country"
[0m19:24:29.714641 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.725651 [debug] [MainThread]: source_model: stg_raw_customer
[0m19:24:29.726651 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_customer
[0m19:24:29.726651 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_customer"
[0m19:24:29.730161 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.732182 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.735182 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.739182 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.741182 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.744182 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.756713 [debug] [MainThread]: source_model: stg_raw_film
[0m19:24:29.756713 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_film
[0m19:24:29.757714 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_film"
[0m19:24:29.760712 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.763228 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.778249 [debug] [MainThread]: source_model: stg_raw_film_actor
[0m19:24:29.779758 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_film_actor
[0m19:24:29.779758 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_film_actor"
[0m19:24:29.782769 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.785770 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.788769 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.790770 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.802298 [debug] [MainThread]: source_model: stg_raw_film_category
[0m19:24:29.803298 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_film_category
[0m19:24:29.803298 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_film_category"
[0m19:24:29.807297 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.809298 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.820826 [debug] [MainThread]: source_model: stg_raw_inventory
[0m19:24:29.820826 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_inventory
[0m19:24:29.820826 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_inventory"
[0m19:24:29.824826 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.826826 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.828826 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.831350 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.834359 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.846360 [debug] [MainThread]: source_model: stg_raw_language
[0m19:24:29.846360 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_language
[0m19:24:29.847864 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_language"
[0m19:24:29.850906 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.861011 [debug] [MainThread]: source_model: stg_raw_payment
[0m19:24:29.862011 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_payment
[0m19:24:29.862011 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_payment"
[0m19:24:29.866229 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.869230 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.871230 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.873227 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.883857 [debug] [MainThread]: source_model: stg_raw_rental
[0m19:24:29.884858 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_rental
[0m19:24:29.884858 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_rental"
[0m19:24:29.887857 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.889857 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.891857 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.894840 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.897416 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.900459 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.903463 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.952478 [debug] [MainThread]: source_model: stg_raw_staff
[0m19:24:29.953477 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_staff
[0m19:24:29.953477 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_staff"
[0m19:24:29.956472 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.958480 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.961472 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.965058 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.967059 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.970059 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.972058 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.974645 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.987172 [debug] [MainThread]: source_model: stg_raw_store
[0m19:24:29.987172 [debug] [MainThread]: source_model is not mapping and not none: stg_raw_store
[0m19:24:29.988175 [debug] [MainThread]: source_relation: "sakila_db"."public"."stg_dv_store"
[0m19:24:29.991173 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.993173 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.995173 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:29.997703 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:30.000747 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:30.002747 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:30.005739 [debug] [MainThread]: hash type in hash macro: VARCHAR
[0m19:24:30.334648 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `public` in file
`models\stg_raw\sakila_source.yml`. The `freshness` top-level property should be
moved into the `config` of `public`.
[0m19:24:30.334648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967F3C4D0>]}
[0m19:24:30.487532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967DDF380>]}
[0m19:24:30.650383 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\target\manifest.json
[0m19:24:30.700124 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\target\semantic_manifest.json
[0m19:24:30.845057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002296813F4A0>]}
[0m19:24:30.846021 [info ] [MainThread]: Found 32 models, 4 data tests, 15 sources, 859 macros
[0m19:24:30.917933 [info ] [MainThread]: 
[0m19:24:30.917933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:30.918936 [info ] [MainThread]: 
[0m19:24:30.918936 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:30.923980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m19:24:33.253496 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m19:24:33.254495 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m19:24:33.254495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:33.298003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m19:24:33.299010 [debug] [ThreadPool]: On list_sakila_db: Close
[0m19:24:33.303046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m19:24:33.309037 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m19:24:33.310034 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m19:24:33.310034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:33.421440 [debug] [ThreadPool]: SQL status: BEGIN in 0.110 seconds
[0m19:24:33.421440 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m19:24:33.421440 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:24:33.461243 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.040 seconds
[0m19:24:33.465863 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m19:24:33.466863 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m19:24:33.488512 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:33.489513 [debug] [MainThread]: On master: BEGIN
[0m19:24:33.489513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:33.533034 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m19:24:33.533034 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:33.533996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:33.572964 [debug] [MainThread]: SQL status: SELECT 63 in 0.038 seconds
[0m19:24:33.585586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002296801C440>]}
[0m19:24:33.586587 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:33.586587 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:33.587586 [debug] [MainThread]: On master: BEGIN
[0m19:24:33.587586 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:24:33.588587 [debug] [MainThread]: On master: COMMIT
[0m19:24:33.588587 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:33.588587 [debug] [MainThread]: On master: COMMIT
[0m19:24:33.589674 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:24:33.589674 [debug] [MainThread]: On master: Close
[0m19:24:33.596746 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m19:24:33.596746 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_dv_actor ............................... [RUN]
[0m19:24:33.597789 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m19:24:33.597789 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m19:24:33.607833 [debug] [Thread-1 (]: source_model: stg_raw_actor
[0m19:24:33.607833 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_actor
[0m19:24:33.620115 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:33.621114 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m19:24:33.621114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:33.665168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:24:33.665168 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:33.665168 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_actor'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:33.795087 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.129 seconds
[0m19:24:33.800439 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_actor"
[0m19:24:33.804399 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:33.804399 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_actor'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:33.808434 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m19:24:33.815028 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:33.816028 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:33.853218 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:33.864574 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m19:24:33.894795 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:33.900497 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:33.900497 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        actor_id,
        first_name,
        last_name,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_actor"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        actor_id,
        first_name,
        last_name,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        actor_id,
        first_name,
        last_name,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(actor_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_actor_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(first_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^'))), '00000000000000000000000000000000') AS hd_actor_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as actor_id
        , '(unknown)' as first_name
        , '(unknown)' as last_name
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_actor_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_actor_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as actor_id
        , '(error)' as first_name
        , '(error)' as last_name
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_actor_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_actor_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        actor_id,
        first_name,
        last_name,
        last_update,
        hk_actor_h,
        hd_actor_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        actor_id,
        first_name,
        last_name,
        last_update,
        hk_actor_h,
        hd_actor_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:34.130790 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.229 seconds
[0m19:24:34.139835 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:34.139835 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor" rename to "stg_dv_actor__dbt_backup"
[0m19:24:34.162728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m19:24:34.166276 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:34.166276 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor__dbt_tmp" rename to "stg_dv_actor"
[0m19:24:34.168817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:24:34.183422 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m19:24:34.183422 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:34.184422 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m19:24:34.188099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:24:34.194105 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_actor__dbt_backup"
[0m19:24:34.197616 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:24:34.198622 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
drop view if exists "sakila_db"."public"."stg_dv_actor__dbt_backup" cascade
[0m19:24:34.235655 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m19:24:34.237662 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m19:24:34.240666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022963736DB0>]}
[0m19:24:34.240666 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_dv_actor .......................... [[32mCREATE VIEW[0m in 0.64s]
[0m19:24:34.241700 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m19:24:34.242699 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_address
[0m19:24:34.242699 [info ] [Thread-1 (]: 2 of 15 START sql view model public.stg_dv_address ............................. [RUN]
[0m19:24:34.243698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_actor, now model.datavault_postgres_test.stg_dv_address)
[0m19:24:34.243698 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_address
[0m19:24:34.249179 [debug] [Thread-1 (]: source_model: stg_raw_address
[0m19:24:34.249179 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_address
[0m19:24:34.251179 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.252179 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: BEGIN
[0m19:24:34.252179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:34.300267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:24:34.300267 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.301269 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_address'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.319141 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.017 seconds
[0m19:24:34.321181 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_address"
[0m19:24:34.325180 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.326179 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_address'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.328141 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m19:24:34.335731 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.336730 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.354323 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.357624 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_address
[0m19:24:34.361631 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.363136 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.363136 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */

  create view "sakila_db"."public"."stg_dv_address__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        address_id,
        address,
        address2,
        district,
        city_id,
        postal_code,
        phone,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_address"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        address_id,
        address,
        address2,
        district,
        city_id,
        postal_code,
        phone,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        address_id,
        address,
        address2,
        district,
        city_id,
        postal_code,
        phone,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_address_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address2 AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(district AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(city_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(postal_code AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(phone AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hd_address_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as address_id
        , '(unknown)' as address
        , '(unknown)' as address2
        , '(unknown)' as district
        , CAST(-1 as INTEGER) as city_id
        , '(unknown)' as postal_code
        , '(unknown)' as phone
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_address_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_address_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as address_id
        , '(error)' as address
        , '(error)' as address2
        , '(error)' as district
        , CAST(-2 as INTEGER) as city_id
        , '(error)' as postal_code
        , '(error)' as phone
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_address_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_address_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        address_id,
        address,
        address2,
        district,
        city_id,
        postal_code,
        phone,
        last_update,
        hk_address_h,
        hd_address_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        address_id,
        address,
        address2,
        district,
        city_id,
        postal_code,
        phone,
        last_update,
        hk_address_h,
        hd_address_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:34.371226 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:24:34.374189 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.375189 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */
alter table "sakila_db"."public"."stg_dv_address" rename to "stg_dv_address__dbt_backup"
[0m19:24:34.377055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:24:34.380610 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.381653 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */
alter table "sakila_db"."public"."stg_dv_address__dbt_tmp" rename to "stg_dv_address"
[0m19:24:34.382659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.383652 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: COMMIT
[0m19:24:34.384655 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.384655 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: COMMIT
[0m19:24:34.386617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:24:34.389656 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_address__dbt_backup"
[0m19:24:34.389656 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_address"
[0m19:24:34.390652 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_address"} */
drop view if exists "sakila_db"."public"."stg_dv_address__dbt_backup" cascade
[0m19:24:34.392695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:24:34.394656 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_address: Close
[0m19:24:34.394656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002296899E600>]}
[0m19:24:34.396163 [info ] [Thread-1 (]: 2 of 15 OK created sql view model public.stg_dv_address ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m19:24:34.397170 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_address
[0m19:24:34.397170 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_category
[0m19:24:34.398170 [info ] [Thread-1 (]: 3 of 15 START sql view model public.stg_dv_category ............................ [RUN]
[0m19:24:34.398170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_address, now model.datavault_postgres_test.stg_dv_category)
[0m19:24:34.399170 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_category
[0m19:24:34.404792 [debug] [Thread-1 (]: source_model: stg_raw_category
[0m19:24:34.405791 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_category
[0m19:24:34.407791 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.407791 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: BEGIN
[0m19:24:34.408792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:34.460348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m19:24:34.460348 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.460348 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_category'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.477195 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m19:24:34.478192 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_category"
[0m19:24:34.481763 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.482771 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_category'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.485769 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m19:24:34.489758 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.498395 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.500403 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_category
[0m19:24:34.505485 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.506482 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.507485 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */

  create view "sakila_db"."public"."stg_dv_category__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        category_id,
        name,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_category"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        category_id,
        name,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        category_id,
        name,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hd_category_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as category_id
        , '(unknown)' as name
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_category_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as category_id
        , '(error)' as name
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_category_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        category_id,
        name,
        last_update,
        hd_category_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        category_id,
        name,
        last_update,
        hd_category_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:34.512864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:24:34.517035 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.517035 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */
alter table "sakila_db"."public"."stg_dv_category" rename to "stg_dv_category__dbt_backup"
[0m19:24:34.519001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.521035 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.522038 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */
alter table "sakila_db"."public"."stg_dv_category__dbt_tmp" rename to "stg_dv_category"
[0m19:24:34.522999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.524036 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: COMMIT
[0m19:24:34.524036 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.525037 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: COMMIT
[0m19:24:34.526815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:34.529400 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_category__dbt_backup"
[0m19:24:34.529400 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_category"
[0m19:24:34.529400 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_category"} */
drop view if exists "sakila_db"."public"."stg_dv_category__dbt_backup" cascade
[0m19:24:34.531449 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:24:34.533450 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_category: Close
[0m19:24:34.533450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967EC4260>]}
[0m19:24:34.534450 [info ] [Thread-1 (]: 3 of 15 OK created sql view model public.stg_dv_category ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:24:34.535449 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_category
[0m19:24:34.535449 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_city
[0m19:24:34.536455 [info ] [Thread-1 (]: 4 of 15 START sql view model public.stg_dv_city ................................ [RUN]
[0m19:24:34.537450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_category, now model.datavault_postgres_test.stg_dv_city)
[0m19:24:34.537450 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_city
[0m19:24:34.542449 [debug] [Thread-1 (]: source_model: stg_raw_city
[0m19:24:34.543449 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_city
[0m19:24:34.546449 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.546449 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: BEGIN
[0m19:24:34.546953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:34.596060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m19:24:34.597199 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.597199 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_city'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.612969 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.016 seconds
[0m19:24:34.615119 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_city"
[0m19:24:34.618120 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.618120 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_city'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.621092 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m19:24:34.627092 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.637720 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.639420 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_city
[0m19:24:34.643432 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.644467 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.644467 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */

  create view "sakila_db"."public"."stg_dv_city__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        city_id,
        city,
        country_id,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_city"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        city_id,
        city,
        country_id,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        city_id,
        city,
        country_id,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(city AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(country_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^'))), '00000000000000000000000000000000') AS hd_city_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as city_id
        , '(unknown)' as city
        , CAST(-1 as INTEGER) as country_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_city_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as city_id
        , '(error)' as city
        , CAST(-2 as INTEGER) as country_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_city_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        city_id,
        city,
        country_id,
        last_update,
        hd_city_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        city_id,
        city,
        country_id,
        last_update,
        hd_city_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:34.652071 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:24:34.655071 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.656070 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
alter table "sakila_db"."public"."stg_dv_city" rename to "stg_dv_city__dbt_backup"
[0m19:24:34.657074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.660075 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.660075 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
alter table "sakila_db"."public"."stg_dv_city__dbt_tmp" rename to "stg_dv_city"
[0m19:24:34.661071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.663071 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: COMMIT
[0m19:24:34.663582 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.663582 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: COMMIT
[0m19:24:34.665283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:34.667326 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_city__dbt_backup"
[0m19:24:34.668326 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_city"
[0m19:24:34.668326 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_city"} */
drop view if exists "sakila_db"."public"."stg_dv_city__dbt_backup" cascade
[0m19:24:34.670296 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:24:34.674308 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_city: Close
[0m19:24:34.674308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967EC4260>]}
[0m19:24:34.675307 [info ] [Thread-1 (]: 4 of 15 OK created sql view model public.stg_dv_city ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:24:34.677302 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_city
[0m19:24:34.677302 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_country
[0m19:24:34.678309 [info ] [Thread-1 (]: 5 of 15 START sql view model public.stg_dv_country ............................. [RUN]
[0m19:24:34.679335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_city, now model.datavault_postgres_test.stg_dv_country)
[0m19:24:34.679335 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_country
[0m19:24:34.685504 [debug] [Thread-1 (]: source_model: stg_raw_country
[0m19:24:34.685504 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_country
[0m19:24:34.687503 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.688468 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: BEGIN
[0m19:24:34.688468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:34.736609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:24:34.736609 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.737645 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_country'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.754263 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m19:24:34.755264 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_country"
[0m19:24:34.759262 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.760410 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_country'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.763970 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m19:24:34.768975 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.778001 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.778001 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_country
[0m19:24:34.784549 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.785522 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.785522 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */

  create view "sakila_db"."public"."stg_dv_country__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        country_id,
        country,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_country"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        country_id,
        country,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        country_id,
        country,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(country AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hd_country_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as country_id
        , '(unknown)' as country
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_country_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as country_id
        , '(error)' as country
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_country_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        country_id,
        country,
        last_update,
        hd_country_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        country_id,
        country,
        last_update,
        hd_country_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:34.791142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:24:34.795185 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.796186 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */
alter table "sakila_db"."public"."stg_dv_country" rename to "stg_dv_country__dbt_backup"
[0m19:24:34.797293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.800326 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.800326 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */
alter table "sakila_db"."public"."stg_dv_country__dbt_tmp" rename to "stg_dv_country"
[0m19:24:34.803346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:24:34.805326 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: COMMIT
[0m19:24:34.805326 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.805326 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: COMMIT
[0m19:24:34.807298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:34.809335 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_country__dbt_backup"
[0m19:24:34.810336 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_country"
[0m19:24:34.810336 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_country"} */
drop view if exists "sakila_db"."public"."stg_dv_country__dbt_backup" cascade
[0m19:24:34.811298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:24:34.813846 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_country: Close
[0m19:24:34.814851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967ED32F0>]}
[0m19:24:34.814851 [info ] [Thread-1 (]: 5 of 15 OK created sql view model public.stg_dv_country ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m19:24:34.816851 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_country
[0m19:24:34.816851 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_customer
[0m19:24:34.817894 [info ] [Thread-1 (]: 6 of 15 START sql view model public.stg_dv_customer ............................ [RUN]
[0m19:24:34.817894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_country, now model.datavault_postgres_test.stg_dv_customer)
[0m19:24:34.818851 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_customer
[0m19:24:34.823851 [debug] [Thread-1 (]: source_model: stg_raw_customer
[0m19:24:34.823851 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_customer
[0m19:24:34.825888 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.826889 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: BEGIN
[0m19:24:34.826889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:34.873450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:24:34.873450 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.874492 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_customer'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.890957 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.016 seconds
[0m19:24:34.892935 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_customer"
[0m19:24:34.896476 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.897481 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_customer'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:34.900487 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.003 seconds
[0m19:24:34.909489 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.911522 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.913063 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.916115 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.917150 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.919149 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:34.941298 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.943261 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_customer
[0m19:24:34.947356 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.948401 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.949364 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_customer"} */

  create view "sakila_db"."public"."stg_dv_customer__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        customer_id,
        store_id,
        first_name,
        last_name,
        email,
        address_id,
        activebool,
        create_date,
        last_update,
        active,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_customer"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        customer_id,
        store_id,
        first_name,
        last_name,
        email,
        address_id,
        activebool,
        create_date,
        last_update,
        active
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        customer_id,
        store_id,
        first_name,
        last_name,
        email,
        address_id,
        activebool,
        create_date,
        last_update,
        active,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(customer_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_customer_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(first_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(email AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^'))), '00000000000000000000000000000000') AS hd_customer_p_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(activebool AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(create_date AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(active AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hd_customer_n_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_address_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_store_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(customer_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^'))), '00000000000000000000000000000000') AS hk_customer_store_address_l

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as customer_id
        , CAST(-1 as INTEGER) as store_id
        , '(unknown)' as first_name
        , '(unknown)' as last_name
        , '(unknown)' as email
        , CAST(-1 as INTEGER) as address_id
        , CAST('FALSE' as BOOLEAN) as activebool
        ,TO_DATE('0001-01-01', 'YYYY-MM-DD' ) as create_date
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        , CAST(-1 as INTEGER) as active
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_customer_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_customer_p_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_customer_n_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_address_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_store_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_customer_store_address_l
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as customer_id
        , CAST(-2 as INTEGER) as store_id
        , '(error)' as first_name
        , '(error)' as last_name
        , '(error)' as email
        , CAST(-2 as INTEGER) as address_id
        , CAST('FALSE' as BOOLEAN) as activebool
        ,TO_DATE('8888-12-31', 'YYYY-MM-DD' ) as create_date
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        , CAST(-2 as INTEGER) as active
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_customer_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_customer_p_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_customer_n_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_address_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_store_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_customer_store_address_l
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        customer_id,
        store_id,
        first_name,
        last_name,
        email,
        address_id,
        activebool,
        create_date,
        last_update,
        active,
        hk_customer_h,
        hd_customer_p_s,
        hd_customer_n_s,
        hk_address_h,
        hk_store_h,
        hk_customer_store_address_l

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        customer_id,
        store_id,
        first_name,
        last_name,
        email,
        address_id,
        activebool,
        create_date,
        last_update,
        active,
        hk_customer_h,
        hd_customer_p_s,
        hd_customer_n_s,
        hk_address_h,
        hk_store_h,
        hk_customer_store_address_l

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:34.969961 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m19:24:34.972961 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.973990 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_customer"} */
alter table "sakila_db"."public"."stg_dv_customer__dbt_tmp" rename to "stg_dv_customer"
[0m19:24:34.974961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:34.977003 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: COMMIT
[0m19:24:34.977003 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.977003 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: COMMIT
[0m19:24:34.979504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:34.982536 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_customer__dbt_backup"
[0m19:24:34.982536 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_customer"
[0m19:24:34.983562 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_customer"} */
drop view if exists "sakila_db"."public"."stg_dv_customer__dbt_backup" cascade
[0m19:24:34.984395 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:24:34.985437 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_customer: Close
[0m19:24:34.986401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229689B4110>]}
[0m19:24:34.987401 [info ] [Thread-1 (]: 6 of 15 OK created sql view model public.stg_dv_customer ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m19:24:34.987401 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_customer
[0m19:24:34.988403 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_film
[0m19:24:34.989441 [info ] [Thread-1 (]: 7 of 15 START sql view model public.stg_dv_film ................................ [RUN]
[0m19:24:34.989441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_customer, now model.datavault_postgres_test.stg_dv_film)
[0m19:24:34.990401 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_film
[0m19:24:34.995439 [debug] [Thread-1 (]: source_model: stg_raw_film
[0m19:24:34.995439 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_film
[0m19:24:34.997578 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:24:34.998620 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: BEGIN
[0m19:24:34.998620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:35.044698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:24:35.044698 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:24:35.046204 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.065760 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.019 seconds
[0m19:24:35.069754 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_film"
[0m19:24:35.075754 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:24:35.076756 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.082185 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.005 seconds
[0m19:24:35.091182 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.093182 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.125316 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_film"
[0m19:24:35.147491 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_film
[0m19:24:35.152295 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_film"
[0m19:24:35.153462 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:24:35.154603 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film"} */

  create view "sakila_db"."public"."stg_dv_film__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_film"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_film_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(title AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(description AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(release_year AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(language_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(original_language_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_duration AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_rate AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(length AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(replacement_cost AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rating AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(special_features AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(fulltext AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^||^^||^^||^^||^^||^^||^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hd_film_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as film_id
        , '(unknown)' as title
        , '(unknown)' as description
        , CAST(-1 as INTEGER) as release_year
        , CAST(-1 as INTEGER) as language_id
        , CAST(-1 as INTEGER) as original_language_id
        , CAST(-1 as SMALLINT) as rental_duration
        , CAST(-1 as NUMERIC) as rental_rate
        , CAST(-1 as SMALLINT) as length
        , CAST(-1 as NUMERIC) as replacement_cost
        , CAST(NULL as USER-DEFINED) as rating
        
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        , CAST(NULL as ARRAY) as special_features
        
        , CAST(NULL as TSVECTOR) as fulltext
        
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_film_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_film_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as film_id
        , '(error)' as title
        , '(error)' as description
        , CAST(-2 as INTEGER) as release_year
        , CAST(-2 as INTEGER) as language_id
        , CAST(-2 as INTEGER) as original_language_id
        , CAST(-2 as SMALLINT) as rental_duration
        , CAST(-2 as NUMERIC) as rental_rate
        , CAST(-2 as SMALLINT) as length
        , CAST(-2 as NUMERIC) as replacement_cost
        , CAST(NULL as USER-DEFINED) as rating
        
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        , CAST(NULL as ARRAY) as special_features
        
        , CAST(NULL as TSVECTOR) as fulltext
        
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_film_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_film_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
        hk_film_h,
        hd_film_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
        hk_film_h,
        hd_film_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:35.214612 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Syntaxfehler bei Â»USERÂ«
LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                 ^

[0m19:24:35.215701 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: ROLLBACK
[0m19:24:35.218682 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: Close
[0m19:24:35.336042 [debug] [Thread-1 (]: Database Error in model stg_dv_film (models\stg_dv\stg_dv_film.sql)
  FEHLER:  Syntaxfehler bei Â»USERÂ«
  LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_film.sql
[0m19:24:35.337041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022968A945F0>]}
[0m19:24:35.337041 [error] [Thread-1 (]: 7 of 15 ERROR creating sql view model public.stg_dv_film ....................... [[31mERROR[0m in 0.35s]
[0m19:24:35.337918 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_film
[0m19:24:35.337918 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_film_actor
[0m19:24:35.338963 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_film' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_film (models\stg_dv\stg_dv_film.sql)
  FEHLER:  Syntaxfehler bei Â»USERÂ«
  LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_film.sql.
[0m19:24:35.338963 [info ] [Thread-1 (]: 8 of 15 START sql view model public.stg_dv_film_actor .......................... [RUN]
[0m19:24:35.339960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_film, now model.datavault_postgres_test.stg_dv_film_actor)
[0m19:24:35.340960 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_film_actor
[0m19:24:35.346450 [debug] [Thread-1 (]: source_model: stg_raw_film_actor
[0m19:24:35.346450 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_film_actor
[0m19:24:35.349464 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.350463 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: BEGIN
[0m19:24:35.350463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:35.397220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:24:35.398226 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.398226 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_actor"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film_actor'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.413736 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.015 seconds
[0m19:24:35.415753 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_film_actor"
[0m19:24:35.464819 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.464819 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_actor"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film_actor'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.468818 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m19:24:35.474392 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.476396 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.477392 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.479365 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.488445 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.489446 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_film_actor
[0m19:24:35.493409 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.494409 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.495410 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_actor"} */

  create view "sakila_db"."public"."stg_dv_film_actor__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        actor_id,
        film_id,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_film_actor"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        actor_id,
        film_id,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        actor_id,
        film_id,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(actor_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hk_film_actor_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hd_film_actor_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(actor_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_actor_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_film_h

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as actor_id
        , CAST(-1 as INTEGER) as film_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_film_actor_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_film_actor_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_actor_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_film_h
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as actor_id
        , CAST(-2 as INTEGER) as film_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_film_actor_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_film_actor_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_actor_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_film_h
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        actor_id,
        film_id,
        last_update,
        hk_film_actor_l,
        hd_film_actor_s,
        hk_actor_h,
        hk_film_h

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        actor_id,
        film_id,
        last_update,
        hk_film_actor_l,
        hd_film_actor_s,
        hk_actor_h,
        hk_film_h

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:35.503653 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:24:35.506665 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.507668 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_actor"} */
alter table "sakila_db"."public"."stg_dv_film_actor__dbt_tmp" rename to "stg_dv_film_actor"
[0m19:24:35.508665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:35.509668 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: COMMIT
[0m19:24:35.510665 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.510665 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: COMMIT
[0m19:24:35.512639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:35.516766 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_film_actor__dbt_backup"
[0m19:24:35.516766 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_actor"
[0m19:24:35.517752 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_actor"} */
drop view if exists "sakila_db"."public"."stg_dv_film_actor__dbt_backup" cascade
[0m19:24:35.517752 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:35.519749 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_actor: Close
[0m19:24:35.519749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022968B1DBE0>]}
[0m19:24:35.520754 [info ] [Thread-1 (]: 8 of 15 OK created sql view model public.stg_dv_film_actor ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m19:24:35.521765 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_film_actor
[0m19:24:35.521765 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_film_category
[0m19:24:35.522753 [info ] [Thread-1 (]: 9 of 15 START sql view model public.stg_dv_film_category ....................... [RUN]
[0m19:24:35.523752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_film_actor, now model.datavault_postgres_test.stg_dv_film_category)
[0m19:24:35.523752 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_film_category
[0m19:24:35.529751 [debug] [Thread-1 (]: source_model: stg_raw_film_category
[0m19:24:35.530979 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_film_category
[0m19:24:35.533984 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.533984 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: BEGIN
[0m19:24:35.533984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:35.579527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m19:24:35.580536 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.580536 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_category"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film_category'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.597095 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m19:24:35.599100 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_film_category"
[0m19:24:35.602127 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.602127 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_category"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film_category'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.605126 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m19:24:35.612128 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.613666 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.621697 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.623675 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_film_category
[0m19:24:35.628669 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.630175 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.631184 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_category"} */

  create view "sakila_db"."public"."stg_dv_film_category__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        film_id,
        category_id,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_film_category"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        film_id,
        category_id,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        film_id,
        category_id,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(category_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hd_film_category_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_film_h

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as film_id
        , CAST(-1 as INTEGER) as category_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_film_category_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_film_h
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as film_id
        , CAST(-2 as INTEGER) as category_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_film_category_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_film_h
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        film_id,
        category_id,
        last_update,
        hd_film_category_s,
        hk_film_h

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        film_id,
        category_id,
        last_update,
        hd_film_category_s,
        hk_film_h

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:35.638227 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:24:35.642226 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.643226 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_category"} */
alter table "sakila_db"."public"."stg_dv_film_category__dbt_tmp" rename to "stg_dv_film_category"
[0m19:24:35.644227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:35.645227 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: COMMIT
[0m19:24:35.645227 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.646217 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: COMMIT
[0m19:24:35.648420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:35.651452 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_film_category__dbt_backup"
[0m19:24:35.652443 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film_category"
[0m19:24:35.652443 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film_category"} */
drop view if exists "sakila_db"."public"."stg_dv_film_category__dbt_backup" cascade
[0m19:24:35.653447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:35.654447 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film_category: Close
[0m19:24:35.655421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229689C0B90>]}
[0m19:24:35.656425 [info ] [Thread-1 (]: 9 of 15 OK created sql view model public.stg_dv_film_category .................. [[32mCREATE VIEW[0m in 0.13s]
[0m19:24:35.657421 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_film_category
[0m19:24:35.658422 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_inventory
[0m19:24:35.658422 [info ] [Thread-1 (]: 10 of 15 START sql view model public.stg_dv_inventory .......................... [RUN]
[0m19:24:35.659457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_film_category, now model.datavault_postgres_test.stg_dv_inventory)
[0m19:24:35.659457 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_inventory
[0m19:24:35.666008 [debug] [Thread-1 (]: source_model: stg_raw_inventory
[0m19:24:35.666008 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_inventory
[0m19:24:35.669006 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.669982 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: BEGIN
[0m19:24:35.669982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:35.718904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:24:35.718904 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.718904 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.735442 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.016 seconds
[0m19:24:35.737440 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_inventory"
[0m19:24:35.740442 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.740442 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.743441 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m19:24:35.749052 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.751047 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.752046 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.754051 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.756047 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.768157 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.769160 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_inventory
[0m19:24:35.773157 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.773157 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.774121 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_inventory"} */

  create view "sakila_db"."public"."stg_dv_inventory__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        inventory_id,
        film_id,
        store_id,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_inventory"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        inventory_id,
        film_id,
        store_id,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        inventory_id,
        film_id,
        store_id,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(inventory_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_inventory_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_film_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_store_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(inventory_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^'))), '00000000000000000000000000000000') AS hk_inventory_film_store_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hd_inventory_film_store_es

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as inventory_id
        , CAST(-1 as INTEGER) as film_id
        , CAST(-1 as INTEGER) as store_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_inventory_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_film_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_store_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_inventory_film_store_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_inventory_film_store_es
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as inventory_id
        , CAST(-2 as INTEGER) as film_id
        , CAST(-2 as INTEGER) as store_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_inventory_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_film_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_store_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_inventory_film_store_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_inventory_film_store_es
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        inventory_id,
        film_id,
        store_id,
        last_update,
        hk_inventory_h,
        hk_film_h,
        hk_store_h,
        hk_inventory_film_store_l,
        hd_inventory_film_store_es

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        inventory_id,
        film_id,
        store_id,
        last_update,
        hk_inventory_h,
        hk_film_h,
        hk_store_h,
        hk_inventory_film_store_l,
        hd_inventory_film_store_es

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:35.782697 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:24:35.786709 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.786709 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_inventory"} */
alter table "sakila_db"."public"."stg_dv_inventory__dbt_tmp" rename to "stg_dv_inventory"
[0m19:24:35.787672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:35.788709 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: COMMIT
[0m19:24:35.789708 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.789708 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: COMMIT
[0m19:24:35.791711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:35.793744 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_inventory__dbt_backup"
[0m19:24:35.794717 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_inventory"
[0m19:24:35.794717 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_inventory"} */
drop view if exists "sakila_db"."public"."stg_dv_inventory__dbt_backup" cascade
[0m19:24:35.794717 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:35.797302 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_inventory: Close
[0m19:24:35.797302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229685B6B70>]}
[0m19:24:35.798307 [info ] [Thread-1 (]: 10 of 15 OK created sql view model public.stg_dv_inventory ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:24:35.799307 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_inventory
[0m19:24:35.799307 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_language
[0m19:24:35.800309 [info ] [Thread-1 (]: 11 of 15 START sql view model public.stg_dv_language ........................... [RUN]
[0m19:24:35.800309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_inventory, now model.datavault_postgres_test.stg_dv_language)
[0m19:24:35.801309 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_language
[0m19:24:35.806342 [debug] [Thread-1 (]: source_model: stg_raw_language
[0m19:24:35.807342 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_language
[0m19:24:35.809342 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.810318 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: BEGIN
[0m19:24:35.810318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:35.857484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:24:35.858482 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.858482 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_language"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_language'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.874000 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.015 seconds
[0m19:24:35.874997 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_language"
[0m19:24:35.878000 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.878000 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_language"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_language'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:35.882566 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m19:24:35.887567 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:35.896111 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.898124 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_language
[0m19:24:35.901164 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.902164 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.903161 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_language"} */

  create view "sakila_db"."public"."stg_dv_language__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        language_id,
        name,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_language"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        language_id,
        name,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        language_id,
        name,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hd_language_rs

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as language_id
        , '(unknown)' as name
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_language_rs
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as language_id
        , '(error)' as name
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_language_rs
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        language_id,
        name,
        last_update,
        hd_language_rs

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        language_id,
        name,
        last_update,
        hd_language_rs

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:35.908776 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:24:35.912812 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.912812 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_language"} */
alter table "sakila_db"."public"."stg_dv_language__dbt_tmp" rename to "stg_dv_language"
[0m19:24:35.913993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:35.914998 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: COMMIT
[0m19:24:35.916036 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.916036 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: COMMIT
[0m19:24:35.918036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:35.920040 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_language__dbt_backup"
[0m19:24:35.921034 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_language"
[0m19:24:35.922039 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_language"} */
drop view if exists "sakila_db"."public"."stg_dv_language__dbt_backup" cascade
[0m19:24:35.922039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:35.923035 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_language: Close
[0m19:24:35.924036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229684E1160>]}
[0m19:24:35.924999 [info ] [Thread-1 (]: 11 of 15 OK created sql view model public.stg_dv_language ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:24:35.926014 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_language
[0m19:24:35.926014 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_payment
[0m19:24:35.927018 [info ] [Thread-1 (]: 12 of 15 START sql view model public.stg_dv_payment ............................ [RUN]
[0m19:24:35.927018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_language, now model.datavault_postgres_test.stg_dv_payment)
[0m19:24:35.927997 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_payment
[0m19:24:35.932553 [debug] [Thread-1 (]: source_model: stg_raw_payment
[0m19:24:35.933550 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_payment
[0m19:24:35.935515 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:35.936513 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: BEGIN
[0m19:24:35.936513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:35.983716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:24:35.983716 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:35.984715 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_payment"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_payment'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.001204 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.016 seconds
[0m19:24:36.002736 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_payment"
[0m19:24:36.006738 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.007776 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_payment"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_payment'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.010832 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m19:24:36.017366 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.019365 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.021365 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.022365 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.036889 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.037889 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_payment
[0m19:24:36.041890 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.041890 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.042890 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_payment"} */

  create view "sakila_db"."public"."stg_dv_payment__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        payment_id,
        customer_id,
        staff_id,
        rental_id,
        amount,
        payment_date,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_payment"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        payment_id,
        customer_id,
        staff_id,
        rental_id,
        amount,
        payment_date
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        payment_id,
        customer_id,
        staff_id,
        rental_id,
        amount,
        payment_date,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(payment_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(customer_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hk_payment_nhl,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(customer_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_customer_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_staff_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_rental_h

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as payment_id
        , CAST(-1 as INTEGER) as customer_id
        , CAST(-1 as INTEGER) as staff_id
        , CAST(-1 as INTEGER) as rental_id
        , CAST(-1 as NUMERIC) as amount
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS payment_date
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_payment_nhl
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_customer_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_staff_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_rental_h
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as payment_id
        , CAST(-2 as INTEGER) as customer_id
        , CAST(-2 as INTEGER) as staff_id
        , CAST(-2 as INTEGER) as rental_id
        , CAST(-2 as NUMERIC) as amount
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as payment_date
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_payment_nhl
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_customer_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_staff_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_rental_h
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        payment_id,
        customer_id,
        staff_id,
        rental_id,
        amount,
        payment_date,
        hk_payment_nhl,
        hk_customer_h,
        hk_staff_h,
        hk_rental_h

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        payment_id,
        customer_id,
        staff_id,
        rental_id,
        amount,
        payment_date,
        hk_payment_nhl,
        hk_customer_h,
        hk_staff_h,
        hk_rental_h

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:36.050515 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:24:36.054523 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.054523 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_payment"} */
alter table "sakila_db"."public"."stg_dv_payment__dbt_tmp" rename to "stg_dv_payment"
[0m19:24:36.055486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:36.057522 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: COMMIT
[0m19:24:36.057522 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.057522 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: COMMIT
[0m19:24:36.059509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:36.061515 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_payment__dbt_backup"
[0m19:24:36.061515 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_payment"
[0m19:24:36.063021 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_payment"} */
drop view if exists "sakila_db"."public"."stg_dv_payment__dbt_backup" cascade
[0m19:24:36.063753 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:36.064760 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_payment: Close
[0m19:24:36.065759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022967F6BFE0>]}
[0m19:24:36.065759 [info ] [Thread-1 (]: 12 of 15 OK created sql view model public.stg_dv_payment ....................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:24:36.066796 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_payment
[0m19:24:36.067760 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_rental
[0m19:24:36.067760 [info ] [Thread-1 (]: 13 of 15 START sql view model public.stg_dv_rental ............................. [RUN]
[0m19:24:36.068760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_payment, now model.datavault_postgres_test.stg_dv_rental)
[0m19:24:36.068760 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_rental
[0m19:24:36.073796 [debug] [Thread-1 (]: source_model: stg_raw_rental
[0m19:24:36.074800 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_rental
[0m19:24:36.080948 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.081957 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: BEGIN
[0m19:24:36.083991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:36.135511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m19:24:36.136517 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.136517 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_rental"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_rental'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.153106 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.016 seconds
[0m19:24:36.155145 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_rental"
[0m19:24:36.158144 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.158144 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_rental"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_rental'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.161107 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:24:36.167696 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.169660 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.170702 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.171697 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.173697 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.175697 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.177697 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.193977 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.196009 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_rental
[0m19:24:36.200231 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.201231 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.202232 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_rental"} */

  create view "sakila_db"."public"."stg_dv_rental__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        rental_id,
        rental_date,
        inventory_id,
        customer_id,
        return_date,
        staff_id,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_rental"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        rental_id,
        rental_date,
        inventory_id,
        customer_id,
        return_date,
        staff_id,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        rental_id,
        rental_date,
        inventory_id,
        customer_id,
        return_date,
        staff_id,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_rental_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(inventory_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_inventory_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(customer_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_customer_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_staff_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(inventory_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(customer_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hk_rental_inventory_customer_staff_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_date AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(return_date AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hd_rental_inventory_customer_staff_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hd_rental_inventory_customer_staff_es

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as rental_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS rental_date
        , CAST(-1 as INTEGER) as inventory_id
        , CAST(-1 as INTEGER) as customer_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS return_date
        , CAST(-1 as INTEGER) as staff_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_rental_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_inventory_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_customer_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_staff_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_rental_inventory_customer_staff_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_rental_inventory_customer_staff_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_rental_inventory_customer_staff_es
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as rental_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as rental_date
        , CAST(-2 as INTEGER) as inventory_id
        , CAST(-2 as INTEGER) as customer_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as return_date
        , CAST(-2 as INTEGER) as staff_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_rental_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_inventory_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_customer_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_staff_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_rental_inventory_customer_staff_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_rental_inventory_customer_staff_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_rental_inventory_customer_staff_es
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        rental_id,
        rental_date,
        inventory_id,
        customer_id,
        return_date,
        staff_id,
        last_update,
        hk_rental_h,
        hk_inventory_h,
        hk_customer_h,
        hk_staff_h,
        hk_rental_inventory_customer_staff_l,
        hd_rental_inventory_customer_staff_s,
        hd_rental_inventory_customer_staff_es

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        rental_id,
        rental_date,
        inventory_id,
        customer_id,
        return_date,
        staff_id,
        last_update,
        hk_rental_h,
        hk_inventory_h,
        hk_customer_h,
        hk_staff_h,
        hk_rental_inventory_customer_staff_l,
        hd_rental_inventory_customer_staff_s,
        hd_rental_inventory_customer_staff_es

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:36.211231 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:24:36.214870 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.214870 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_rental"} */
alter table "sakila_db"."public"."stg_dv_rental__dbt_tmp" rename to "stg_dv_rental"
[0m19:24:36.216826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:36.217864 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: COMMIT
[0m19:24:36.217864 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.218865 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: COMMIT
[0m19:24:36.219827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:36.222864 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_rental__dbt_backup"
[0m19:24:36.223869 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_rental"
[0m19:24:36.223869 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_rental"} */
drop view if exists "sakila_db"."public"."stg_dv_rental__dbt_backup" cascade
[0m19:24:36.224826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:36.225864 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_rental: Close
[0m19:24:36.225864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022968A16750>]}
[0m19:24:36.226826 [info ] [Thread-1 (]: 13 of 15 OK created sql view model public.stg_dv_rental ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m19:24:36.227826 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_rental
[0m19:24:36.227826 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_staff
[0m19:24:36.227826 [info ] [Thread-1 (]: 14 of 15 START sql view model public.stg_dv_staff .............................. [RUN]
[0m19:24:36.229332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_rental, now model.datavault_postgres_test.stg_dv_staff)
[0m19:24:36.230340 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_staff
[0m19:24:36.235382 [debug] [Thread-1 (]: source_model: stg_raw_staff
[0m19:24:36.236353 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_staff
[0m19:24:36.238381 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.238381 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: BEGIN
[0m19:24:36.239381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:36.286511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:24:36.286511 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.286511 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_staff"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_staff'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.304037 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.016 seconds
[0m19:24:36.305074 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_staff"
[0m19:24:36.309036 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.309036 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_staff"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_staff'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.312038 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m19:24:36.320511 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.321509 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.324509 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.327510 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.328512 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.330648 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.332654 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.333682 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.357737 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.358744 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_staff
[0m19:24:36.362781 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.363917 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.364924 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_staff"} */

  create view "sakila_db"."public"."stg_dv_staff__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        staff_id,
        first_name,
        last_name,
        address_id,
        email,
        store_id,
        active,
        username,
        password,
        last_update,
        picture,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_staff"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        staff_id,
        first_name,
        last_name,
        address_id,
        email,
        store_id,
        active,
        username,
        password,
        last_update,
        picture
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        staff_id,
        first_name,
        last_name,
        address_id,
        email,
        store_id,
        active,
        username,
        password,
        last_update,
        picture,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_staff_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(active AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hd_staff_n_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(first_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(email AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(username AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(password AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(picture AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hd_staff_p_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_address_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hk_staff_address_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_store_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hk_staff_store_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hd_staff_store_es

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as staff_id
        , '(unknown)' as first_name
        , '(unknown)' as last_name
        , CAST(-1 as INTEGER) as address_id
        , '(unknown)' as email
        , CAST(-1 as INTEGER) as store_id
        , CAST('FALSE' as BOOLEAN) as active
        , '(unknown)' as username
        , '(unknown)' as password
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        , CAST(NULL as BYTEA) as picture
        
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_staff_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_staff_n_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_staff_p_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_address_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_staff_address_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_store_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_staff_store_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_staff_store_es
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as staff_id
        , '(error)' as first_name
        , '(error)' as last_name
        , CAST(-2 as INTEGER) as address_id
        , '(error)' as email
        , CAST(-2 as INTEGER) as store_id
        , CAST('FALSE' as BOOLEAN) as active
        , '(error)' as username
        , '(error)' as password
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        , CAST(NULL as BYTEA) as picture
        
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_staff_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_staff_n_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_staff_p_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_address_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_staff_address_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_store_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_staff_store_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_staff_store_es
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        staff_id,
        first_name,
        last_name,
        address_id,
        email,
        store_id,
        active,
        username,
        password,
        last_update,
        picture,
        hk_staff_h,
        hd_staff_n_s,
        hd_staff_p_s,
        hk_address_h,
        hk_staff_address_l,
        hk_store_h,
        hk_staff_store_l,
        hd_staff_store_es

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        staff_id,
        first_name,
        last_name,
        address_id,
        email,
        store_id,
        active,
        username,
        password,
        last_update,
        picture,
        hk_staff_h,
        hd_staff_n_s,
        hd_staff_p_s,
        hk_address_h,
        hk_staff_address_l,
        hk_store_h,
        hk_staff_store_l,
        hd_staff_store_es

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:36.375789 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m19:24:36.379379 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.379379 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_staff"} */
alter table "sakila_db"."public"."stg_dv_staff__dbt_tmp" rename to "stg_dv_staff"
[0m19:24:36.381418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:36.382419 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: COMMIT
[0m19:24:36.383456 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.383456 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: COMMIT
[0m19:24:36.385440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:24:36.388418 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_staff__dbt_backup"
[0m19:24:36.389418 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_staff"
[0m19:24:36.389418 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_staff"} */
drop view if exists "sakila_db"."public"."stg_dv_staff__dbt_backup" cascade
[0m19:24:36.390418 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:36.391418 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_staff: Close
[0m19:24:36.392418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022968A10A10>]}
[0m19:24:36.392418 [info ] [Thread-1 (]: 14 of 15 OK created sql view model public.stg_dv_staff ......................... [[32mCREATE VIEW[0m in 0.16s]
[0m19:24:36.394420 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_staff
[0m19:24:36.394420 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_store
[0m19:24:36.395420 [info ] [Thread-1 (]: 15 of 15 START sql view model public.stg_dv_store .............................. [RUN]
[0m19:24:36.395420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datavault_postgres_test.stg_dv_staff, now model.datavault_postgres_test.stg_dv_store)
[0m19:24:36.396418 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_store
[0m19:24:36.401975 [debug] [Thread-1 (]: source_model: stg_raw_store
[0m19:24:36.402977 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_store
[0m19:24:36.404938 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.404938 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: BEGIN
[0m19:24:36.405940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:36.453186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:24:36.454222 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.454222 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_store"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_store'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.473001 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.018 seconds
[0m19:24:36.475012 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_store"
[0m19:24:36.477999 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.479531 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_store"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_store'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:24:36.483563 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m19:24:36.490544 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.491543 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.493543 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.494543 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.498075 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.500073 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.503115 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:24:36.517248 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.519248 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_store
[0m19:24:36.524249 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.525260 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.527253 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_store"} */

  create view "sakila_db"."public"."stg_dv_store__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        store_id,
        manager_staff_id,
        address_id,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_store"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        store_id,
        manager_staff_id,
        address_id,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        store_id,
        manager_staff_id,
        address_id,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_store_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hd_store_s,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_address_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(address_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hk_store_address_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(manager_staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_staff_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(store_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^'),'||',
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(manager_staff_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^'))), '00000000000000000000000000000000') AS hk_store_manager_staff_l,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hd_store_manager_staff_es

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as store_id
        , CAST(-1 as INTEGER) as manager_staff_id
        , CAST(-1 as INTEGER) as address_id
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_store_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_store_s
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_address_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_store_address_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_staff_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_store_manager_staff_l
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_store_manager_staff_es
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as store_id
        , CAST(-2 as INTEGER) as manager_staff_id
        , CAST(-2 as INTEGER) as address_id
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_store_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_store_s
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_address_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_store_address_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_staff_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_store_manager_staff_l
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_store_manager_staff_es
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        store_id,
        manager_staff_id,
        address_id,
        last_update,
        hk_store_h,
        hd_store_s,
        hk_address_h,
        hk_store_address_l,
        hk_staff_h,
        hk_store_manager_staff_l,
        hd_store_manager_staff_es

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        store_id,
        manager_staff_id,
        address_id,
        last_update,
        hk_store_h,
        hd_store_s,
        hk_address_h,
        hk_store_address_l,
        hk_staff_h,
        hk_store_manager_staff_l,
        hd_store_manager_staff_es

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:24:36.538311 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m19:24:36.542311 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.543313 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_store"} */
alter table "sakila_db"."public"."stg_dv_store__dbt_tmp" rename to "stg_dv_store"
[0m19:24:36.545309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:24:36.547572 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: COMMIT
[0m19:24:36.548615 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.548615 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: COMMIT
[0m19:24:36.550579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:36.554576 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_store__dbt_backup"
[0m19:24:36.555579 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_store"
[0m19:24:36.555579 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_store"} */
drop view if exists "sakila_db"."public"."stg_dv_store__dbt_backup" cascade
[0m19:24:36.556578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:36.558578 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_store: Close
[0m19:24:36.559581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40c715b-0263-419e-b75e-4c157b14f9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022968B419A0>]}
[0m19:24:36.560616 [info ] [Thread-1 (]: 15 of 15 OK created sql view model public.stg_dv_store ......................... [[32mCREATE VIEW[0m in 0.16s]
[0m19:24:36.560616 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_store
[0m19:24:36.563083 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:36.564096 [debug] [MainThread]: On master: BEGIN
[0m19:24:36.564096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:36.616786 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m19:24:36.617747 [debug] [MainThread]: On master: COMMIT
[0m19:24:36.617747 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:36.617747 [debug] [MainThread]: On master: COMMIT
[0m19:24:36.618752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:24:36.618752 [debug] [MainThread]: On master: Close
[0m19:24:36.619784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:36.620748 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m19:24:36.620748 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m19:24:36.620748 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_store' was properly closed.
[0m19:24:36.621749 [info ] [MainThread]: 
[0m19:24:36.622752 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m19:24:36.625788 [debug] [MainThread]: Command end result
[0m19:24:36.685047 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\target\manifest.json
[0m19:24:36.688043 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\target\semantic_manifest.json
[0m19:24:36.702307 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\target\run_results.json
[0m19:24:36.703305 [info ] [MainThread]: 
[0m19:24:36.703305 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:24:36.704215 [info ] [MainThread]: 
[0m19:24:36.704215 [error] [MainThread]: [31mFailure in model stg_dv_film (models\stg_dv\stg_dv_film.sql)[0m
[0m19:24:36.705258 [error] [MainThread]:   Database Error in model stg_dv_film (models\stg_dv\stg_dv_film.sql)
  FEHLER:  Syntaxfehler bei Â»USERÂ«
  LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_film.sql
[0m19:24:36.706224 [info ] [MainThread]: 
[0m19:24:36.706224 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_film.sql
[0m19:24:36.707224 [info ] [MainThread]: 
[0m19:24:36.708248 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m19:24:36.708248 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:24:36.709221 [debug] [MainThread]: Command `dbt build` failed at 19:24:36.709221 after 13.81 seconds
[0m19:24:36.710220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022965C85D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229665A4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229665A4320>]}
[0m19:24:36.710220 [debug] [MainThread]: Flushing usage events
[0m19:24:38.471382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:51.319330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E14F14C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E14F0BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E14B1A60>]}


============================== 19:25:51.323491 | 23e93776-7789-4bee-b390-5f2022e3face ==============================
[0m19:25:51.323491 [info ] [MainThread]: Running with dbt=1.10.1
[0m19:25:51.324491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_actor.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:25:51.324491 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m19:25:51.325491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DB669550>]}
[0m19:25:51.540567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E2B9BD10>]}
[0m19:25:51.608452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E10A27E0>]}
[0m19:25:51.609753 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:25:51.861018 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m19:25:52.088962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:52.088962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:52.135743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E2DD0680>]}
[0m19:25:52.248343 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\target\manifest.json
[0m19:25:52.264882 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\target\semantic_manifest.json
[0m19:25:52.315817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E2DEBD40>]}
[0m19:25:52.315817 [info ] [MainThread]: Found 32 models, 4 data tests, 15 sources, 859 macros
[0m19:25:52.322873 [info ] [MainThread]: 
[0m19:25:52.322873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:52.323868 [info ] [MainThread]: 
[0m19:25:52.324832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:52.325817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m19:25:52.439923 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m19:25:52.440957 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m19:25:52.440957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:52.490682 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m19:25:52.491682 [debug] [ThreadPool]: On list_sakila_db: Close
[0m19:25:52.497238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m19:25:52.503288 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m19:25:52.503288 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m19:25:52.504245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:52.546460 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m19:25:52.546460 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m19:25:52.547466 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:25:52.553465 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.006 seconds
[0m19:25:52.555508 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m19:25:52.556503 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m19:25:52.570077 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:52.571078 [debug] [MainThread]: On master: BEGIN
[0m19:25:52.571078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:52.612116 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m19:25:52.613126 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:52.613126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:52.622979 [debug] [MainThread]: SQL status: SELECT 72 in 0.009 seconds
[0m19:25:52.638170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E384D9A0>]}
[0m19:25:52.638170 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:52.639170 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:52.639170 [debug] [MainThread]: On master: BEGIN
[0m19:25:52.640169 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:25:52.640169 [debug] [MainThread]: On master: COMMIT
[0m19:25:52.641171 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:52.641171 [debug] [MainThread]: On master: COMMIT
[0m19:25:52.642131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:25:52.642131 [debug] [MainThread]: On master: Close
[0m19:25:52.647671 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_actor
[0m19:25:52.647671 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_actor ................................ [RUN]
[0m19:25:52.648697 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_actor'
[0m19:25:52.649696 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_actor
[0m19:25:52.773727 [debug] [Thread-1 (]: source_model: stg_raw_actor
[0m19:25:52.773727 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_actor
[0m19:25:52.788818 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:52.789813 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: BEGIN
[0m19:25:52.789813 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:52.838425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:25:52.838425 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:52.839423 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_actor'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:25:52.856946 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.017 seconds
[0m19:25:52.859982 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_actor"
[0m19:25:52.895247 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:52.896253 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_actor'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:25:52.899259 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m19:25:52.989084 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:25:53.002671 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:25:53.046323 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.047329 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_actor
[0m19:25:53.123689 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.124687 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.125687 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */

  create view "sakila_db"."public"."stg_dv_actor__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        actor_id,
        first_name,
        last_name,
        last_update,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_actor"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        actor_id,
        first_name,
        last_name,
        last_update
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        actor_id,
        first_name,
        last_name,
        last_update,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(actor_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_actor_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(first_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_name AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^'))), '00000000000000000000000000000000') AS hd_actor_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as actor_id
        , '(unknown)' as first_name
        , '(unknown)' as last_name
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_actor_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_actor_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as actor_id
        , '(error)' as first_name
        , '(error)' as last_name
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_actor_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_actor_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        actor_id,
        first_name,
        last_name,
        last_update,
        hk_actor_h,
        hd_actor_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        actor_id,
        first_name,
        last_name,
        last_update,
        hk_actor_h,
        hd_actor_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:25:53.132731 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:25:53.138771 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.138771 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor" rename to "stg_dv_actor__dbt_backup"
[0m19:25:53.139769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:25:53.142765 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.143765 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
alter table "sakila_db"."public"."stg_dv_actor__dbt_tmp" rename to "stg_dv_actor"
[0m19:25:53.143765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:25:53.159358 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m19:25:53.159358 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.159358 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: COMMIT
[0m19:25:53.161874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:25:53.167926 [debug] [Thread-1 (]: Applying DROP to: "sakila_db"."public"."stg_dv_actor__dbt_backup"
[0m19:25:53.172930 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_actor"
[0m19:25:53.172930 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_actor"} */
drop view if exists "sakila_db"."public"."stg_dv_actor__dbt_backup" cascade
[0m19:25:53.175768 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:25:53.178776 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_actor: Close
[0m19:25:53.181928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23e93776-7789-4bee-b390-5f2022e3face', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E3DAF8C0>]}
[0m19:25:53.182930 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_dv_actor ........................... [[32mCREATE VIEW[0m in 0.53s]
[0m19:25:53.183929 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_actor
[0m19:25:53.184928 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:53.185928 [debug] [MainThread]: On master: BEGIN
[0m19:25:53.185928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:25:53.258994 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m19:25:53.259996 [debug] [MainThread]: On master: COMMIT
[0m19:25:53.259996 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:53.261011 [debug] [MainThread]: On master: COMMIT
[0m19:25:53.261011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:25:53.262499 [debug] [MainThread]: On master: Close
[0m19:25:53.263508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:53.264521 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m19:25:53.265523 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m19:25:53.266519 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_actor' was properly closed.
[0m19:25:53.267520 [info ] [MainThread]: 
[0m19:25:53.268536 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m19:25:53.271534 [debug] [MainThread]: Command end result
[0m19:25:53.387067 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\target\manifest.json
[0m19:25:53.391064 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\target\semantic_manifest.json
[0m19:25:53.401648 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\target\run_results.json
[0m19:25:53.401648 [info ] [MainThread]: 
[0m19:25:53.402649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:53.403650 [info ] [MainThread]: 
[0m19:25:53.404648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:25:53.404648 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:25:53.406648 [debug] [MainThread]: Command `dbt build` succeeded at 19:25:53.405648 after 2.23 seconds
[0m19:25:53.406648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E0DFF2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E0F1B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268E31DB140>]}
[0m19:25:53.406648 [debug] [MainThread]: Flushing usage events
[0m19:25:54.513466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:27.390721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDEC3C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDE737DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDE7E8920>]}


============================== 19:26:27.396349 | a027aab7-2320-448d-9b37-75b6d432b999 ==============================
[0m19:26:27.396349 [info ] [MainThread]: Running with dbt=1.10.1
[0m19:26:27.397359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Predator\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Study Materials\\datavault_dbt_postgres\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build -m .\\models\\stg_dv\\stg_dv_film.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:26:27.397359 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m19:26:27.398360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDEFDAAB0>]}
[0m19:26:27.640370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDEAD5D30>]}
[0m19:26:27.705580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE0450CB0>]}
[0m19:26:27.706532 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:26:27.959005 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m19:26:28.176781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:28.178323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:28.225465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE04EF3B0>]}
[0m19:26:28.334364 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\target\manifest.json
[0m19:26:28.350869 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\target\semantic_manifest.json
[0m19:26:28.396818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE07CBCE0>]}
[0m19:26:28.397826 [info ] [MainThread]: Found 32 models, 4 data tests, 15 sources, 859 macros
[0m19:26:28.403823 [info ] [MainThread]: 
[0m19:26:28.404823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:28.405824 [info ] [MainThread]: 
[0m19:26:28.406840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:26:28.407825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db'
[0m19:26:28.490649 [debug] [ThreadPool]: Using postgres connection "list_sakila_db"
[0m19:26:28.491649 [debug] [ThreadPool]: On list_sakila_db: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db"} */

    select distinct nspname from pg_namespace
  
[0m19:26:28.491649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:28.537901 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m19:26:28.538940 [debug] [ThreadPool]: On list_sakila_db: Close
[0m19:26:28.544938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sakila_db_public'
[0m19:26:28.551120 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m19:26:28.551120 [debug] [ThreadPool]: On list_sakila_db_public: BEGIN
[0m19:26:28.552120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:28.594840 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m19:26:28.594840 [debug] [ThreadPool]: Using postgres connection "list_sakila_db_public"
[0m19:26:28.595862 [debug] [ThreadPool]: On list_sakila_db_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "list_sakila_db_public"} */
select
      'sakila_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sakila_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:26:28.602660 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.006 seconds
[0m19:26:28.604939 [debug] [ThreadPool]: On list_sakila_db_public: ROLLBACK
[0m19:26:28.605497 [debug] [ThreadPool]: On list_sakila_db_public: Close
[0m19:26:28.621402 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:28.621402 [debug] [MainThread]: On master: BEGIN
[0m19:26:28.621960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:28.666885 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m19:26:28.667471 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:28.667471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:26:28.676623 [debug] [MainThread]: SQL status: SELECT 72 in 0.009 seconds
[0m19:26:28.692697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE06DDFA0>]}
[0m19:26:28.693350 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:28.693898 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:28.693898 [debug] [MainThread]: On master: BEGIN
[0m19:26:28.694904 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:26:28.694904 [debug] [MainThread]: On master: COMMIT
[0m19:26:28.694904 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:28.696082 [debug] [MainThread]: On master: COMMIT
[0m19:26:28.696697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:26:28.696697 [debug] [MainThread]: On master: Close
[0m19:26:28.700741 [debug] [Thread-1 (]: Began running node model.datavault_postgres_test.stg_dv_film
[0m19:26:28.701703 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_dv_film ................................. [RUN]
[0m19:26:28.702142 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.datavault_postgres_test.stg_dv_film'
[0m19:26:28.702142 [debug] [Thread-1 (]: Began compiling node model.datavault_postgres_test.stg_dv_film
[0m19:26:28.828863 [debug] [Thread-1 (]: source_model: stg_raw_film
[0m19:26:28.829870 [debug] [Thread-1 (]: source_model is not mapping and not none: stg_raw_film
[0m19:26:28.844888 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:26:28.844888 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: BEGIN
[0m19:26:28.845896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:28.886428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m19:26:28.887466 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:26:28.887466 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:26:28.903500 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.015 seconds
[0m19:26:28.906505 [debug] [Thread-1 (]: source_relation: "sakila_db"."public"."stg_raw_film"
[0m19:26:28.939543 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:26:28.939543 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sakila_db".INFORMATION_SCHEMA.columns
      where table_name = 'stg_raw_film'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:26:28.943405 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.003 seconds
[0m19:26:29.039009 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:26:29.052526 [debug] [Thread-1 (]: hash type in hash macro: VARCHAR
[0m19:26:29.148177 [debug] [Thread-1 (]: Writing injected SQL for node "model.datavault_postgres_test.stg_dv_film"
[0m19:26:29.149186 [debug] [Thread-1 (]: Began executing node model.datavault_postgres_test.stg_dv_film
[0m19:26:29.182283 [debug] [Thread-1 (]: Writing runtime sql for node "model.datavault_postgres_test.stg_dv_film"
[0m19:26:29.183282 [debug] [Thread-1 (]: Using postgres connection "model.datavault_postgres_test.stg_dv_film"
[0m19:26:29.183282 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "datavault_postgres_test", "target_name": "dev", "node_id": "model.datavault_postgres_test.stg_dv_film"} */

  create view "sakila_db"."public"."stg_dv_film__dbt_tmp"
    
    
  as (
    

  

  

  

  

  

  

  

  

  

  












-----------------------------------------------------------------------------------------------
--                                                                                      ( )  --
--                                                                                     //    --
--                                                                               ( )=( o )   --
--  #####   #####     #    #       ####### ####### ######  ####### #######             \\    --
-- #     # #     #   # #   #       #       #       #     # #       #                    ( )  --
-- #       #        #   #  #       #       #       #     # #       #                         --
--  #####  #       #     # #       #####   #####   ######  #####   #####                     --
--       # #       ####### #       #       #       #   #   #       #                         --
-- #     # #     # #     # #       #       #       #    #  #       #                         --
--  #####   #####  #     # ####### ####### #       #     # ####### #######                   --
-----------------------------------------------------------------------------------------------
--              Generated by datavault4dbt by Scalefree International GmbH                   --
-----------------------------------------------------------------------------------------------

WITH


source_data AS (
    SELECT

    
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
        ldts,
        rsrc

  FROM "sakila_db"."public"."stg_raw_film"

  ),





ldts_rsrc_data AS (

  SELECT
    CAST( ldts as TIMESTAMPTZ ) AS ldts,
    CAST( rsrc as VARCHAR ) AS rsrc,
      
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext
    

  FROM source_data),




hashed_columns AS (

    SELECT

    
        ldts,
        rsrc,
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            '"' || REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(film_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--') || '"'

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^'))), '00000000000000000000000000000000') AS hk_film_h,
    COALESCE(LOWER(MD5(NULLIF(CAST(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(CONCAT(
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(title AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(description AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(release_year AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(language_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(original_language_id AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_duration AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rental_rate AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(length AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(replacement_cost AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(rating AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(last_update AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(special_features AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^'),'||',
        COALESCE((

            CONCAT('"', REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(TRIM(BOTH ' ' FROM CAST(fulltext AS VARCHAR)), '\\', '\\\\'), '"', '\"'), '^^', '--'), '"')

        ), '^^')
        ), '\n', '') 
        , '\t', '') 
        , '\v', '') 
        , '\r', '') AS VARCHAR), '^^||^^||^^||^^||^^||^^||^^||^^||^^||^^||^^||^^||^^'))), '00000000000000000000000000000000') AS hd_film_s

    FROM ldts_rsrc_data
  
),

unknown_values AS (

    SELECT

    CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'SYSTEM' as rsrc
        , CAST(-1 as INTEGER) as film_id
        , '(unknown)' as title
        , '(unknown)' as description
        , CAST(-1 as INTEGER) as release_year
        , CAST(-1 as INTEGER) as language_id
        , CAST(-1 as INTEGER) as original_language_id
        , CAST(-1 as SMALLINT) as rental_duration
        , CAST(-1 as NUMERIC) as rental_rate
        , CAST(-1 as SMALLINT) as length
        , CAST(-1 as NUMERIC) as replacement_cost
        , CAST(NULL as USER-DEFINED) as rating
        
        ,CAST(TO_TIMESTAMP('0001-01-01 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) AS last_update
        , CAST(NULL as ARRAY) as special_features
        
        , CAST(NULL as TSVECTOR) as fulltext
        
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hk_film_h
        ,CAST('00000000000000000000000000000000' as VARCHAR(32)) as hd_film_s
),


error_values AS (

    SELECT

    CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as ldts
    ,'ERROR' as rsrc
        , CAST(-2 as INTEGER) as film_id
        , '(error)' as title
        , '(error)' as description
        , CAST(-2 as INTEGER) as release_year
        , CAST(-2 as INTEGER) as language_id
        , CAST(-2 as INTEGER) as original_language_id
        , CAST(-2 as SMALLINT) as rental_duration
        , CAST(-2 as NUMERIC) as rental_rate
        , CAST(-2 as SMALLINT) as length
        , CAST(-2 as NUMERIC) as replacement_cost
        , CAST(NULL as USER-DEFINED) as rating
        
        ,CAST(TO_TIMESTAMP('8888-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS') AS TIMESTAMPTZ) as last_update
        , CAST(NULL as ARRAY) as special_features
        
        , CAST(NULL as TSVECTOR) as fulltext
        
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hk_film_h
        ,CAST('ffffffffffffffffffffffffffffffff' as VARCHAR(32)) as hd_film_s
),


ghost_records AS (
    SELECT * FROM unknown_values
    UNION ALL
    SELECT * FROM error_values
),
columns_to_select AS (

    SELECT

    
        ldts,
        rsrc,
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
        hk_film_h,
        hd_film_s

    FROM hashed_columns
    UNION ALL
    
    SELECT

    
        ldts,
        rsrc,
        film_id,
        title,
        description,
        release_year,
        language_id,
        original_language_id,
        rental_duration,
        rental_rate,
        length,
        replacement_cost,
        rating,
        last_update,
        special_features,
        fulltext,
        hk_film_h,
        hd_film_s

    FROM ghost_records

)

SELECT * FROM columns_to_select
  );
[0m19:26:29.184825 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Syntaxfehler bei Â»USERÂ«
LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                 ^

[0m19:26:29.185831 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: ROLLBACK
[0m19:26:29.186379 [debug] [Thread-1 (]: On model.datavault_postgres_test.stg_dv_film: Close
[0m19:26:29.190384 [debug] [Thread-1 (]: Database Error in model stg_dv_film (models\stg_dv\stg_dv_film.sql)
  FEHLER:  Syntaxfehler bei Â»USERÂ«
  LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_film.sql
[0m19:26:29.192426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a027aab7-2320-448d-9b37-75b6d432b999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE121FB00>]}
[0m19:26:29.193385 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_dv_film ........................ [[31mERROR[0m in 0.49s]
[0m19:26:29.193385 [debug] [Thread-1 (]: Finished running node model.datavault_postgres_test.stg_dv_film
[0m19:26:29.194927 [debug] [Thread-4 (]: Marking all children of 'model.datavault_postgres_test.stg_dv_film' to be skipped because of status 'error'.  Reason: Database Error in model stg_dv_film (models\stg_dv\stg_dv_film.sql)
  FEHLER:  Syntaxfehler bei Â»USERÂ«
  LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_film.sql.
[0m19:26:29.195971 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:29.197015 [debug] [MainThread]: On master: BEGIN
[0m19:26:29.197015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:26:29.242354 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m19:26:29.242354 [debug] [MainThread]: On master: COMMIT
[0m19:26:29.243348 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:29.243348 [debug] [MainThread]: On master: COMMIT
[0m19:26:29.243348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:26:29.243348 [debug] [MainThread]: On master: Close
[0m19:26:29.244892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:29.244892 [debug] [MainThread]: Connection 'list_sakila_db' was properly closed.
[0m19:26:29.245898 [debug] [MainThread]: Connection 'list_sakila_db_public' was properly closed.
[0m19:26:29.245898 [debug] [MainThread]: Connection 'model.datavault_postgres_test.stg_dv_film' was properly closed.
[0m19:26:29.245898 [info ] [MainThread]: 
[0m19:26:29.246903 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m19:26:29.247903 [debug] [MainThread]: Command end result
[0m19:26:29.340454 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Study Materials\datavault_dbt_postgres\target\manifest.json
[0m19:26:29.342490 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Study Materials\datavault_dbt_postgres\target\semantic_manifest.json
[0m19:26:29.349051 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Study Materials\datavault_dbt_postgres\target\run_results.json
[0m19:26:29.349051 [info ] [MainThread]: 
[0m19:26:29.350056 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:26:29.350056 [info ] [MainThread]: 
[0m19:26:29.351172 [error] [MainThread]: [31mFailure in model stg_dv_film (models\stg_dv\stg_dv_film.sql)[0m
[0m19:26:29.351172 [error] [MainThread]:   Database Error in model stg_dv_film (models\stg_dv\stg_dv_film.sql)
  FEHLER:  Syntaxfehler bei Â»USERÂ«
  LINE 236:         , CAST(NULL as USER-DEFINED) as rating
                                   ^
  compiled code at target\run\datavault_postgres_test\models\stg_dv\stg_dv_film.sql
[0m19:26:29.352179 [info ] [MainThread]: 
[0m19:26:29.353179 [info ] [MainThread]:   compiled code at target\compiled\datavault_postgres_test\models\stg_dv\stg_dv_film.sql
[0m19:26:29.353179 [info ] [MainThread]: 
[0m19:26:29.354180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:26:29.354180 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:26:29.355207 [debug] [MainThread]: Command `dbt build` failed at 19:26:29.355207 after 2.10 seconds
[0m19:26:29.356183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDE9FC9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDEA4E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE055DE20>]}
[0m19:26:29.356183 [debug] [MainThread]: Flushing usage events
[0m19:26:30.450653 [debug] [MainThread]: An error was encountered while trying to flush usage events
